!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.ambisonics=e()}}(function(){var define,module,exports;return function e(t,r,n){function a(o,s){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return a(r?r:e)},l,l.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("babel-runtime/helpers/classCallCheck"),i=n(a),o=e("babel-runtime/helpers/createClass"),s=n(o),u=function(){function e(t,r){(0,i.default)(this,e),this.initialized=!1,this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(var n=0;n<this.nCh;n++)this.decFilterNodes[n]=this.ctx.createConvolver(),this.decFilterNodes[n].normalize=!1;this.resetFilters();for(var n=0;n<this.nCh;n++){this.in.connect(this.decFilterNodes[n],n,0);var a=Math.floor(Math.sqrt(n)),o=n-a*a-a;o>=0?this.decFilterNodes[n].connect(this.gainMid):this.decFilterNodes[n].connect(this.gainSide)}this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}return(0,s.default)(e,[{key:"updateFilters",value:function(e){for(var t=0;t<this.nCh;t++)this.decFilters[t]=this.ctx.createBuffer(1,e.length,e.sampleRate),this.decFilters[t].getChannelData(0).set(e.getChannelData(t)),this.decFilterNodes[t].buffer=this.decFilters[t]}},{key:"resetFilters",value:function(){var e=new Array(this.nCh);e.fill(0),e[0]=.5,e[1]=.5/Math.sqrt(3);for(var t=0;t<this.nCh;t++){this.decFilters[t]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(var r=0;r<64;r++)this.decFilters[t].getChannelData(0)[r]=0;this.decFilters[t].getChannelData(0)[0]=e[t],this.decFilterNodes[t].buffer=this.decFilters[t]}}}]),e}();r.default=u},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.fuma2acn=r.n3d2sn3d=r.sn3d2n3d=r.acn2wxyz=r.wxyz2acn=void 0;var a=e("babel-runtime/helpers/classCallCheck"),i=n(a);r.wxyz2acn=function e(t){(0,i.default)(this,e),this.ctx=t,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(4);for(var r=0;r<4;r++)this.gains[r]=this.ctx.createGain(),0==r?this.gains[r].gain.value=Math.SQRT2:this.gains[r].gain.value=Math.sqrt(3),this.gains[r].connect(this.out,0,r);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[3],1,0),this.in.connect(this.gains[1],2,0),this.in.connect(this.gains[2],3,0)},r.acn2wxyz=function e(t){(0,i.default)(this,e),this.ctx=t,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(4);for(var r=0;r<4;r++)this.gains[r]=this.ctx.createGain(),0==r?this.gains[r].gain.value=Math.SQRT1_2:this.gains[r].gain.value=1/Math.sqrt(3),this.gains[r].connect(this.out,0,r);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[2],1,0),this.in.connect(this.gains[3],2,0),this.in.connect(this.gains[1],3,0)},r.sn3d2n3d=function e(t,r){(0,i.default)(this,e),this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++){var a=Math.floor(Math.sqrt(n));this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=Math.sqrt(2*a+1),this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}},r.n3d2sn3d=function e(t,r){(0,i.default)(this,e),this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++){var a=Math.floor(Math.sqrt(n));this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=1/Math.sqrt(2*a+1),this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}},r.fuma2acn=function e(t,r){(0,i.default)(this,e),r>3&&(console.log("FuMa specifiction is supported up to 3rd order"),r=3);var n=[Math.sqrt(2),Math.sqrt(3),Math.sqrt(3),Math.sqrt(3),Math.sqrt(15)/2,Math.sqrt(15)/2,Math.sqrt(5),Math.sqrt(15)/2,Math.sqrt(15)/2,Math.sqrt(35/8),Math.sqrt(35)/3,Math.sqrt(224/45),Math.sqrt(7),Math.sqrt(224/45),Math.sqrt(35)/3,Math.sqrt(35/8)];if(this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=[],this.remapArray=[],this.remapArray.push(0,2,3,1),r>1)for(var a,o=0,s=0;s<this.nCh;s++)if(a=[],s>=(o+1)*(o+1)){o+=1;for(var u=(o+1)*(o+1);u<(o+2)*(o+2);u++)(u+o%2)%2==0?a.push(u):a.unshift(u);this.remapArray=this.remapArray.concat(a)}for(var s=0;s<this.nCh;s++)this.gains[s]=this.ctx.createGain(),this.gains[s].gain.value=n[s],this.in.connect(this.gains[s],this.remapArray[s],0),this.gains[s].connect(this.out,0,s)}},{"babel-runtime/helpers/classCallCheck":18}],3:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("babel-runtime/helpers/classCallCheck"),i=n(a),o=e("babel-runtime/helpers/createClass"),s=n(o);e("get-float-time-domain-data");var u=function(){function e(t){(0,i.default)(this,e),this.ctx=t,this.fftSize=2048,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(3);for(var r=0;r<3;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=1/Math.sqrt(3);for(this.analysers=new Array(4),this.analBuffers=new Array(4),r=0;r<4;r++)this.analysers[r]=this.ctx.createAnalyser(),this.analysers[r].fftSize=this.fftSize,this.analysers[r].smoothingTimeConstant=0,this.analBuffers[r]=new Float32Array(this.fftSize);for(this.in.connect(this.out,0,0),this.in.connect(this.analysers[0],0,0),this.in.connect(this.gains[1],1,0),this.in.connect(this.gains[2],2,0),this.in.connect(this.gains[0],3,0),r=0;r<3;r++)this.gains[r].connect(this.analysers[r+1],0,0),this.gains[r].connect(this.out,0,r+1)}return(0,s.default)(e,[{key:"updateBuffers",value:function(){for(var e=0;e<4;e++)this.analysers[e].getFloatTimeDomainData(this.analBuffers[e])}},{key:"computeIntensity",value:function(){for(var e,t,r,n,a,i,o=0,s=0,u=0,c=0,l=0,f=0,h=0,m=0;m<this.fftSize;m++)o+=this.analBuffers[0][m]*this.analBuffers[1][m],s+=this.analBuffers[0][m]*this.analBuffers[2][m],u+=this.analBuffers[0][m]*this.analBuffers[3][m],c+=this.analBuffers[0][m]*this.analBuffers[0][m],l+=this.analBuffers[1][m]*this.analBuffers[1][m],f+=this.analBuffers[2][m]*this.analBuffers[2][m],h+=this.analBuffers[3][m]*this.analBuffers[3][m];e=[o,s,u],t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=(c+l+f+h)/2,n=1-t/(r+1e-7),a=180*Math.atan2(s,o)/Math.PI,i=180*Math.atan2(e[2],Math.sqrt(e[0]*e[0]+e[1]*e[1]))/Math.PI;var d=[a,i,n,r];return d}}]),e}();r.default=u},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"get-float-time-domain-data":49}],4:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),o=a(i),s=e("babel-runtime/helpers/createClass"),u=a(s),c=e("spherical-harmonic-transform"),l=n(c),f=function(){function e(t,r){(0,o.default)(this,e),this.initialized=!1,this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.azim=0,this.elev=0,this.gains=new Array(this.nCh),this.gainNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(var n=0;n<this.nCh;n++)this.gainNodes[n]=this.ctx.createGain(),this.gainNodes[n].channelCountMode="explicit",this.gainNodes[n].channelCount=1;this.updateGains();for(var n=0;n<this.nCh;n++)this.in.connect(this.gainNodes[n]),this.gainNodes[n].connect(this.out,0,n);this.initialized=!0}return(0,u.default)(e,[{key:"updateGains",value:function(){for(var e=this.order,t=l.computeRealSH(e,[[this.azim*Math.PI/180,this.elev*Math.PI/180]]),r=0;r<this.nCh;r++)this.gains[r]=t[r][0],this.gainNodes[r].gain.value=this.gains[r]}}]),e}();r.default=f},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"spherical-harmonic-transform":81}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("babel-runtime/helpers/classCallCheck"),i=n(a),o=e("babel-runtime/helpers/createClass"),s=n(o),u=function(){function e(t,r,n){(0,i.default)(this,e),this.ctx=t,this.orderIn=r,n<r?this.orderOut=n:this.orderOut=r,this.nChIn=(this.orderIn+1)*(this.orderIn+1),this.nChOut=(this.orderOut+1)*(this.orderOut+1),this.in=this.ctx.createChannelSplitter(this.nChIn),this.out=this.ctx.createChannelMerger(this.nChOut);for(var a=0;a<this.nChOut;a++)this.in.connect(this.out,a,a)}return(0,s.default)(e,[{key:"updateOrder",value:function(e){if(e<=this.orderIn){this.orderOut=e,this.nChOut=(this.orderOut+1)*(this.orderOut+1),this.out.disconnect(),this.out=this.ctx.createChannelMerger(this.nChOut);for(var t=0;t<this.nChOut;t++)this.in.connect(this.out,t,t)}}}]),e}();r.default=u},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19}],6:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),o=a(i),s=e("babel-runtime/helpers/createClass"),u=a(s),c=e("spherical-harmonic-transform"),l=n(c),f=function(){function e(t,r){(0,o.default)(this,e),this.ctx=t,this.order=r,this.nCh=(this.order+1)*(this.order+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh),this.orderGains=new Array(this.order+1),this.orderGains.fill(1);for(var n=0;n<this.nCh;n++)this.gains[n]=this.ctx.createGain(),this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}return(0,u.default)(e,[{key:"updateOrderGains",value:function(){for(var e,t=0;t<this.nCh;t++)e=Math.floor(Math.sqrt(t)),this.gains[t].gain.value=this.orderGains[e]}},{key:"computeMaxRECoeffs",value:function(){var e=this.order;this.orderGains[0]=1;for(var t=0,r=0,n=0,a=1;a<=e;a++)n=l.recurseLegendrePoly(a,[Math.cos(2.406809/(e+1.51))],t,r),this.orderGains[a]=n[0][0],r=t,t=n}}]),e}();r.default=f},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"spherical-harmonic-transform":81}],7:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),o=a(i),s=e("babel-runtime/helpers/createClass"),u=a(s);e("get-float-time-domain-data");var c=e("numeric"),l=n(c),f=e("spherical-harmonic-transform"),h=n(f),m=e("./utils.js"),d=function(){function e(t,r,n){(0,o.default)(this,e),this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.fftSize=2048,this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var a=0;a<this.nCh;a++)this.analysers[a]=this.ctx.createAnalyser(),this.analysers[a].fftSize=this.fftSize,this.analysers[a].smoothingTimeConstant=0,this.analBuffers[a]=new Float32Array(this.fftSize);for(var i=0;i<this.nCh;i++)this.in.connect(this.out,i,i),this.in.connect(this.analysers[i],i,0);var s=m.getTdesign(4*r);this.td_dirs_rad=m.deg2rad(s),this.SHmtx=h.computeRealSH(this.order,this.td_dirs_rad),this.mode=n}return(0,u.default)(e,[{key:"updateBuffers",value:function(){for(var e=0;e<this.nCh;e++)this.analysers[e].getFloatTimeDomainData(this.analBuffers[e])}},{key:"computePowermap",value:function(){for(var e=this.td_dirs_rad.length,t=l.dot(l.transpose(this.SHmtx),this.analBuffers),r=new Array(e),n=0;n<e;n++){for(var a=0;a<this.fftSize;a++){var i=0;i+=t[n][a]*t[n][a]}var i=i/this.fftSize;r[n]=[this.td_dirs_rad[n][0],this.td_dirs_rad[n][1],i]}if(0==this.mode)return r;if(1==this.mode){var o=h.forwardSHT(2*this.order,r);return o}}}]),e}();r.default=d},{"./utils.js":15,"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"get-float-time-domain-data":49,numeric:63,"spherical-harmonic-transform":81}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("babel-runtime/helpers/classCallCheck"),i=n(a),o=e("babel-runtime/helpers/createClass"),s=n(o);e("get-float-time-domain-data");var u=function(){function e(t,r){(0,i.default)(this,e),this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.fftSize=2048,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh);for(var n=0;n<this.nCh;n++)this.analysers[n]=this.ctx.createAnalyser(),this.analysers[n].fftSize=this.fftSize,this.analysers[n].smoothingTimeConstant=0,this.analBuffers[n]=new Float32Array(this.fftSize),this.in.connect(this.analysers[n],n,0),this.analysers[n].connect(this.out,0,n)}return(0,s.default)(e,[{key:"updateBuffers",value:function(){for(var e=0;e<this.nCh;e++)this.analysers[e].getFloatTimeDomainData(this.analBuffers[e])}},{key:"computeRMS",value:function(){var e=new Array(this.nCh);e.fill(0);for(var t=0;t<this.nCh;t++){for(var r=0;r<this.fftSize;r++)e[t]=e[t]+this.analBuffers[t][r]*this.analBuffers[t][r];e[t]=Math.sqrt(e[t]/this.fftSize)}return e}}]),e}();r.default=u},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"get-float-time-domain-data":49}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("babel-runtime/helpers/classCallCheck"),i=n(a),o=e("babel-runtime/helpers/createClass"),s=n(o),u=function(){function e(t,r){(0,i.default)(this,e),this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.mirrorPlane=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++)this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=1,this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}return(0,s.default)(e,[{key:"reset",value:function(){for(var e=0;e<this.nCh;e++)this.gains[e].gain.value=1}},{key:"mirror",value:function(e){switch(e){case 0:this.mirrorPlane=0,this.reset();break;case 1:this.reset(),this.mirrorPlane=1;for(var t,r=0;r<=this.order;r++)for(var n=-r;n<=r;n++)t=r*r+r+n,(n<0&&n%2==0||n>0&&n%2==1)&&(this.gains[t].gain.value=-1);break;case 2:this.reset(),this.mirrorPlane=2;for(var t,r=0;r<=this.order;r++)for(var n=-r;n<=r;n++)t=r*r+r+n,n<0&&(this.gains[t].gain.value=-1);break;case 3:this.reset(),this.mirrorPlane=3;for(var t,r=0;r<=this.order;r++)for(var n=-r;n<=r;n++)t=r*r+r+n,(n+r)%2==1&&(this.gains[t].gain.value=-1);break;default:console.log("The mirroring planes can be either 1 (yz), 2 (xz), 3 (xy), or 0 (no mirroring). Value set to 0."),this.mirrorPlane=0,this.reset()}}}]),e}();r.default=u},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19}],10:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),o=a(i),s=e("babel-runtime/helpers/createClass"),u=a(s),c=e("spherical-harmonic-transform"),l=n(c),f=function(){function e(t,r){(0,o.default)(this,e),this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.yaw=0,this.pitch=0,this.roll=0,this.rotMtx=numeric.identity(this.nCh),this.rotMtxNodes=new Array(this.order),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var n=1;n<=this.order;n++){for(var a=new Array(2*n+1),i=0;i<2*n+1;i++){a[i]=new Array(2*n+1);for(var s=0;s<2*n+1;s++)a[i][s]=this.ctx.createGain(),i==s?a[i][s].gain.value=1:a[i][s].gain.value=0}this.rotMtxNodes[n-1]=a}this.in.connect(this.out,0,0);var u=1;for(n=1;n<=this.order;n++){for(i=0;i<2*n+1;i++)for(s=0;s<2*n+1;s++)this.in.connect(this.rotMtxNodes[n-1][i][s],u+s,0),this.rotMtxNodes[n-1][i][s].connect(this.out,0,u+i);u=u+2*n+1}}return(0,u.default)(e,[{key:"updateRotMtx",value:function(){var e=this.yaw*Math.PI/180,t=this.pitch*Math.PI/180,r=this.roll*Math.PI/180;this.rotMtx=l.getSHrotMtx(l.yawPitchRoll2Rzyx(e,t,r),this.order);for(var n=1,a=1;a<this.order+1;a++){for(var i=0;i<2*a+1;i++)for(var o=0;o<2*a+1;o++)this.rotMtxNodes[a-1][i][o].gain.value=this.rotMtx[n+i][n+o];n=n+2*a+1}}}]),e}();r.default=f},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"spherical-harmonic-transform":81}],11:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),o=a(i),s=e("babel-runtime/helpers/createClass"),u=a(s),c=e("spherical-harmonic-transform"),l=n(c),f=function(){function e(t,r){(0,o.default)(this,e),this.initialized=!1,this.ctx=t,this.order=r,this.nCh=(r+1)*(r+1),this.azim=0,this.elev=0,this.vmicGains=new Array(this.nCh),this.vmicGainNodes=new Array(this.nCh),this.vmicCoeffs=new Array(this.order+1),this.vmicPattern="hypercardioid",this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createGain();for(var n=0;n<this.nCh;n++)this.vmicGainNodes[n]=this.ctx.createGain();for(this.SHxyz=new Array(this.nCh),this.SHxyz.fill(0),this.updatePattern(),this.updateOrientation(),n=0;n<this.nCh;n++)this.in.connect(this.vmicGainNodes[n],n,0),this.vmicGainNodes[n].connect(this.out);this.initialized=!0}return(0,u.default)(e,[{key:"updatePattern",value:function(){function e(e){for(var t=new Array(e+1),r=0;r<=e;r++)t[r]=l.factorial(e)*l.factorial(e)/(l.factorial(e+r+1)*l.factorial(e-r));return t}function t(e){for(var t=new Array(e+1),r=(e+1)*(e+1),n=0;n<=e;n++)t[n]=1/r;return t}function r(e){switch(e){case 1:var t=[.366,.2113];break;case 2:var t=[.2362,.1562,.059];break;case 3:var t=[.1768,.1281,.0633,.0175];break;case 4:var t=[.1414,.1087,.0623,.0247,.0054];break;default:return void console.error("Orders should be in the range of 1-4 at the moment.")}return t}function n(e){var t=new Array(e+1);t[0]=1;for(var r=0,n=0,a=0,i=1;i<e+1;i++)a=l.recurseLegendrePoly(i,[Math.cos(2.406809/(e+1.51))],r,n),t[i]=a[0][0],n=r,r=a;for(var o=0,i=0;i<=e;i++)o+=t[i]*(2*i+1);for(var i=0;i<=e;i++)t[i]=t[i]/o;return t}switch(this.vmicPattern){case"cardioid":this.vmicCoeffs=e(this.order);break;case"supercardioid":this.vmicCoeffs=r(this.order);break;case"hypercardioid":this.vmicCoeffs=t(this.order);break;case"max_rE":this.vmicCoeffs=n(this.order);break;default:this.vmicPattern="hypercardioid",this.vmicCoeffs=t(this.order)}this.updateGains()}},{key:"updateOrientation",value:function(){for(var e=this.azim*Math.PI/180,t=this.elev*Math.PI/180,r=l.computeRealSH(this.order,[[e,t]]),n=0;n<this.nCh;n++)this.SHxyz[n]=r[n][0];this.updateGains()}},{key:"updateGains",value:function(){for(var e,t=0;t<=this.order;t++)for(var r=-t;r<=t;r++)e=t*t+t+r,this.vmicGains[e]=this.vmicCoeffs[t]*this.SHxyz[e];for(var n=0;n<this.nCh;n++)this.vmicGainNodes[n].gain.value=this.vmicGains[n]}}]),e}();r.default=f},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"spherical-harmonic-transform":81}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("babel-runtime/helpers/classCallCheck"),i=n(a),o=e("babel-runtime/helpers/createClass"),s=n(o),u=function(){function e(t,r,n,a){function o(e,t){return("000000000"+e).substr(-t)}(0,i.default)(this,e),this.context=t,this.order=r,this.nCh=(r+1)*(r+1),this.nChGroups=Math.ceil(this.nCh/8),this.buffers=new Array,this.loadCount=0,this.loaded=!1,this.onLoad=a,this.urls=new Array(this.nChGroups);var s=n.slice(n.length-3,n.length);this.fileExt=s;for(var u=0;u<this.nChGroups;u++)u==this.nChGroups-1?this.urls[u]=n.slice(0,n.length-4)+"_"+o(8*u+1,2)+"-"+o(this.nCh,2)+"ch."+s:this.urls[u]=n.slice(0,n.length-4)+"_"+o(8*u+1,2)+"-"+o(8*u+8,2)+"ch."+s}return(0,s.default)(e,[{key:"loadBuffers",value:function(e,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer";var n=this;r.onload=function(){n.context.decodeAudioData(r.response,function(r){return r?(n.buffers[t]=r,n.loadCount++,void(n.loadCount==n.nChGroups&&(n.loaded=!0,n.concatBuffers(),console.log("HOAloader: all buffers loaded and concatenated"),n.onLoad(n.concatBuffer)))):void alert("error decoding file data: "+e)},function(t){alert("Browser cannot decode audio data:  "+e+"\n\nError: "+t+"\n\n(If you re using Safari and get a null error, this is most likely due to Apple's shady plan going on to stop the .ogg format from easing web developer's life :)")})},r.onerror=function(){alert("HOAloader: XHR error")},r.send()}},{key:"load",value:function(){for(var e=0;e<this.nChGroups;++e)this.loadBuffers(this.urls[e],e)}},{key:"concatBuffers",value:function(){if(this.loaded){var e=this.nCh,t=this.nChGroups,r=this.buffers[0].length;this.buffers.forEach(function(e){r=Math.max(r,e.length)});var n=this.buffers[0].sampleRate,a=[1,2,3,4,5,6,7,8],i=!!window.chrome;i&&"ogg"==this.fileExt.toLowerCase()&&(console.log("Loading of 8chan OGG files using Chrome: remap channels to correct order!"),a=[1,3,2,7,8,5,6,4]),this.concatBuffer=this.context.createBuffer(e,r,n);for(var o=0;o<t;o++)for(var s=0;s<this.buffers[o].numberOfChannels;s++)this.concatBuffer.getChannelData(8*o+s).set(this.buffers[o].getChannelData(a[s]-1))}}}]),e}();r.default=u},{"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19}],13:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),o=a(i),s=e("babel-runtime/helpers/createClass"),u=a(s),c=e("serve-sofa-hrir"),l=n(c),f=e("./utils.js"),h=function(){function e(t,r,n){(0,o.default)(this,e),this.context=t,this.order=r,this.nCh=(r+1)*(r+1),this.onLoad=n,this.hrtfSet=new l.HrtfSet({audioContext:this.context,coordinateSystem:"sofaSpherical"}),this.wishedSpeakerPos=f.getTdesign(2*this.order)}return(0,u.default)(e,[{key:"load",value:function(e){var t=this;this.hrtfSet.load(e).then(function(){var e=[];t.hrirBuffer=[];for(var r=0;r<t.wishedSpeakerPos.length;r++)e.push(t.hrtfSet.nearest(t.wishedSpeakerPos[r]).position),t.hrirBuffer.push(t.hrtfSet.nearest(t.wishedSpeakerPos[r]).fir);for(var n=0,a=0;a<t.wishedSpeakerPos.length;a++)t.wishedSpeakerPos[a][0]<0&&(t.wishedSpeakerPos[a][0]+=360),n+=Math.sqrt(Math.pow(t.wishedSpeakerPos[a][0]-e[a][0],2)+Math.pow(t.wishedSpeakerPos[a][1]-e[a][1],2));console.log("summed / average angular dist between asked and present pos:",Math.round(100*n)/100,"deg /",Math.round(n/t.wishedSpeakerPos.length*100)/100,"deg"),t.decodingMatrix=f.getAmbiBinauralDecMtx(e,t.order),t.hoaBuffer=t.getHoaFilterFromHrirFilter(),t.onLoad(t.hoaBuffer)})}},{key:"getHoaFilterFromHrirFilter",value:function(){for(var e=this.hrirBuffer[0].length,t=this.hrirBuffer[0].sampleRate,r=this.context.createBuffer(this.nCh,e,t),n=0;n<this.nCh;n++){for(var a=new Float32Array(e),i=0;i<this.hrirBuffer.length;i++)for(var o=0;o<e;o++)a[o]+=this.decodingMatrix[i][n]*this.hrirBuffer[i].getChannelData(0)[o];r.getChannelData(n).set(a)}return r}}]),e}();r.default=h},{"./utils.js":15,"babel-runtime/helpers/classCallCheck":18,"babel-runtime/helpers/createClass":19,"serve-sofa-hrir":72}],14:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.converters=r.HRIRloader=r.HOAloader=r.intensityAnalyser=r.powermapAnalyser=r.rmsAnalyser=r.virtualMic=r.binDecoder=r.sceneMirror=r.sceneRotator=r.orderWeight=r.orderLimiter=r.monoEncoder=void 0;var i=e("./ambi-monoEncoder");Object.defineProperty(r,"monoEncoder",{enumerable:!0,get:function(){return a(i).default}});var o=e("./ambi-orderLimiter");Object.defineProperty(r,"orderLimiter",{enumerable:!0,get:function(){return a(o).default}});var s=e("./ambi-orderWeight");Object.defineProperty(r,"orderWeight",{enumerable:!0,get:function(){return a(s).default}});var u=e("./ambi-sceneRotator");Object.defineProperty(r,"sceneRotator",{enumerable:!0,get:function(){return a(u).default}});var c=e("./ambi-sceneMirror");Object.defineProperty(r,"sceneMirror",{enumerable:!0,get:function(){return a(c).default}});var l=e("./ambi-binauralDecoder");Object.defineProperty(r,"binDecoder",{enumerable:!0,get:function(){return a(l).default}});var f=e("./ambi-virtualMic");Object.defineProperty(r,"virtualMic",{enumerable:!0,get:function(){return a(f).default}});var h=e("./ambi-rmsAnalyser");Object.defineProperty(r,"rmsAnalyser",{enumerable:!0,get:function(){return a(h).default}});var m=e("./ambi-powermapAnalyser");Object.defineProperty(r,"powermapAnalyser",{enumerable:!0,get:function(){return a(m).default}});var d=e("./ambi-intensityAnalyser");Object.defineProperty(r,"intensityAnalyser",{enumerable:!0,get:function(){return a(d).default}});var p=e("./hoa-loader");Object.defineProperty(r,"HOAloader",{enumerable:!0,get:function(){return a(p).default}});var v=e("./hrir-loader");Object.defineProperty(r,"HRIRloader",{enumerable:!0,get:function(){return a(v).default}});var g=e("./ambi-converters"),y=n(g),M=e("./utils"),b=n(M);r.converters=y,r.utils=b},{"./ambi-binauralDecoder":1,"./ambi-converters":2,"./ambi-intensityAnalyser":3,"./ambi-monoEncoder":4,"./ambi-orderLimiter":5,"./ambi-orderWeight":6,"./ambi-powermapAnalyser":7,"./ambi-rmsAnalyser":8,"./ambi-sceneMirror":9,"./ambi-sceneRotator":10,"./ambi-virtualMic":11,"./hoa-loader":12,"./hrir-loader":13,"./utils":15}],15:[function(e,t,r){"use strict";function n(e){for(var t=[],r=Math.PI/180,n=0;n<e.length;n++)3==e[0].length?t.push([e[n][0]*r,e[n][1]*r,e[n][2]]):2==e[0].length&&t.push([e[n][0]*r,e[n][1]*r]);return t}function a(e,t){for(var r=n(e),a=s.convertSph2Cart(r),l=u(a),f=l.length,h=r.length,m=new Array(f),d=0;d<f;d++){for(var p=new Array(3),v=0;v<3;v++)p[v]=a[l[d][v]];for(var g=o.inv(p),y=[],v=0;v<3;v++)for(var M=0;M<3;M++)y.push(g[M][v]);m[d]=y}var b=i(2*t),x=n(b),S=c(x,l,m,h);S=o.transpose(S);var w=s.computeRealSH(t,x);w=o.transpose(w);var D=x.length,I=o.dotMMsmall(S,w);return I=o.mul(1/D,I)}function i(e){if(e>21)throw new Error("Designs of order greater than 21 are not implemented");if(e<1)throw new Error("Order should be at least 1");var t=[[[0,0,1],[180,0,1]],[[45,35.26,1],[-45,-35.26,1],[135,-35.26,1],[-135,35.26,1]],[[0,0,1],[180,0,1],[90,0,1],[-90,0,1],[0,90,1],[0,-90,1]],[[0,-31.72,1],[-58.28,0,1],[-90,58.28,1],[0,31.72,1],[-121.72,0,1],[90,-58.28,1],[180,-31.72,1],[121.72,0,1],[90,58.28,1],[180,31.72,1],[58.28,0,1],[-90,-58.28,1]],[[0,-31.72,1],[-58.28,0,1],[-90,58.28,1],[0,31.72,1],[-121.72,0,1],[90,-58.28,1],[180,-31.72,1],[121.72,0,1],[90,58.28,1],[180,31.72,1],[58.28,0,1],[-90,-58.28,1]],[[26,15.46,1],[-26,-15.46,1],[17.11,-24.99,1],[-17.11,24.99,1],[154,-15.46,1],[-154,15.46,1],[162.89,24.99,1],[-162.89,-24.99,1],[72.89,24.99,1],[107.11,-24.99,1],[116,15.46,1],[64,-15.46,1],[-107.11,24.99,1],[-72.89,-24.99,1],[-64,15.46,1],[-116,-15.46,1],[32.25,60.03,1],[-147.75,60.03,1],[-57.75,60.03,1],[122.25,60.03,1],[-32.25,-60.03,1],[147.75,-60.03,1],[57.75,-60.03,1],[-122.25,-60.03,1]],[[26,15.46,1],[-26,-15.46,1],[17.11,-24.99,1],[-17.11,24.99,1],[154,-15.46,1],[-154,15.46,1],[162.89,24.99,1],[-162.89,-24.99,1],[72.89,24.99,1],[107.11,-24.99,1],[116,15.46,1],[64,-15.46,1],[-107.11,24.99,1],[-72.89,-24.99,1],[-64,15.46,1],[-116,-15.46,1],[32.25,60.03,1],[-147.75,60.03,1],[-57.75,60.03,1],[122.25,60.03,1],[-32.25,-60.03,1],[147.75,-60.03,1],[57.75,-60.03,1],[-122.25,-60.03,1]],[[-31.11,53.65,1],[110.82,30.5,1],[148.89,53.65,1],[32.21,-17.83,1],[69.18,-30.5,1],[-32.21,17.83,1],[-69.18,30.5,1],[-147.79,-17.83,1],[-110.82,-30.5,1],[147.79,17.83,1],[31.11,-53.65,1],[-148.89,-53.65,1],[-21.25,-47.78,1],[-108.2,38.78,1],[158.75,-47.78,1],[139.77,-14.09,1],[-71.8,-38.78,1],[-139.77,14.09,1],[71.8,38.78,1],[-40.23,-14.09,1],[108.2,-38.78,1],[40.23,14.09,1],[21.25,47.78,1],[-158.75,47.78,1],[106.65,-2.55,1],[-2.66,-16.63,1],[-73.35,-2.55,1],[-98.84,73.16,1],[-177.34,16.63,1],[98.84,-73.16,1],[177.34,-16.63,1],[81.16,73.16,1],[2.66,16.63,1],[-81.16,-73.16,1],[-106.65,2.55,1],[73.35,2.55,1]],[[20.75,-3.55,1],[-20.75,3.55,1],[-3.8,-20.7,1],[3.8,20.7,1],[159.25,3.55,1],[-159.25,-3.55,1],[-176.2,20.7,1],[176.2,-20.7,1],[93.8,20.7,1],[86.2,-20.7,1],[110.75,-3.55,1],[69.25,3.55,1],[-86.2,20.7,1],[-93.8,-20.7,1],[-69.25,-3.55,1],[-110.75,3.55,1],[-9.94,68.97,1],[170.06,68.97,1],[-99.94,68.97,1],[80.06,68.97,1],[9.94,-68.97,1],[-170.06,-68.97,1],[99.94,-68.97,1],[-80.06,-68.97,1],[42.15,17.57,1],[-42.15,-17.57,1],[23.12,-39.77,1],[-23.12,39.77,1],[137.85,-17.57,1],[-137.85,17.57,1],[156.88,39.77,1],[-156.88,-39.77,1],[66.88,39.77,1],[113.12,-39.77,1],[132.15,17.57,1],[47.85,-17.57,1],[-113.12,39.77,1],[-66.88,-39.77,1],[-47.85,17.57,1],[-132.15,-17.57,1],[25.26,44.98,1],[-154.74,44.98,1],[-64.74,44.98,1],[115.26,44.98,1],[-25.26,-44.98,1],[154.74,-44.98,1],[64.74,-44.98,1],[-115.26,-44.98,1]],[[144.09,-21.45,1],[-33.81,-48.92,1],[-35.91,-21.45,1],[-115.87,33.09,1],[-146.19,48.92,1],[115.87,-33.09,1],[146.19,-48.92,1],[64.13,33.09,1],[33.81,48.92,1],[-64.13,-33.09,1],[-144.09,21.45,1],[35.91,21.45,1],[-45.53,1.95,1],[177.26,44.44,1],[134.47,1.95,1],[87.21,-45.49,1],[2.74,-44.44,1],[-87.21,45.49,1],[-2.74,44.44,1],[-92.79,-45.49,1],[-177.26,-44.44,1],[92.79,45.49,1],[45.53,-1.95,1],[-134.47,-1.95,1],[15.59,-73.34,1],[-85.4,16.04,1],[-164.41,-73.34,1],[163.92,4.42,1],[-94.6,-16.04,1],[-163.92,-4.42,1],[94.6,16.04,1],[-16.08,4.42,1],[85.4,-16.04,1],[16.08,-4.42,1],[-15.59,73.34,1],[164.41,73.34,1],[-60.02,25.27,1],[151.41,26.86,1],[119.98,25.27,1],[46.63,-51.57,1],[28.59,-26.86,1],[-46.63,51.57,1],[-28.59,26.86,1],[-133.37,-51.57,1],[-151.41,-26.86,1],[133.37,51.57,1],[60.02,-25.27,1],[-119.98,-25.27,1],[-109.94,6.91,1],[172.65,-19.79,1],[70.06,6.91,1],[-70.44,-68.94,1],[7.35,19.79,1],[70.44,68.94,1],[-7.35,-19.79,1],[109.56,-68.94,1],[-172.65,19.79,1],[-109.56,68.94,1],[109.94,-6.91,1],[-70.06,-6.91,1]],[[132.93,7.69,1],[-83.93,-23.73,1],[8.47,23.51,1],[-113.34,70.42,1],[-103.27,-9.9,1],[-33.24,-70.75,1],[21.86,-26.46,1],[-156.54,47.78,1],[-64.26,-7.72,1],[165.78,44.53,1],[-25.2,26.39,1],[-97,-44.66,1],[27.85,9.77,1],[153.21,-47.71,1],[-155.06,7.45,1],[-11.84,-23.59,1],[80.54,23.72,1],[-42.06,70.44,1],[-31.22,-9.84,1],[38.84,-70.5,1],[93.76,-26.29,1],[-84.76,47.61,1],[7.76,-7.52,1],[-122.28,44.29,1],[46.8,26.64,1],[-24.77,-44.57,1],[99.89,9.91,1],[-134.78,-47.96,1],[-83.09,7.3,1],[60.13,-23.34,1],[152.64,23.64,1],[29.76,70.68,1],[40.78,-9.58,1],[110.18,-70.39,1],[165.65,-26.43,1],[-12.99,47.75,1],[79.74,-7.31,1],[-50.52,44.26,1],[118.92,26.71,1],[47.22,-44.31,1],[171.93,9.76,1],[-62.51,-48.04,1],[-11.12,7.44,1],[132.02,-23.33,1],[-135.36,23.39,1],[102.37,70.82,1],[112.74,-9.49,1],[-178.3,-70.58,1],[-122.32,-26.67,1],[59.08,48,1],[151.7,-7.38,1],[21.38,44.5,1],[-169.01,26.5,1],[118.98,-44.25,1],[-116.09,9.52,1],[9.65,-47.83,1],[60.89,7.68,1],[-156.02,-23.57,1],[-63.46,23.31,1],[174.93,70.66,1],[-175.29,-9.68,1],[-105.95,-70.8,1],[-50.19,-26.7,1],[131.36,48.01,1],[-136.3,-7.64,1],[93.56,44.67,1],[-97.08,26.3,1],[-169.16,-44.46,1],[-44.13,9.52,1],[81.48,-47.62,1]],[[-154.47,7.9,1],[162.15,-63.36,1],[25.53,7.9,1],[-81.26,-25.27,1],[17.85,63.36,1],[81.26,25.27,1],[-17.85,-63.36,1],[98.74,-25.27,1],[-162.15,63.36,1],[-98.74,25.27,1],[154.47,-7.9,1],[-25.53,-7.9,1],[1.3,-10.47,1],[-83.01,79.45,1],[-178.7,-10.47,1],[100.48,1.28,1],[-96.99,-79.45,1],[-100.48,-1.28,1],[96.99,79.45,1],[-79.52,1.28,1],[83.01,-79.45,1],[79.52,-1.28,1],[-1.3,10.47,1],[178.7,10.47,1],[157.24,13.15,1],[31.14,-63.89,1],[-22.76,13.15,1],[-75.78,22.13,1],[148.86,63.89,1],[75.78,-22.13,1],[-148.86,-63.89,1],[104.22,22.13,1],[-31.14,63.89,1],[-104.22,-22.13,1],[-157.24,-13.15,1],[22.76,-13.15,1],[110.44,-60.62,1],[-62.18,-9.87,1],[-69.56,-60.62,1],[-168.88,27.37,1],[-117.82,9.87,1],[168.88,-27.37,1],[117.82,-9.87,1],[11.12,27.37,1],[62.18,9.87,1],[-11.12,-27.37,1],[-110.44,60.62,1],[69.56,60.62,1],[-125.93,-47.4,1],[-126.67,-23.4,1],[54.07,-47.4,1],[-151.65,-33.24,1],[-53.33,23.4,1],[151.65,33.24,1],[53.33,-23.4,1],[28.35,-33.24,1],[126.67,23.4,1],[-28.35,33.24,1],[125.93,47.4,1],[-54.07,47.4,1],[61.41,37.54,1],[41.19,22.3,1],[-118.59,37.54,1],[31.92,44.13,1],[138.81,-22.3,1],[-31.92,-44.13,1],[-138.81,22.3,1],[-148.08,44.13,1],[-41.19,-22.3,1],[148.08,-44.13,1],[-61.41,-37.54,1],[118.59,-37.54,1],[132.92,4.73,1],[6.45,-42.74,1],[-47.08,4.73,1],[-83.07,46.87,1],[173.55,42.74,1],[83.07,-46.87,1],[-173.55,-42.74,1],[96.93,46.87,1],[-6.45,42.74,1],[-96.93,-46.87,1],[-132.92,-4.73,1],[47.08,-4.73,1]],[[-40.36,68.7,1],[61.12,65.68,1],[141.73,70.75,1],[-131.25,72.32,1],[-154.88,-12.62,1],[-66.2,-9.78,1],[26.36,-11.97,1],[114.95,-12.58,1],[37.02,51.13,1],[129.77,51.95,1],[-140.63,50.15,1],[-56.5,47.88,1],[-65.05,12.58,1],[25.12,12.62,1],[113.8,9.78,1],[-153.64,11.97,1],[-134.51,-9.73,1],[-46.23,-8.37,1],[47.91,-9.73,1],[141.51,-8.73,1],[-17.84,-44.1,1],[69.37,-43.27,1],[151.22,-42.67,1],[-106.78,-40.18,1],[-50.23,-51.95,1],[39.37,-50.15,1],[123.5,-47.88,1],[-142.98,-51.13,1],[-179.19,-60.75,1],[-84.57,-54.07,1],[5.39,-58.05,1],[89.5,-60.75,1],[-145.98,31.02,1],[-54.39,26.43,1],[28.92,32.51,1],[125.34,30.94,1],[168.71,-7.06,1],[-112.49,-10.38,1],[-21.96,-9.6,1],[73.11,-8.31,1],[95.68,.04,1],[-170.71,2.32,1],[-84.32,-.04,1],[9.29,-2.32,1],[9.19,-34.33,1],[98.21,-37.31,1],[-179.2,-40.48,1],[-77.81,-31.6,1],[-177.08,-21.74,1],[-93.77,-18.83,1],[-2.72,-19.8,1],[90.51,-20.91,1],[-106.89,8.31,1],[-11.29,7.06,1],[67.51,10.38,1],[158.04,9.6,1],[-118.88,-65.68,1],[-38.27,-70.75,1],[48.75,-72.32,1],[139.64,-68.7,1],[-54.66,-30.94,1],[34.02,-31.02,1],[125.61,-26.43,1],[-151.08,-32.51,1],[-170.81,34.33,1],[-81.79,37.31,1],[.8,40.48,1],[102.19,31.6,1],[-28.78,42.67,1],[73.22,40.18,1],[162.16,44.1,1],[-110.63,43.27,1],[-89.49,20.91,1],[2.92,21.74,1],[86.23,18.83,1],[177.28,19.8,1],[133.77,8.37,1],[-132.09,9.73,1],[-38.49,8.73,1],[45.49,9.73,1],[-25.6,24.04,1],[55.12,30.23,1],[149.3,28.05,1],[-118.71,26.06,1],[.81,60.75,1],[95.43,54.07,1],[-174.61,58.05,1],[-90.5,60.75,1],[-124.88,-30.23,1],[-30.7,-28.05,1],[61.29,-26.06,1],[154.4,-24.04,1],[-132.92,-85.6,1],[47.08,85.6,1]],[[-129.19,8.11,1],[169.58,-38.73,1],[50.81,8.12,1],[-77.27,-50.11,1],[10.42,38.73,1],[77.3,50.12,1],[-10.41,-38.72,1],[102.71,-50.11,1],[-169.57,38.72,1],[-102.71,50.11,1],[129.19,-8.11,1],[-50.8,-8.11,1],[-4.59,-56.01,1],[-93.1,33.85,1],[175.39,-56.03,1],[146.11,-2.57,1],[-86.89,-33.86,1],[-146.1,2.56,1],[86.91,33.86,1],[-33.89,-2.57,1],[93.1,-33.85,1],[33.9,2.58,1],[4.6,56.03,1],[-175.38,56.01,1],[106.57,26.1,1],[27.07,-14.82,1],[-73.44,26.09,1],[-30.2,59.41,1],[152.94,14.83,1],[30.2,-59.4,1],[-152.93,-14.84,1],[149.82,59.41,1],[-27.06,14.83,1],[-149.8,-59.42,1],[-106.55,-26.1,1],[73.44,-26.09,1],[-171.42,77.45,1],[91.9,-12.4,1],[8.54,77.46,1],[-12.4,-1.85,1],[88.11,12.41,1],[12.41,1.86,1],[-88.1,-12.41,1],[167.6,-1.86,1],[-91.89,12.4,1],[-167.59,1.84,1],[171.43,-77.46,1],[-8.52,-77.45,1],[-122.73,-10.44,1],[-167.65,-32.13,1],[57.27,-10.43,1],[-108.8,-55.83,1],[-12.35,32.13,1],[108.83,55.83,1],[12.36,-32.12,1],[71.19,-55.82,1],[167.66,32.12,1],[-71.19,55.82,1],[122.74,10.44,1],[-57.27,10.44,1],[-135.84,-23.05,1],[-148.58,-41.32,1],[44.16,-23.04,1],[-120.66,-39.88,1],[-31.41,41.31,1],[120.68,39.87,1],[31.42,-41.3,1],[59.33,-39.86,1],[148.6,41.31,1],[-59.33,39.87,1],[135.85,23.05,1],[-44.16,23.05,1],[-161.55,20.62,1],[130.04,-62.6,1],[18.45,20.64,1],[-68.35,-17.23,1],[49.96,62.61,1],[68.36,17.23,1],[-49.93,-62.6,1],[111.65,-17.22,1],[-130.05,62.59,1],[-111.64,17.22,1],[161.56,-20.63,1],[-18.44,-20.62,1],[-105.23,-3.38,1],[-176.5,-15.21,1],[74.77,-3.37,1],[-102.64,-74.41,1],[-3.5,15.21,1],[102.69,74.41,1],[3.51,-15.2,1],[77.33,-74.4,1],[176.51,15.2,1],[-77.36,74.4,1],[105.24,3.38,1],[-74.76,3.37,1],[-142.39,25.42,1],[142.08,-45.69,1],[37.61,25.43,1],[-59.02,-33.44,1],[37.92,45.69,1],[59.04,33.45,1],[-37.91,-45.68,1],[120.97,-33.44,1],[-142.07,45.68,1],[-120.96,33.44,1],[142.4,-25.43,1],[-37.6,-25.42,1]],[[-30.6,6.94,1],[166.56,58.69,1],[149.4,6.96,1],[81.95,-30.36,1],[13.48,-58.69,1],[-81.93,30.36,1],[-13.46,58.68,1],[-98.06,-30.37,1],[-166.54,-58.68,1],[98.07,30.37,1],[30.62,-6.95,1],[-149.38,-6.95,1],[106.69,-22.68,1],[-23.57,-15.36,1],[-73.31,-22.69,1],[-145.5,62.1,1],[-156.41,15.36,1],[145.53,-62.1,1],[156.43,-15.35,1],[34.47,62.11,1],[23.58,15.36,1],[-34.46,-62.11,1],[-106.67,22.68,1],[73.33,22.69,1],[166.82,1.39,1],[6.09,-76.74,1],[-13.19,1.38,1],[-88.57,13.18,1],[173.99,76.74,1],[88.59,-13.18,1],[-173.97,-76.73,1],[91.43,13.2,1],[-6.07,76.73,1],[-91.42,-13.2,1],[-166.8,-1.38,1],[13.2,-1.39,1],[-74.67,48.11,1],[130.86,10.16,1],[105.32,48.13,1],[13.34,-40.08,1],[49.16,-10.15,1],[-13.32,40.07,1],[-49.14,10.15,1],[-166.67,-40.08,1],[-130.84,-10.16,1],[166.69,40.08,1],[74.7,-48.11,1],[-105.31,-48.13,1],[-126.99,26.55,1],[147.96,-32.57,1],[53,26.56,1],[-50.28,-45.59,1],[32.05,32.58,1],[50.3,45.59,1],[-32.03,-32.58,1],[129.71,-45.58,1],[-147.94,32.57,1],[-129.69,45.58,1],[127.02,-26.55,1],[-52.98,-26.56,1],[-171.93,30.37,1],[103.47,-58.68,1],[8.07,30.36,1],[-59.38,-6.96,1],[76.54,58.69,1],[59.4,6.95,1],[-76.53,-58.69,1],[120.62,-6.94,1],[-103.44,58.68,1],[-120.6,6.95,1],[171.94,-30.36,1],[-8.05,-30.37,1],[40.86,10.16,1],[15.32,48.12,1],[-139.14,10.16,1],[76.68,40.09,1],[164.69,-48.12,1],[-76.67,-40.09,1],[-164.67,48.12,1],[-103.31,40.07,1],[-15.3,-48.13,1],[103.34,-40.07,1],[-40.84,-10.16,1],[139.16,-10.15,1],[103.2,-1.38,1],[-1.41,-13.19,1],[-76.8,-1.39,1],[-96.02,76.73,1],[-178.57,13.19,1],[96.07,-76.73,1],[178.58,-13.19,1],[83.94,76.74,1],[1.43,13.19,1],[-83.95,-76.74,1],[-103.18,1.38,1],[76.81,1.39,1],[37.02,-26.56,1],[-39.7,45.58,1],[-142.99,-26.56,1],[122.05,32.58,1],[-140.29,-45.59,1],[-122.04,-32.58,1],[140.31,45.59,1],[-57.95,32.57,1],[39.72,-45.58,1],[57.97,-32.57,1],[-37,26.55,1],[143,26.56,1],[163.33,22.69,1],[55.55,-62.1,1],[-16.67,22.68,1],[-66.41,15.35,1],[124.49,62.11,1],[66.43,-15.35,1],[-124.48,-62.11,1],[113.58,15.36,1],[-55.52,62.1,1],[-113.57,-15.36,1],[-163.31,-22.68,1],[16.69,-22.69,1]],[[-10.57,-17.35,1],[-120.42,69.76,1],[169.43,-17.35,1],[107.63,-10.08,1],[-59.57,-69.78,1],[-107.63,10.08,1],[59.57,69.78,1],[-72.37,-10.09,1],[120.42,-69.76,1],[72.37,10.09,1],[10.57,17.35,1],[-169.43,17.35,1],[-30.77,68.25,1],[101.53,18.57,1],[149.25,68.26,1],[18.92,-10.92,1],[78.47,-18.56,1],[-18.92,10.92,1],[-78.47,18.56,1],[-161.09,-10.92,1],[-101.53,-18.56,1],[161.09,10.92,1],[30.78,-68.26,1],[-149.26,-68.26,1],[56.46,41.26,1],[46.46,24.54,1],[-123.53,41.26,1],[32.19,38.8,1],[133.53,-24.53,1],[-32.19,-38.8,1],[-133.53,24.53,1],[-147.8,38.8,1],[-46.46,-24.54,1],[147.8,-38.8,1],[-56.46,-41.27,1],[123.53,-41.26,1],[84.74,27.31,1],[27.41,4.68,1],[-95.26,27.3,1],[10.06,62.23,1],[152.59,-4.67,1],[-10.06,-62.23,1],[-152.59,4.67,1],[-169.92,62.23,1],[-27.4,-4.68,1],[169.92,-62.22,1],[-84.74,-27.31,1],[95.26,-27.3,1],[136.27,-.73,1],[-1.05,-46.27,1],[-43.73,-.74,1],[-91.01,43.72,1],[-178.94,46.27,1],[91.01,-43.72,1],[178.94,-46.27,1],[88.99,43.73,1],[1.05,46.27,1],[-88.99,-43.73,1],[-136.27,.73,1],[43.73,.73,1],[55.23,10.82,1],[13.09,34.07,1],[-124.77,10.81,1],[71.48,53.8,1],[166.91,-34.06,1],[-71.48,-53.8,1],[-166.9,34.06,1],[-108.52,53.79,1],[-13.09,-34.06,1],[108.52,-53.79,1],[-55.23,-10.82,1],[124.77,-10.81,1],[-105.49,-68.13,1],[-111.15,-5.71,1],[74.52,-68.12,1],[-173.89,-21.04,1],[-68.85,5.7,1],[173.89,21.04,1],[68.85,-5.7,1],[6.12,-21.04,1],[111.15,5.71,1],[-6.12,21.04,1],[105.49,68.13,1],[-74.52,68.12,1],[35.28,-15.18,1],[-25.17,51.98,1],[-144.72,-15.19,1],[108.39,33.88,1],[-154.84,-51.99,1],[-108.39,-33.88,1],[154.84,51.99,1],[-71.61,33.87,1],[25.17,-51.98,1],[71.61,-33.87,1],[-35.28,15.18,1],[144.72,15.19,1],[-125.28,-28.56,1],[-146.32,-30.49,1],[54.72,-28.55,1],[-133.29,-45.82,1],[-33.69,30.48,1],[133.3,45.82,1],[33.68,-30.48,1],[46.71,-45.81,1],[146.32,30.49,1],[-46.71,45.81,1],[125.28,28.56,1],[-54.72,28.54,1],[-144.4,54.71,1],[112.38,-28.01,1],[35.58,54.72,1],[-29.92,-19.65,1],[67.62,28.02,1],[29.92,19.65,1],[-67.62,-28.02,1],[150.08,-19.64,1],[-112.38,28.01,1],[-150.08,19.64,1],[144.4,-54.71,1],[-35.58,-54.72,1],[68.53,-52.85,1],[-54.82,12.76,1],[-111.46,-52.87,1],[164.51,34.19,1],[-125.18,-12.77,1],[-164.51,-34.19,1],[125.18,12.77,1],[-15.5,34.19,1],[54.82,-12.76,1],[15.49,-34.19,1],[-68.53,52.85,1],[111.47,52.86,1],[91.48,-7.37,1],[-7.38,-1.47,1],[-88.52,-7.38,1],[-168.69,82.47,1],[-172.62,1.47,1],[168.69,-82.47,1],[172.62,-1.46,1],[11.22,82.48,1],[7.38,1.47,1],[-11.21,-82.48,1],[-91.48,7.37,1],[88.52,7.38,1]],[[-110.97,-81.34,1],[-98.09,-3.09,1],[69.03,-81.34,1],[-176.88,-8.08,1],[-81.91,3.09,1],[176.88,8.08,1],[81.91,-3.09,1],[3.12,-8.08,1],[98.09,3.09,1],[-3.12,8.08,1],[110.97,81.34,1],[-69.03,81.34,1],[145.76,30.52,1],[46.33,-45.41,1],[-34.24,30.52,1],[-54.51,28.99,1],[133.67,45.41,1],[54.51,-28.99,1],[-133.67,-45.41,1],[125.49,28.99,1],[-46.33,45.41,1],[-125.49,-28.99,1],[-145.76,-30.52,1],[34.24,-30.52,1],[159.58,41.4,1],[68.4,-44.67,1],[-20.42,41.4,1],[-46.75,15.18,1],[111.6,44.67,1],[46.75,-15.18,1],[-111.6,-44.67,1],[133.25,15.18,1],[-68.4,44.67,1],[-133.25,-15.18,1],[-159.58,-41.4,1],[20.42,-41.4,1],[85.43,-37.93,1],[-38.02,3.6,1],[-94.57,-37.93,1],[174.17,51.83,1],[-141.98,-3.6,1],[-174.17,-51.83,1],[141.98,3.6,1],[-5.83,51.83,1],[38.02,-3.6,1],[5.83,-51.83,1],[-85.43,37.93,1],[94.57,37.93,1],[21.18,27.17,1],[54.86,56.05,1],[-158.82,27.17,1],[61.17,18.75,1],[125.14,-56.05,1],[-61.17,-18.75,1],[-125.14,56.05,1],[-118.83,18.75,1],[-54.86,-56.05,1],[118.83,-18.75,1],[-21.18,-27.17,1],[158.82,-27.17,1],[104.66,-9.56,1],[-9.88,-14.45,1],[-75.34,-9.56,1],[-123.65,72.56,1],[-170.12,14.45,1],[123.65,-72.56,1],[170.12,-14.45,1],[56.35,72.56,1],[9.88,14.45,1],[-56.35,-72.56,1],[-104.66,9.56,1],[75.34,9.56,1],[25.94,-16.83,1],[-34.66,59.4,1],[-154.06,-16.83,1],[108.59,24.75,1],[-145.34,-59.41,1],[-108.59,-24.75,1],[145.34,59.41,1],[-71.41,24.75,1],[34.66,-59.41,1],[71.41,-24.75,1],[-25.94,16.83,1],[154.06,16.83,1],[-100.89,26.49,1],[153.1,-9.74,1],[79.11,26.49,1],[-20.77,-61.51,1],[26.9,9.74,1],[20.77,61.51,1],[-26.9,-9.74,1],[159.23,-61.51,1],[-153.1,9.74,1],[-159.23,61.51,1],[100.89,-26.49,1],[-79.11,-26.49,1],[44.31,12.28,1],[17.3,44.36,1],[-135.69,12.28,1],[73.08,43.05,1],[162.7,-44.36,1],[-73.08,-43.05,1],[-162.7,44.36,1],[-106.92,43.05,1],[-17.3,-44.36,1],[106.92,-43.05,1],[-44.31,-12.28,1],[135.69,-12.28,1],[-169.08,-24.53,1],[-112.54,-63.29,1],[10.92,-24.53,1],[-114.93,-9.92,1],[-67.46,63.28,1],[114.93,9.92,1],[67.46,-63.29,1],[65.07,-9.92,1],[112.54,63.29,1],[-65.07,9.92,1],[169.08,24.53,1],[-10.92,24.53,1],[93.2,-57.39,1],[-57.43,-1.73,1],[-86.8,-57.39,1],[-177.95,32.55,1],[-122.57,1.73,1],[177.95,-32.55,1],[122.57,-1.73,1],[2.05,32.55,1],[57.43,1.73,1],[-2.05,-32.55,1],[-93.2,57.39,1],[86.8,57.39,1],[-17.59,3.04,1],[170.04,72.16,1],[162.41,3.04,1],[86.81,-17.56,1],[9.96,-72.16,1],[-86.81,17.56,1],[-9.96,72.16,1],[-93.19,-17.56,1],[-170.04,-72.16,1],[93.19,17.56,1],[17.59,-3.04,1],[-162.41,-3.04,1],[39.38,44.26,1],[56.93,33.61,1],[-140.62,44.26,1],[38.42,27.03,1],[123.07,-33.61,1],[-38.42,-27.03,1],[-123.07,33.61,1],[-141.58,27.03,1],[-56.93,-33.61,1],[141.58,-27.03,1],[-39.38,-44.26,1],[140.62,-44.26,1]],[[165.52,26.52,1],[63.39,-60.04,1],[-14.48,26.52,1],[-62.74,12.93,1],[116.61,60.04,1],[62.74,-12.93,1],[-116.61,-60.04,1],[117.26,12.93,1],[-63.39,60.04,1],[-117.26,-12.93,1],[-165.52,-26.52,1],[14.48,-26.52,1],[-150.22,-21.62,1],[-141.41,-53.79,1],[29.78,-21.62,1],[-114.55,-27.5,1],[-38.59,53.79,1],[114.55,27.5,1],[38.59,-53.79,1],[65.45,-27.5,1],[141.41,53.79,1],[-65.45,27.5,1],[150.22,21.62,1],[-29.78,21.62,1],[-163.47,81.91,1],[92.31,-7.75,1],[16.53,81.91,1],[-7.76,-2.29,1],[87.69,7.75,1],[7.76,2.29,1],[-87.69,-7.75,1],[172.24,-2.29,1],[-92.31,7.75,1],[-172.24,2.29,1],[163.47,-81.91,1],[-16.53,-81.91,1],[-79.91,-73.49,1],[-106.27,2.85,1],[100.09,-73.49,1],[177.03,-16.24,1],[-73.73,-2.85,1],[-177.03,16.24,1],[73.73,2.85,1],[-2.97,-16.24,1],[106.27,-2.85,1],[2.97,16.24,1],[79.91,73.49,1],[-100.09,73.49,1],[-43.19,73.63,1],[101.37,11.86,1],[136.81,73.63,1],[12.09,-11.12,1],[78.63,-11.86,1],[-12.09,11.12,1],[-78.63,11.86,1],[-167.91,-11.12,1],[-101.37,-11.86,1],[167.91,11.12,1],[43.19,-73.63,1],[-136.81,-73.63,1],[109.86,-34.83,1],[-36.5,-16.19,1],[-70.14,-34.83,1],[-153.97,50.53,1],[-143.5,16.19,1],[153.97,-50.53,1],[143.5,-16.19,1],[26.03,50.53,1],[36.5,16.19,1],[-26.03,-50.53,1],[-109.86,34.83,1],[70.14,34.83,1],[-23.31,-6.54,1],[-163.84,65.83,1],[156.69,-6.54,1],[97.12,-23.15,1],[-16.16,-65.83,1],[-97.12,23.15,1],[16.16,65.83,1],[-82.88,-23.15,1],[163.84,-65.83,1],[82.88,23.15,1],[23.31,6.54,1],[-156.69,6.54,1],[-.87,-31.92,1],[-91.4,58.07,1],[179.13,-31.92,1],[121.93,-.74,1],[-88.6,-58.07,1],[-121.93,.74,1],[88.6,58.07,1],[-58.07,-.74,1],[91.4,-58.07,1],[58.07,.74,1],[.87,31.92,1],[-179.13,31.92,1],[163.12,43.35,1],[72.9,-44.1,1],[-16.88,43.35,1],[-45.39,12.19,1],[107.1,44.1,1],[45.39,-12.19,1],[-107.1,-44.1,1],[134.61,12.19,1],[-72.9,44.1,1],[-134.61,-12.19,1],[-163.12,-43.35,1],[16.88,-43.35,1],[-114.23,50.37,1],[127.06,-15.17,1],[65.77,50.37,1],[-18.77,-35.57,1],[52.94,15.17,1],[18.77,35.57,1],[-52.94,-15.17,1],[161.23,-35.57,1],[-127.06,15.17,1],[-161.23,35.57,1],[114.23,-50.37,1],[-65.77,-50.37,1],[54.17,30.16,1],[35.63,30.41,1],[-125.83,30.16,1],[45.21,44.51,1],[144.37,-30.41,1],[-45.21,-44.51,1],[-144.37,30.41,1],[-134.79,44.51,1],[-35.63,-30.41,1],[134.79,-44.51,1],[-54.17,-30.16,1],[125.83,-30.16,1],[126.2,41.73,1],[47.86,-26.15,1],[-53.8,41.73,1],[-33.51,37.03,1],[132.14,26.15,1],[33.51,-37.03,1],[-132.14,-26.15,1],[146.49,37.03,1],[-47.86,26.15,1],[-146.49,-37.03,1],[-126.2,-41.73,1],[53.8,-41.73,1],[-161.75,20.38,1],[130.12,-62.91,1],[18.25,20.38,1],[-68.63,-17.07,1],[49.88,62.91,1],[68.63,17.07,1],[-49.88,-62.91,1],[111.37,-17.07,1],[-130.12,62.91,1],[-111.37,17.07,1],[161.75,-20.38,1],[-18.25,-20.38,1],[2.71,48.49,1],[87.6,41.45,1],[-177.29,48.49,1],[41.48,1.8,1],[92.4,-41.45,1],[-41.48,-1.8,1],[-92.4,41.45,1],[-138.52,1.8,1],[-87.6,-41.45,1],[138.52,-1.8,1],[-2.71,-48.49,1],[177.29,-48.49,1],[-98.15,-27.54,1],[-152.22,-7.22,1],[81.85,-27.54,1],[-164.79,-61.37,1],[-27.78,7.22,1],[164.79,61.37,1],[27.78,-7.22,1],[15.21,-61.37,1],[152.22,7.22,1],[-15.21,61.37,1],[98.15,27.54,1],[-81.85,27.54,1]],[[-40.48,43.36,1],[124.51,33.58,1],[139.52,43.36,1],[38.85,-28.17,1],[55.49,-33.58,1],[-38.85,28.17,1],[-55.49,33.58,1],[-141.15,-28.17,1],[-124.51,-33.58,1],[141.15,28.17,1],[40.48,-43.36,1],[-139.52,-43.36,1],[56.01,17.18,1],[20.46,32.29,1],[-123.99,17.18,1],[61.05,52.38,1],[159.54,-32.29,1],[-61.05,-52.38,1],[-159.54,32.29,1],[-118.95,52.38,1],[-20.46,-32.29,1],[118.95,-52.38,1],[-56.01,-17.18,1],[123.99,-17.18,1],[-179.51,-8.95,1],[-93.08,-81.04,1],[.49,-8.95,1],[-98.95,-.48,1],[-86.92,81.04,1],[98.95,.48,1],[86.92,-81.04,1],[81.05,-.48,1],[93.08,81.04,1],[-81.05,.48,1],[179.51,8.95,1],[-.49,8.95,1],[12.04,-13.56,1],[-49.15,71.95,1],[-167.96,-13.56,1],[103.85,11.7,1],[-130.85,-71.95,1],[-103.85,-11.7,1],[130.85,71.95,1],[-76.15,11.7,1],[49.15,-71.95,1],[76.15,-11.7,1],[-12.04,13.56,1],[167.96,13.56,1],[-13.62,-58.2,1],[-98.3,30.8,1],[166.38,-58.2,1],[148.93,-7.13,1],[-81.7,-30.8,1],[-148.93,7.13,1],[81.7,30.8,1],[-31.07,-7.13,1],[98.3,-30.8,1],[31.07,7.13,1],[13.62,58.2,1],[-166.38,58.2,1],[65.26,-20.55,1],[-22.43,23.07,1],[-114.74,-20.55,1],[131.85,58.26,1],[-157.57,-23.07,1],[-131.85,-58.26,1],[157.57,23.07,1],[-48.15,58.26,1],[22.43,-23.07,1],[48.15,-58.26,1],[-65.26,20.55,1],[114.74,20.55,1],[-135.39,26.5,1],[144.63,-39.58,1],[44.61,26.5,1],[-55,-38.94,1],[35.37,39.58,1],[55,38.94,1],[-35.37,-39.58,1],[125,-38.94,1],[-144.63,39.58,1],[-125,38.94,1],[135.39,-26.5,1],[-44.61,-26.5,1],[114.95,-4.75,1],[-5.23,-24.86,1],[-65.05,-4.75,1],[-101.14,64.63,1],[-174.77,24.86,1],[101.14,-64.63,1],[174.77,-24.86,1],[78.86,64.63,1],[5.23,24.86,1],[-78.86,-64.63,1],[-114.95,4.75,1],[65.05,4.75,1],[35.85,52.64,1],[65.91,29.46,1],[-144.15,52.64,1],[31.75,20.82,1],[114.09,-29.46,1],[-31.75,-20.82,1],[-114.09,29.46,1],[-148.25,20.82,1],[-65.91,-29.46,1],[148.25,-20.82,1],[-35.85,-52.64,1],[144.15,-52.64,1],[86.45,11.52,1],[11.54,3.48,1],[-93.55,11.52,1],[16.9,77.95,1],[168.46,-3.48,1],[-16.9,-77.95,1],[-168.46,3.48,1],[-163.1,77.95,1],[-11.54,-3.48,1],[163.1,-77.95,1],[-86.45,-11.52,1],[93.55,-11.52,1],[135.24,4.02,1],[5.69,-45.1,1],[-44.76,4.02,1],[-84.35,44.62,1],[174.31,45.1,1],[84.35,-44.62,1],[-174.31,-45.1,1],[95.65,44.62,1],[-5.69,45.1,1],[-95.65,-44.62,1],[-135.24,-4.02,1],[44.76,-4.02,1],[-129.84,-18.16,1],[-156.86,-37.5,1],[50.16,-18.16,1],[-117.12,-46.85,1],[-23.14,37.5,1],[117.12,46.85,1],[23.14,-37.5,1],[62.88,-46.85,1],[156.86,37.5,1],[-62.88,46.85,1],[129.84,18.16,1],[-50.16,18.16,1],[-74.1,32.87,1],[146.1,13.3,1],[105.9,32.87,1],[22.97,-53.88,1],[33.9,-13.3,1],[-22.97,53.88,1],[-33.9,13.3,1],[-157.03,-53.88,1],[-146.1,-13.3,1],[157.03,53.88,1],[74.1,-32.87,1],[-105.9,-32.87,1],[-119.92,-5.64,1],[-173.5,-29.76,1],[60.08,-5.64,1],[-101.2,-59.6,1],[-6.5,29.76,1],[101.2,59.6,1],[6.5,-29.76,1],[78.8,-59.6,1],[173.5,29.76,1],[-78.8,59.6,1],[119.92,5.64,1],[-60.08,5.64,1],[73.14,16.13,1],[16.82,16.18,1],[-106.86,16.13,1],[45.09,66.83,1],[163.18,-16.18,1],[-45.09,-66.83,1],[-163.18,16.18,1],[-134.91,66.83,1],[-16.82,-16.18,1],[134.91,-66.83,1],[-73.14,-16.13,1],[106.86,-16.13,1],[-11.7,-43.38,1],[-102.11,45.38,1],[168.3,-43.38,1],[133.98,-8.47,1],[-77.89,-45.38,1],[-133.98,8.47,1],[77.89,45.38,1],[-46.02,-8.47,1],[102.11,-45.38,1],[46.02,8.47,1],[11.7,43.38,1],[-168.3,43.38,1],[-24.11,3.73,1],[170.94,65.63,1],[155.89,3.73,1],[85.92,-24.05,1],[9.06,-65.63,1],[-85.92,24.05,1],[-9.06,65.63,1],[-94.08,-24.05,1],[-170.94,-65.63,1],[94.08,24.05,1],[24.11,-3.73,1],[-155.89,-3.73,1]],[[104.6,-3.68,1],[-3.81,-14.57,1],[-75.4,-3.68,1],[-104.32,74.95,1],[-176.19,14.57,1],[104.32,-74.95,1],[176.19,-14.57,1],[75.68,74.95,1],[3.81,14.57,1],[-75.68,-74.95,1],[-104.6,3.68,1],[75.4,3.68,1],[153.77,-30.33,1],[-52.93,-50.74,1],[-26.23,-30.33,1],[-123.11,22.43,1],[-127.07,50.74,1],[123.11,-22.43,1],[127.07,-50.74,1],[56.89,22.43,1],[52.93,50.74,1],[-56.89,-22.43,1],[-153.77,30.33,1],[26.23,30.33,1],[35.99,-39.77,1],[-54.77,38.45,1],[-144.01,-39.77,1],[135.81,26.85,1],[-125.23,-38.45,1],[-135.81,-26.85,1],[125.23,38.45,1],[-44.19,26.85,1],[54.77,-38.45,1],[44.19,-26.85,1],[-35.99,39.77,1],[144.01,39.77,1],[71.82,-25.43,1],[-26.58,16.37,1],[-108.18,-25.43,1],[146.72,59.1,1],[-153.42,-16.37,1],[-146.72,-59.1,1],[153.42,16.37,1],[-33.28,59.1,1],[26.58,-16.37,1],[33.28,-59.1,1],[-71.82,25.43,1],[108.18,25.43,1],[-136.55,26.52,1],[144.03,-40.51,1],[43.45,26.52,1],[-55.5,-37.97,1],[35.97,40.51,1],[55.5,37.97,1],[-35.97,-40.51,1],[124.5,-37.97,1],[-144.03,40.51,1],[-124.5,37.97,1],[136.55,-26.52,1],[-43.45,-26.52,1],[-6.52,-1.08,1],[-170.58,83.4,1],[173.48,-1.08,1],[91.09,-6.52,1],[-9.42,-83.4,1],[-91.09,6.52,1],[9.42,83.4,1],[-88.91,-6.52,1],[170.58,-83.4,1],[88.91,6.52,1],[6.52,1.08,1],[-173.48,1.08,1],[-71.13,40.38,1],[138.05,14.26,1],[108.87,40.38,1],[20.82,-46.12,1],[41.95,-14.26,1],[-20.82,46.12,1],[-41.95,14.26,1],[-159.18,-46.12,1],[-138.05,-14.26,1],[159.18,46.12,1],[71.13,-40.38,1],[-108.87,-40.38,1],[-153.97,-27.97,1],[-129.57,-52.52,1],[26.03,-27.97,1],[-120.59,-22.81,1],[-50.43,52.52,1],[120.59,22.81,1],[50.43,-52.52,1],[59.41,-22.81,1],[129.57,52.52,1],[-59.41,22.81,1],[153.97,27.97,1],[-26.03,27.97,1],[-80.23,13.48,1],[166.33,9.49,1],[99.77,13.48,1],[35.29,-73.41,1],[13.67,-9.49,1],[-35.29,73.41,1],[-13.67,9.49,1],[-144.71,-73.41,1],[-166.33,-9.49,1],[144.71,73.41,1],[80.23,-13.48,1],[-99.77,-13.48,1],[55.43,-9,1],[-10.89,34.09,1],[-124.57,-9,1],[105.6,54.41,1],[-169.11,-34.09,1],[-105.6,-54.41,1],[169.11,34.09,1],[-74.4,54.41,1],[10.89,-34.09,1],[74.4,-54.41,1],[-55.43,9,1],[124.57,9,1],[68.32,-7.14,1],[-7.68,21.51,1],[-111.68,-7.14,1],[108.74,67.22,1],[-172.32,-21.51,1],[-108.74,-67.22,1],[172.32,21.51,1],[-71.26,67.22,1],[7.68,-21.51,1],[71.26,-67.22,1],[-68.32,7.14,1],[111.68,7.14,1],[-174.97,36.12,1],[96.85,-53.58,1],[5.03,36.12,1],[-53.77,-4.06,1],[83.15,53.58,1],[53.77,4.06,1],[-83.15,-53.58,1],[126.23,-4.06,1],[-96.85,53.58,1],[-126.23,4.06,1],[174.97,-36.12,1],[-5.03,-36.12,1],[-149.91,16.26,1],[149.81,-56.16,1],[30.09,16.26,1],[-71.37,-28.77,1],[30.19,56.16,1],[71.37,28.77,1],[-30.19,-56.16,1],[108.63,-28.77,1],[-149.81,56.16,1],[-108.63,28.77,1],[149.91,-16.26,1],[-30.09,-16.26,1],[2.52,-51.45,1],[-87.99,38.5,1],[-177.48,-51.45,1],[141.48,1.57,1],[-92.01,-38.5,1],[-141.48,-1.57,1],[92.01,38.5,1],[-38.52,1.57,1],[87.99,-38.5,1],[38.52,-1.57,1],[-2.52,51.45,1],[177.48,51.45,1],[161.12,-9.98,1],[-28.54,-68.73,1],[-18.88,-9.98,1],[-100.54,18.59,1],[-151.46,68.73,1],[100.54,-18.59,1],[151.46,-68.73,1],[79.46,18.59,1],[28.54,68.73,1],[-79.46,-18.59,1],[-161.12,9.98,1],[18.88,9.98,1],[12.84,24.97,1],[64.49,62.11,1],[-167.16,24.97,1],[64.47,11.62,1],[115.51,-62.11,1],[-64.47,-11.62,1],[-115.51,62.11,1],[-115.53,11.62,1],[-64.49,-62.11,1],[115.53,-11.62,1],[-12.84,-24.97,1],[167.16,-24.97,1],[74.13,41.65,1],[42.76,11.79,1],[-105.87,41.65,1],[17.09,45.95,1],[137.24,-11.79,1],[-17.09,-45.95,1],[-137.24,11.79,1],[-162.91,45.95,1],[-42.76,-11.79,1],[162.91,-45.95,1],[-74.13,-41.65,1],[105.87,-41.65,1],[154.04,1.27,1],[2.9,-64.01,1],[-25.96,1.27,1],[-88.59,25.96,1],[177.1,64.01,1],[88.59,-25.96,1],[-177.1,-64.01,1],[91.41,25.96,1],[-2.9,64.01,1],[-91.41,-25.96,1],[-154.04,-1.27,1],[25.96,-1.27,1]],[[24.8,-10.46,1],[-23.76,63.21,1],[-155.2,-10.46,1],[101.5,24.36,1],[-156.24,-63.21,1],[-101.5,-24.36,1],[156.24,63.21,1],[-78.5,24.36,1],[23.76,-63.21,1],[78.5,-24.36,1],[-24.8,10.46,1],[155.2,10.46,1],[-134.64,65.44,1],[108.01,-16.98,1],[45.36,65.44,1],[-17.8,-17.2,1],[71.99,16.98,1],[17.8,17.2,1],[-71.99,-16.98,1],[162.2,-17.2,1],[-108.01,16.98,1],[-162.2,17.2,1],[134.64,-65.44,1],[-45.36,-65.44,1],[177.6,54.85,1],[88.31,-35.12,1],[-2.4,54.85,1],[-35.13,1.38,1],[91.69,35.12,1],[35.13,-1.38,1],[-91.69,-35.12,1],[144.87,1.38,1],[-88.31,35.12,1],[-144.87,-1.38,1],[-177.6,-54.85,1],[2.4,-54.85,1],[157.93,82.01,1],[86.98,-7.4,1],[-22.07,82.01,1],[-7.41,2.99,1],[93.02,7.4,1],[7.41,-2.99,1],[-93.02,-7.4,1],[172.59,2.99,1],[-86.98,7.4,1],[-172.59,-2.99,1],[-157.93,-82.01,1],[22.07,-82.01,1],[42.48,-13.21,1],[-19.17,45.89,1],[-137.52,-13.21,1],[107.66,41.11,1],[-160.83,-45.89,1],[-107.66,-41.11,1],[160.83,45.89,1],[-72.34,41.11,1],[19.17,-45.89,1],[72.34,-41.11,1],[-42.48,13.21,1],[137.52,13.21,1],[28.48,10.9,1],[21.99,59.68,1],[-151.52,10.9,1],[77.65,27.92,1],[158.01,-59.68,1],[-77.65,-27.92,1],[-158.01,59.68,1],[-102.35,27.92,1],[-21.99,-59.68,1],[102.35,-27.92,1],[-28.48,-10.9,1],[151.52,-10.9,1],[-33.79,21.61,1],[144.53,50.59,1],[146.21,21.61,1],[64.51,-31.14,1],[35.47,-50.59,1],[-64.51,31.14,1],[-35.47,50.59,1],[-115.49,-31.14,1],[-144.53,-50.59,1],[115.49,31.14,1],[33.79,-21.61,1],[-146.21,-21.61,1],[-175.53,-31.74,1],[-97.19,-57.98,1],[4.47,-31.74,1],[-121.82,-3.8,1],[-82.81,57.98,1],[121.82,3.8,1],[82.81,-57.98,1],[58.18,-3.8,1],[97.19,57.98,1],[-58.18,3.8,1],[175.53,31.74,1],[-4.47,31.74,1],[89.4,19.43,1],[19.43,.56,1],[-90.6,19.43,1],[1.69,70.56,1],[160.57,-.56,1],[-1.69,-70.56,1],[-160.57,.56,1],[-178.31,70.56,1],[-19.43,-.56,1],[178.31,-70.56,1],[-89.4,-19.43,1],[90.6,-19.43,1],[-27.28,-27.88,1],[-130.91,51.78,1],[152.72,-27.88,1],[120.76,-23.9,1],[-49.09,-51.78,1],[-120.76,23.9,1],[49.09,51.78,1],[-59.24,-23.9,1],[130.91,-51.78,1],[59.24,23.9,1],[27.28,27.88,1],[-152.72,27.88,1],[139.9,-15.44,1],[-23.21,-47.5,1],[-40.1,-15.44,1],[-109.85,38.38,1],[-156.79,47.5,1],[109.85,-38.38,1],[156.79,-47.5,1],[70.15,38.38,1],[23.21,47.5,1],[-70.15,-38.38,1],[-139.9,15.44,1],[40.1,15.44,1],[-2.17,-43.33,1],[-92.29,46.62,1],[177.83,-43.33,1],[133.35,-1.58,1],[-87.71,-46.62,1],[-133.35,1.58,1],[87.71,46.62,1],[-46.65,-1.58,1],[92.29,-46.62,1],[46.65,1.58,1],[2.17,43.33,1],[-177.83,43.33,1],[41.12,27.96,1],[38.91,41.71,1],[-138.88,27.96,1],[54.83,35.51,1],[141.09,-41.71,1],[-54.83,-35.51,1],[-141.09,41.71,1],[-125.17,35.51,1],[-38.91,-41.71,1],[125.17,-35.51,1],[-41.12,-27.96,1],[138.88,-27.96,1],[-126.67,13.75,1],[163.04,-35.46,1],[53.33,13.75,1],[-67.73,-51.18,1],[16.96,35.46,1],[67.73,51.18,1],[-16.96,-35.46,1],[112.27,-51.18,1],[-163.04,35.46,1],[-112.27,51.18,1],[126.67,-13.75,1],[-53.33,-13.75,1],[6.02,-15.42,1],[-69.18,73.47,1],[-173.98,-15.42,1],[105.51,5.8,1],[-110.82,-73.47,1],[-105.51,-5.8,1],[110.82,73.47,1],[-74.49,5.8,1],[69.18,-73.47,1],[74.49,-5.8,1],[-6.02,15.42,1],[173.98,15.42,1],[160.08,33.45,1],[62.71,-51.67,1],[-19.92,33.45,1],[-54.9,16.52,1],[117.29,51.67,1],[54.9,-16.52,1],[-117.29,-51.67,1],[125.1,16.52,1],[-62.71,51.67,1],[-125.1,-16.52,1],[-160.08,-33.45,1],[19.92,-33.45,1],[80.34,6.51,1],[6.61,9.59,1],[-99.66,6.51,1],[55.76,78.37,1],[173.39,-9.59,1],[-55.76,-78.37,1],[-173.39,9.59,1],[-124.24,78.37,1],[-6.61,-9.59,1],[124.24,-78.37,1],[-80.34,-6.51,1],[99.66,-6.51,1],[6.25,24.64,1],[76.64,64.63,1],[-173.75,24.64,1],[65.23,5.68,1],[103.36,-64.63,1],[-65.23,-5.68,1],[-103.36,64.63,1],[-114.77,5.68,1],[-76.64,-64.63,1],[114.77,-5.68,1],[-6.25,-24.64,1],[173.75,-24.64,1],[51.41,-63.45,1],[-68.67,16.19,1],[-128.59,-63.45,1],[162.69,20.45,1],[-111.33,-16.19,1],[-162.69,-20.45,1],[111.33,16.19,1],[-17.31,20.45,1],[68.67,-16.19,1],[17.31,-20.45,1],[-51.41,63.45,1],[128.59,63.45,1],[-50.6,28.85,1],[144.51,33.77,1],[129.4,28.85,1],[49.04,-42.6,1],[35.49,-33.77,1],[-49.04,42.6,1],[-35.49,33.77,1],[-130.96,-42.6,1],[-144.51,-33.77,1],[130.96,42.6,1],[50.6,-28.85,1],[-129.4,-28.85,1]]],r=t[e-1];
return r}Object.defineProperty(r,"__esModule",{value:!0}),r.deg2rad=n,r.getAmbiBinauralDecMtx=a,r.getTdesign=i;var o=e("numeric"),s=e("spherical-harmonic-transform"),u=e("convex-hull"),c=function(e,t,r,n){function a(e){return Math.min.apply(null,e)}for(var i=e.length,u=n,c=t.length,l=new Array(i),f=s.convertSph2Cart(e),h=0;h<i;h++){var m=f[h],d=new Array(u);d.fill(0);for(var p=0;p<c;p++){var v=[],g=[r[p][0],r[p][1],r[p][2]];if(v[0]=o.dotVV(g,m),g=[r[p][3],r[p][4],r[p][5]],v[1]=o.dotVV(g,m),g=[r[p][6],r[p][7],r[p][8]],v[2]=o.dotVV(g,m),a(v)>-.001){for(var y=Math.sqrt(o.sum(o.pow(v,2))),M=o.div(v,y),b=0;b<3;b++)d[t[p][b]]=M[b];break}}var x=Math.sqrt(o.sum(o.pow(d,2))),S=o.div(d,x);l[h]=S}return l};t.exports.getAmbiBinauralDecMtx=a,t.exports.getTdesign=i,t.exports.deg2rad=n},{"convex-hull":38,numeric:63,"spherical-harmonic-transform":81}],16:[function(e,t,r){"use strict";function n(e,t){for(var r=new Array(t+1),n=0;n<e.length;++n)r[n]=e[n];for(var n=0;n<=e.length;++n){for(var a=e.length;a<=t;++a){for(var o=new Array(t),s=0;s<t;++s)o[s]=Math.pow(a+1-n,s);r[a]=o}var u=i.apply(void 0,r);if(u)return!0}return!1}function a(e){var t=e.length;if(0===t)return[];if(1===t)return[0];for(var r=e[0].length,a=[e[0]],i=[0],o=1;o<t;++o)if(a.push(e[o]),n(a,r)){if(i.push(o),i.length===r+1)return i}else a.pop();return i}t.exports=a;var i=e("robust-orientation")},{"robust-orientation":64}],17:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":20}],18:[function(e,t,r){"use strict";r.__esModule=!0,r.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var a=e("../core-js/object/define-property"),i=n(a);r.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},{"../core-js/object/define-property":17}],20:[function(e,t,r){e("../../modules/es6.object.define-property");var n=e("../../modules/_core").Object;t.exports=function(e,t,r){return n.defineProperty(e,t,r)}},{"../../modules/_core":23,"../../modules/es6.object.define-property":36}],21:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],22:[function(e,t,r){var n=e("./_is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":32}],23:[function(e,t,r){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},{}],24:[function(e,t,r){var n=e("./_a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,a){return e.call(t,r,n,a)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":21}],25:[function(e,t,r){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":28}],26:[function(e,t,r){var n=e("./_is-object"),a=e("./_global").document,i=n(a)&&n(a.createElement);t.exports=function(e){return i?a.createElement(e):{}}},{"./_global":29,"./_is-object":32}],27:[function(e,t,r){var n=e("./_global"),a=e("./_core"),i=e("./_ctx"),o=e("./_hide"),s="prototype",u=function(e,t,r){var c,l,f,h=e&u.F,m=e&u.G,d=e&u.S,p=e&u.P,v=e&u.B,g=e&u.W,y=m?a:a[t]||(a[t]={}),M=y[s],b=m?n:d?n[t]:(n[t]||{})[s];m&&(r=t);for(c in r)l=!h&&b&&void 0!==b[c],l&&c in y||(f=l?b[c]:r[c],y[c]=m&&"function"!=typeof b[c]?r[c]:v&&l?i(f,n):g&&b[c]==f?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[s]=e[s],t}(f):p&&"function"==typeof f?i(Function.call,f):f,p&&((y.virtual||(y.virtual={}))[c]=f,e&u.R&&M&&!M[c]&&o(M,c,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},{"./_core":23,"./_ctx":24,"./_global":29,"./_hide":30}],28:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],29:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],30:[function(e,t,r){var n=e("./_object-dp"),a=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return n.f(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":25,"./_object-dp":33,"./_property-desc":34}],31:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":25,"./_dom-create":26,"./_fails":28}],32:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],33:[function(e,t,r){var n=e("./_an-object"),a=e("./_ie8-dom-define"),i=e("./_to-primitive"),o=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),a)try{return o(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":22,"./_descriptors":25,"./_ie8-dom-define":31,"./_to-primitive":35}],34:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],35:[function(e,t,r){var n=e("./_is-object");t.exports=function(e,t){if(!n(e))return e;var r,a;if(t&&"function"==typeof(r=e.toString)&&!n(a=r.call(e)))return a;if("function"==typeof(r=e.valueOf)&&!n(a=r.call(e)))return a;if(!t&&"function"==typeof(r=e.toString)&&!n(a=r.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":32}],36:[function(e,t,r){var n=e("./_export");n(n.S+n.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":25,"./_export":27,"./_object-dp":33}],37:[function(e,t,r){"use strict";"use restrict";function n(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var a=32;r.INT_BITS=a,r.INT_MAX=2147483647,r.INT_MIN=-1<<a-1,r.sign=function(e){return(e>0)-(e<0)},r.abs=function(e){var t=e>>a-1;return(e^t)-t},r.min=function(e,t){return t^(e^t)&-(e<t)},r.max=function(e,t){return e^(e^t)&-(e<t)},r.isPow2=function(e){return!(e&e-1||!e)},r.log2=function(e){var t,r;return t=(e>65535)<<4,e>>>=t,r=(e>255)<<3,e>>>=r,t|=r,r=(e>15)<<2,e>>>=r,t|=r,r=(e>3)<<1,e>>>=r,t|=r,t|e>>1},r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},r.popCount=function(e){return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},r.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},r.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var r=t,n=t,a=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--a;e[t]=n<<a&255}}(i),r.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},r.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},r.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},r.interleave3=function(e,t,r){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),e|r<<2},r.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},{}],38:[function(e,t,r){"use strict";function n(e){var t=e.length;if(0===t)return[];if(1===t)return[[0]];var r=e[0].length;return 0===r?[]:1===r?a(e):2===r?i(e):o(e,r)}var a=e("./lib/ch1d"),i=e("./lib/ch2d"),o=e("./lib/chnd");t.exports=n},{"./lib/ch1d":39,"./lib/ch2d":40,"./lib/chnd":41}],39:[function(e,t,r){"use strict";function n(e){for(var t=0,r=0,n=1;n<e.length;++n)e[n][0]<e[t][0]&&(t=n),e[n][0]>e[r][0]&&(r=n);return t<r?[[t],[r]]:t>r?[[r],[t]]:[[t]]}t.exports=n},{}],40:[function(e,t,r){"use strict";function n(e){var t=a(e),r=t.length;if(r<=2)return[];for(var n=new Array(r),i=t[r-1],o=0;o<r;++o){var s=t[o];n[o]=[i,s],i=s}return n}t.exports=n;var a=e("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":62}],41:[function(e,t,r){"use strict";function n(e,t){for(var r=e.length,n=new Array(r),a=0;a<t.length;++a)n[a]=e[t[a]];for(var i=t.length,a=0;a<r;++a)t.indexOf(a)<0&&(n[i++]=e[a]);return n}function a(e,t){for(var r=e.length,n=t.length,a=0;a<r;++a)for(var i=e[a],o=0;o<i.length;++o){var s=i[o];if(s<n)i[o]=t[s];else{s-=n;for(var u=0;u<n;++u)s>=t[u]&&(s+=1);i[o]=s}}return e}function i(e,t){try{return o(e,!0)}catch(c){var r=s(e);if(r.length<=t)return[];var i=n(e,r),u=o(i,!0);return a(u,r)}}t.exports=i;var o=e("incremental-convex-hull"),s=e("affine-hull")},{"affine-hull":16,"incremental-convex-hull":60}],42:[function(e,t,r){var n=e("../../modules/$");t.exports=function(e,t,r){return n.setDesc(e,t,r)}},{"../../modules/$":43}],43:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],44:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class").default,a=e("babel-runtime/helpers/class-call-check").default;Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(t,r){a(this,e),this.delayTime=0,this.posRead=0,this.posWrite=0,this.fracXi1=0,this.fracYi1=0,this.intDelay=0,this.fracDelay=0,this.a1=void 0,this.sampleRate=t,this.maxDelayTime=r||1,this.bufferSize=this.maxDelayTime*this.sampleRate,this.bufferSize%1!==0&&(this.bufferSize=parseInt(this.bufferSize)+1),this.buffer=new Float32Array(this.bufferSize)}return n(e,[{key:"setDelay",value:function(e){if(!(e<this.maxDelayTime))throw new Error("delayTime > maxDelayTime");this.delayTime=e;var t=e*this.sampleRate;this.intDelay=parseInt(t),this.fracDelay=t-this.intDelay,this.resample(),0!==this.fracDelay&&this.updateThiranCoefficient()}},{key:"getDelay",value:function(){return this.delayTime}},{key:"process",value:function(e){for(var t=new Float32Array(e.length),r=0;r<e.length;r+=1)this.buffer[this.posWrite]=e[r],t[r]=this.buffer[this.posRead],this.updatePointers();return 0===this.fracDelay?t:t=new Float32Array(this.fractionalThiranProcess(t))}},{key:"updatePointers",value:function(){this.posWrite===this.buffer.length-1?this.posWrite=0:this.posWrite=this.posWrite+1,this.posRead===this.buffer.length-1?this.posRead=0:this.posRead=this.posRead+1}},{key:"updateThiranCoefficient",value:function(){this.a1=(1-this.fracDelay)/(1+this.fracDelay)}},{key:"resample",value:function(){if(this.posWrite-this.intDelay<0){var e=this.intDelay-this.posWrite;this.posRead=this.buffer.length-e}else this.posRead=this.posWrite-this.intDelay}},{key:"fractionalThiranProcess",value:function(e){for(var t,r,n=new Float32Array(e.length),a=this.fracXi1,i=this.fracYi1,o=0;o<e.length;o+=1)t=e[o],r=this.a1*t+a-this.a1*i,a=t,i=r,n[o]=r;return this.fracXi1=a,this.fracYi1=i,n}}]),e}();r.default=i,t.exports=r.default},{"babel-runtime/helpers/class-call-check":47,"babel-runtime/helpers/create-class":48}],45:[function(e,t,r){t.exports=e("./dist/fractional-delay")},{"./dist/fractional-delay":44}],46:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"core-js/library/fn/object/define-property":42,dup:17}],47:[function(e,t,r){"use strict";r.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r.__esModule=!0},{}],48:[function(e,t,r){"use strict";var n=e("babel-runtime/core-js/object/define-property").default;r.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(e,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),r.__esModule=!0},{"babel-runtime/core-js/object/define-property":46}],49:[function(e,t,r){(function(e){"use strict";if(e.AnalyserNode&&!e.AnalyserNode.prototype.getFloatTimeDomainData){var t=new Uint8Array(2048);e.AnalyserNode.prototype.getFloatTimeDomainData=function(e){this.getByteTimeDomainData(t);for(var r=0,n=e.length;r<n;r++)e[r]=.0078125*(t[r]-128)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(e,t,r){r.glMatrix=e("./gl-matrix/common.js"),r.mat2=e("./gl-matrix/mat2.js"),r.mat2d=e("./gl-matrix/mat2d.js"),r.mat3=e("./gl-matrix/mat3.js"),r.mat4=e("./gl-matrix/mat4.js"),r.quat=e("./gl-matrix/quat.js"),r.vec2=e("./gl-matrix/vec2.js"),r.vec3=e("./gl-matrix/vec3.js"),r.vec4=e("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":51,"./gl-matrix/mat2.js":52,"./gl-matrix/mat2d.js":53,"./gl-matrix/mat3.js":54,"./gl-matrix/mat4.js":55,"./gl-matrix/quat.js":56,"./gl-matrix/vec2.js":57,"./gl-matrix/vec3.js":58,"./gl-matrix/vec4.js":59}],51:[function(e,t,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(e){n.ARRAY_TYPE=e};var a=Math.PI/180;n.toRadian=function(e){return e*a},n.equals=function(e,t){return Math.abs(e-t)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},t.exports=n},{}],52:[function(e,t,r){var n=e("./common.js"),a={};a.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.clone=function(e){var t=new n.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.fromValues=function(e,t,r,a){var i=new n.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=a,i},a.set=function(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e},a.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},a.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*i-a*n;return o?(o=1/o,e[0]=i*o,e[1]=-n*o,e[2]=-a*o,e[3]=r*o,e):null},a.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},a.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},a.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*s+i*u,e[1]=a*s+o*u,e[2]=n*c+i*l,e[3]=a*c+o*l,e},a.mul=a.multiply,a.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=a*u+o*s,e[2]=n*-s+i*u,e[3]=a*-s+o*u,e},a.scale=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],u=r[1];return e[0]=n*s,e[1]=a*s,e[2]=i*u,e[3]=o*u,e},a.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},a.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},a.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},a.sub=a.subtract,a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equals=function(e,t){var r=e[0],a=e[1],i=e[2],o=e[3],s=t[0],u=t[1],c=t[2],l=t[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},a.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},a.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.exports=a},{"./common.js":51}],53:[function(e,t,r){var n=e("./common.js"),a={};a.create=function(){var e=new n.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},a.fromValues=function(e,t,r,a,i,o){var s=new n.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=a,s[4]=i,s[5]=o,s},a.set=function(e,t,r,n,a,i,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=i,e[5]=o,e},a.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=r*i-n*a;return u?(u=1/u,e[0]=i*u,e[1]=-n*u,e[2]=-a*u,e[3]=r*u,e[4]=(a*s-i*o)*u,e[5]=(n*o-r*s)*u,e):null},a.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},a.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=r[0],l=r[1],f=r[2],h=r[3],m=r[4],d=r[5];return e[0]=n*c+i*l,e[1]=a*c+o*l,e[2]=n*f+i*h,e[3]=a*f+o*h,e[4]=n*m+i*d+s,e[5]=a*m+o*d+u,e},a.mul=a.multiply,a.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*c,e[1]=a*l+o*c,e[2]=n*-c+i*l,e[3]=a*-c+o*l,e[4]=s,e[5]=u,e},a.scale=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=r[0],l=r[1];return e[0]=n*c,e[1]=a*c,e[2]=i*l,e[3]=o*l,e[4]=s,e[5]=u,e},a.translate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=r[0],l=r[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=n*c+i*l+s,e[5]=a*c+o*l+u,e},a.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},a.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},a.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e},a.sub=a.subtract,a.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},a.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},a.equals=function(e,t){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=t[0],l=t[1],f=t[2],h=t[3],m=t[4],d=t[5];return Math.abs(r-c)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-f)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-h)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-m)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-d)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))},t.exports=a},{"./common.js":51}],54:[function(e,t,r){var n=e("./common.js"),a={};a.create=function(){var e=new n.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},a.clone=function(e){var t=new n.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.fromValues=function(e,t,r,a,i,o,s,u,c){var l=new n.ARRAY_TYPE(9);return l[0]=e,l[1]=t,l[2]=r,l[3]=a,l[4]=i,l[5]=o,l[6]=s,l[7]=u,l[8]=c,l},a.set=function(e,t,r,n,a,i,o,s,u,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=i,e[5]=o,e[6]=s,e[7]=u,e[8]=c,e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],a=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=a}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},a.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=l*o-s*c,h=-l*i+s*u,m=c*i-o*u,d=r*f+n*h+a*m;return d?(d=1/d,e[0]=f*d,e[1]=(-l*n+a*c)*d,e[2]=(s*n-a*o)*d,e[3]=h*d,e[4]=(l*r-a*u)*d,e[5]=(-s*r+a*i)*d,e[6]=m*d,e[7]=(-c*r+n*u)*d,e[8]=(o*r-n*i)*d,e):null},a.adjoint=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=o*l-s*c,e[1]=a*c-n*l,e[2]=n*s-a*o,e[3]=s*u-i*l,e[4]=r*l-a*u,e[5]=a*i-r*s,e[6]=i*c-o*u,e[7]=n*u-r*c,e[8]=r*o-n*i,e},a.determinant=function(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*(c*i-o*u)+r*(-c*a+o*s)+n*(u*a-i*s)},a.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=r[0],m=r[1],d=r[2],p=r[3],v=r[4],g=r[5],y=r[6],M=r[7],b=r[8];return e[0]=h*n+m*o+d*c,e[1]=h*a+m*s+d*l,e[2]=h*i+m*u+d*f,e[3]=p*n+v*o+g*c,e[4]=p*a+v*s+g*l,e[5]=p*i+v*u+g*f,e[6]=y*n+M*o+b*c,e[7]=y*a+M*s+b*l,e[8]=y*i+M*u+b*f,e},a.mul=a.multiply,a.translate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=r[0],m=r[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e[6]=h*n+m*o+c,e[7]=h*a+m*s+l,e[8]=h*i+m*u+f,e},a.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=Math.sin(r),m=Math.cos(r);return e[0]=m*n+h*o,e[1]=m*a+h*s,e[2]=m*i+h*u,e[3]=m*o-h*n,e[4]=m*s-h*a,e[5]=m*u-h*i,e[6]=c,e[7]=l,e[8]=f,e},a.scale=function(e,t,r){var n=r[0],a=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},a.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},a.fromQuat=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r+r,s=n+n,u=a+a,c=r*o,l=n*o,f=n*s,h=a*o,m=a*s,d=a*u,p=i*o,v=i*s,g=i*u;return e[0]=1-f-d,e[3]=l-g,e[6]=h+v,e[1]=l+g,e[4]=1-c-d,e[7]=m-p,e[2]=h-v,e[5]=m+p,e[8]=1-c-f,e},a.normalFromMat4=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],m=t[11],d=t[12],p=t[13],v=t[14],g=t[15],y=r*s-n*o,M=r*u-a*o,b=r*c-i*o,x=n*u-a*s,S=n*c-i*s,w=a*c-i*u,D=l*p-f*d,I=l*v-h*d,F=l*g-m*d,_=f*v-h*p,A=f*g-m*p,P=h*g-m*v,j=y*P-M*A+b*_+x*F-S*I+w*D;return j?(j=1/j,e[0]=(s*P-u*A+c*_)*j,e[1]=(u*F-o*P-c*I)*j,e[2]=(o*A-s*F+c*D)*j,e[3]=(a*A-n*P-i*_)*j,e[4]=(r*P-a*F+i*I)*j,e[5]=(n*F-r*A-i*D)*j,e[6]=(p*w-v*S+g*x)*j,e[7]=(v*b-d*w-g*M)*j,e[8]=(d*S-p*b+g*y)*j,e):null},a.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e},a.sub=a.subtract,a.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},a.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},a.equals=function(e,t){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=t[0],m=t[1],d=t[2],p=t[3],v=t[4],g=t[5],y=e[6],M=t[7],b=t[8];return Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(a-m)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(i-d)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-v)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-g)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-y)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(l-M)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(f-b)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))},t.exports=a},{"./common.js":51}],55:[function(e,t,r){var n=e("./common.js"),a={scalar:{},SIMD:{}};a.create=function(){var e=new n.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.clone=function(e){var t=new n.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.fromValues=function(e,t,r,a,i,o,s,u,c,l,f,h,m,d,p,v){var g=new n.ARRAY_TYPE(16);return g[0]=e,g[1]=t,g[2]=r,g[3]=a,g[4]=i,g[5]=o,g[6]=s,g[7]=u,g[8]=c,g[9]=l,g[10]=f,g[11]=h,g[12]=m,g[13]=d,g[14]=p,g[15]=v,g},a.set=function(e,t,r,n,a,i,o,s,u,c,l,f,h,m,d,p,v){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=i,e[5]=o,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=f,e[11]=h,e[12]=m,e[13]=d,e[14]=p,e[15]=v,e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.scalar.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],a=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},a.SIMD.transpose=function(e,t){var r,n,a,i,o,s,u,c,l,f;return r=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),i=SIMD.Float32x4.load(t,12),o=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),u=SIMD.Float32x4.shuffle(o,s,0,2,4,6),c=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,0,u),SIMD.Float32x4.store(e,4,c),o=SIMD.Float32x4.shuffle(r,n,2,3,6,7),s=SIMD.Float32x4.shuffle(a,i,2,3,6,7),l=SIMD.Float32x4.shuffle(o,s,0,2,4,6),f=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,8,l),SIMD.Float32x4.store(e,12,f),e},a.transpose=n.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],m=t[11],d=t[12],p=t[13],v=t[14],g=t[15],y=r*s-n*o,M=r*u-a*o,b=r*c-i*o,x=n*u-a*s,S=n*c-i*s,w=a*c-i*u,D=l*p-f*d,I=l*v-h*d,F=l*g-m*d,_=f*v-h*p,A=f*g-m*p,P=h*g-m*v,j=y*P-M*A+b*_+x*F-S*I+w*D;return j?(j=1/j,e[0]=(s*P-u*A+c*_)*j,e[1]=(a*A-n*P-i*_)*j,e[2]=(p*w-v*S+g*x)*j,e[3]=(h*S-f*w-m*x)*j,e[4]=(u*F-o*P-c*I)*j,e[5]=(r*P-a*F+i*I)*j,e[6]=(v*b-d*w-g*M)*j,e[7]=(l*w-h*b+m*M)*j,e[8]=(o*A-s*F+c*D)*j,e[9]=(n*F-r*A-i*D)*j,e[10]=(d*S-p*b+g*y)*j,e[11]=(f*b-l*S-m*y)*j,e[12]=(s*I-o*_-u*D)*j,e[13]=(r*_-n*I+a*D)*j,e[14]=(p*M-d*x-v*y)*j,e[15]=(l*x-f*M+h*y)*j,e):null},a.SIMD.invert=function(e,t){var r,n,a,i,o,s,u,c,l,f,h=SIMD.Float32x4.load(t,0),m=SIMD.Float32x4.load(t,4),d=SIMD.Float32x4.load(t,8),p=SIMD.Float32x4.load(t,12);return o=SIMD.Float32x4.shuffle(h,m,0,1,4,5),n=SIMD.Float32x4.shuffle(d,p,0,1,4,5),r=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.shuffle(h,m,2,3,6,7),i=SIMD.Float32x4.shuffle(d,p,2,3,6,7),a=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.mul(a,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(n,o),u=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(n,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),s),l=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),c=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),o=SIMD.Float32x4.mul(r,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),c),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),c),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,o)),o=SIMD.Float32x4.mul(r,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),c),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),l),f=SIMD.Float32x4.mul(r,s),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),o=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(o,o))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(f,c)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(f,l)),e):null},a.invert=n.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],m=t[11],d=t[12],p=t[13],v=t[14],g=t[15];
return e[0]=s*(h*g-m*v)-f*(u*g-c*v)+p*(u*m-c*h),e[1]=-(n*(h*g-m*v)-f*(a*g-i*v)+p*(a*m-i*h)),e[2]=n*(u*g-c*v)-s*(a*g-i*v)+p*(a*c-i*u),e[3]=-(n*(u*m-c*h)-s*(a*m-i*h)+f*(a*c-i*u)),e[4]=-(o*(h*g-m*v)-l*(u*g-c*v)+d*(u*m-c*h)),e[5]=r*(h*g-m*v)-l*(a*g-i*v)+d*(a*m-i*h),e[6]=-(r*(u*g-c*v)-o*(a*g-i*v)+d*(a*c-i*u)),e[7]=r*(u*m-c*h)-o*(a*m-i*h)+l*(a*c-i*u),e[8]=o*(f*g-m*p)-l*(s*g-c*p)+d*(s*m-c*f),e[9]=-(r*(f*g-m*p)-l*(n*g-i*p)+d*(n*m-i*f)),e[10]=r*(s*g-c*p)-o*(n*g-i*p)+d*(n*c-i*s),e[11]=-(r*(s*m-c*f)-o*(n*m-i*f)+l*(n*c-i*s)),e[12]=-(o*(f*v-h*p)-l*(s*v-u*p)+d*(s*h-u*f)),e[13]=r*(f*v-h*p)-l*(n*v-a*p)+d*(n*h-a*f),e[14]=-(r*(s*v-u*p)-o*(n*v-a*p)+d*(n*u-a*s)),e[15]=r*(s*h-u*f)-o*(n*h-a*f)+l*(n*u-a*s),e},a.SIMD.adjoint=function(e,t){var r,n,a,i,o,s,u,c,l,f,h,m,d,r=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),i=SIMD.Float32x4.load(t,12);return l=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),o=SIMD.Float32x4.shuffle(l,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,l,1,3,5,7),l=SIMD.Float32x4.shuffle(r,n,2,3,6,7),c=SIMD.Float32x4.shuffle(a,i,2,3,6,7),u=SIMD.Float32x4.shuffle(l,c,0,2,4,6),c=SIMD.Float32x4.shuffle(c,l,1,3,5,7),l=SIMD.Float32x4.mul(u,c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.mul(s,l),h=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,l),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.mul(s,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),f),d=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,l)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),f),m=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,l)),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),l=SIMD.Float32x4.mul(o,s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),m),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,l),d),l=SIMD.Float32x4.swizzle(l,2,3,0,1),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,l),m),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,l)),l=SIMD.Float32x4.mul(o,c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,l)),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),m),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),h),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.mul(o,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(c,l)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),d),SIMD.Float32x4.store(e,0,f),SIMD.Float32x4.store(e,4,h),SIMD.Float32x4.store(e,8,m),SIMD.Float32x4.store(e,12,d),e},a.adjoint=n.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],m=e[12],d=e[13],p=e[14],v=e[15],g=t*o-r*i,y=t*s-n*i,M=t*u-a*i,b=r*s-n*o,x=r*u-a*o,S=n*u-a*s,w=c*d-l*m,D=c*p-f*m,I=c*v-h*m,F=l*p-f*d,_=l*v-h*d,A=f*v-h*p;return g*A-y*_+M*F+b*I-x*D+S*w},a.SIMD.multiply=function(e,t,r){var n=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4),i=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.load(r,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(e,0,u);var c=SIMD.Float32x4.load(r,4),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),o))));SIMD.Float32x4.store(e,4,l);var f=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),o))));SIMD.Float32x4.store(e,8,h);var m=SIMD.Float32x4.load(r,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,3,3,3,3),o))));return SIMD.Float32x4.store(e,12,d),e},a.scalar.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],m=t[10],d=t[11],p=t[12],v=t[13],g=t[14],y=t[15],M=r[0],b=r[1],x=r[2],S=r[3];return e[0]=M*n+b*s+x*f+S*p,e[1]=M*a+b*u+x*h+S*v,e[2]=M*i+b*c+x*m+S*g,e[3]=M*o+b*l+x*d+S*y,M=r[4],b=r[5],x=r[6],S=r[7],e[4]=M*n+b*s+x*f+S*p,e[5]=M*a+b*u+x*h+S*v,e[6]=M*i+b*c+x*m+S*g,e[7]=M*o+b*l+x*d+S*y,M=r[8],b=r[9],x=r[10],S=r[11],e[8]=M*n+b*s+x*f+S*p,e[9]=M*a+b*u+x*h+S*v,e[10]=M*i+b*c+x*m+S*g,e[11]=M*o+b*l+x*d+S*y,M=r[12],b=r[13],x=r[14],S=r[15],e[12]=M*n+b*s+x*f+S*p,e[13]=M*a+b*u+x*h+S*v,e[14]=M*i+b*c+x*m+S*g,e[15]=M*o+b*l+x*d+S*y,e},a.multiply=n.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(e,t,r){var n,a,i,o,s,u,c,l,f,h,m,d,p=r[0],v=r[1],g=r[2];return t===e?(e[12]=t[0]*p+t[4]*v+t[8]*g+t[12],e[13]=t[1]*p+t[5]*v+t[9]*g+t[13],e[14]=t[2]*p+t[6]*v+t[10]*g+t[14],e[15]=t[3]*p+t[7]*v+t[11]*g+t[15]):(n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],m=t[10],d=t[11],e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=h,e[10]=m,e[11]=d,e[12]=n*p+s*v+f*g+t[12],e[13]=a*p+u*v+h*g+t[13],e[14]=i*p+c*v+m*g+t[14],e[15]=o*p+l*v+d*g+t[15]),e},a.SIMD.translate=function(e,t,r){var n=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4),i=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,SIMD.Float32x4.add(i,o)));return SIMD.Float32x4.store(e,12,u),e},a.translate=n.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(e,t,r){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.SIMD.scale=function(e,t,r){var n,a,i,o=SIMD.Float32x4(r[0],r[1],r[2],0);return n=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,0,0,0,0))),a=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,1,1,1,1))),i=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale=n.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(e,t,r,a){var i,o,s,u,c,l,f,h,m,d,p,v,g,y,M,b,x,S,w,D,I,F,_,A,P=a[0],j=a[1],C=a[2],T=Math.sqrt(P*P+j*j+C*C);return Math.abs(T)<n.EPSILON?null:(T=1/T,P*=T,j*=T,C*=T,i=Math.sin(r),o=Math.cos(r),s=1-o,u=t[0],c=t[1],l=t[2],f=t[3],h=t[4],m=t[5],d=t[6],p=t[7],v=t[8],g=t[9],y=t[10],M=t[11],b=P*P*s+o,x=j*P*s+C*i,S=C*P*s-j*i,w=P*j*s-C*i,D=j*j*s+o,I=C*j*s+P*i,F=P*C*s+j*i,_=j*C*s-P*i,A=C*C*s+o,e[0]=u*b+h*x+v*S,e[1]=c*b+m*x+g*S,e[2]=l*b+d*x+y*S,e[3]=f*b+p*x+M*S,e[4]=u*w+h*D+v*I,e[5]=c*w+m*D+g*I,e[6]=l*w+d*D+y*I,e[7]=f*w+p*D+M*I,e[8]=u*F+h*_+v*A,e[9]=c*F+m*_+g*A,e[10]=l*F+d*_+y*A,e[11]=f*F+p*_+M*A,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},a.scalar.rotateX=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+c*n,e[5]=o*a+l*n,e[6]=s*a+f*n,e[7]=u*a+h*n,e[8]=c*a-i*n,e[9]=l*a-o*n,e[10]=f*a-s*n,e[11]=h*a-u*n,e},a.SIMD.rotateX=function(e,t,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var i=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),e},a.rotateX=n.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a-c*n,e[1]=o*a-l*n,e[2]=s*a-f*n,e[3]=u*a-h*n,e[8]=i*n+c*a,e[9]=o*n+l*a,e[10]=s*n+f*a,e[11]=u*n+h*a,e},a.SIMD.rotateY=function(e,t,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var i=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a))),e},a.rotateY=n.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+c*n,e[1]=o*a+l*n,e[2]=s*a+f*n,e[3]=u*a+h*n,e[4]=c*a-i*n,e[5]=l*a-o*n,e[6]=f*a-s*n,e[7]=h*a-u*n,e},a.SIMD.rotateZ=function(e,t,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var i=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),e},a.rotateZ=n.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},a.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromRotation=function(e,t,r){var a,i,o,s=r[0],u=r[1],c=r[2],l=Math.sqrt(s*s+u*u+c*c);return Math.abs(l)<n.EPSILON?null:(l=1/l,s*=l,u*=l,c*=l,a=Math.sin(t),i=Math.cos(t),o=1-i,e[0]=s*s*o+i,e[1]=u*s*o+c*a,e[2]=c*s*o-u*a,e[3]=0,e[4]=s*u*o-c*a,e[5]=u*u*o+i,e[6]=c*u*o+s*a,e[7]=0,e[8]=s*c*o+u*a,e[9]=u*c*o-s*a,e[10]=c*c*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},a.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.fromRotationTranslation=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=n+n,u=a+a,c=i+i,l=n*s,f=n*u,h=n*c,m=a*u,d=a*c,p=i*c,v=o*s,g=o*u,y=o*c;return e[0]=1-(m+p),e[1]=f+y,e[2]=h-g,e[3]=0,e[4]=f-y,e[5]=1-(l+p),e[6]=d+v,e[7]=0,e[8]=h+g,e[9]=d-v,e[10]=1-(l+m),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},a.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},a.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},a.fromRotationTranslationScale=function(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3],u=a+a,c=i+i,l=o+o,f=a*u,h=a*c,m=a*l,d=i*c,p=i*l,v=o*l,g=s*u,y=s*c,M=s*l,b=n[0],x=n[1],S=n[2];return e[0]=(1-(d+v))*b,e[1]=(h+M)*b,e[2]=(m-y)*b,e[3]=0,e[4]=(h-M)*x,e[5]=(1-(f+v))*x,e[6]=(p+g)*x,e[7]=0,e[8]=(m+y)*S,e[9]=(p-g)*S,e[10]=(1-(f+d))*S,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},a.fromRotationTranslationScaleOrigin=function(e,t,r,n,a){var i=t[0],o=t[1],s=t[2],u=t[3],c=i+i,l=o+o,f=s+s,h=i*c,m=i*l,d=i*f,p=o*l,v=o*f,g=s*f,y=u*c,M=u*l,b=u*f,x=n[0],S=n[1],w=n[2],D=a[0],I=a[1],F=a[2];return e[0]=(1-(p+g))*x,e[1]=(m+b)*x,e[2]=(d-M)*x,e[3]=0,e[4]=(m-b)*S,e[5]=(1-(h+g))*S,e[6]=(v+y)*S,e[7]=0,e[8]=(d+M)*w,e[9]=(v-y)*w,e[10]=(1-(h+p))*w,e[11]=0,e[12]=r[0]+D-(e[0]*D+e[4]*I+e[8]*F),e[13]=r[1]+I-(e[1]*D+e[5]*I+e[9]*F),e[14]=r[2]+F-(e[2]*D+e[6]*I+e[10]*F),e[15]=1,e},a.fromQuat=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r+r,s=n+n,u=a+a,c=r*o,l=n*o,f=n*s,h=a*o,m=a*s,d=a*u,p=i*o,v=i*s,g=i*u;return e[0]=1-f-d,e[1]=l+g,e[2]=h-v,e[3]=0,e[4]=l-g,e[5]=1-c-d,e[6]=m+p,e[7]=0,e[8]=h+v,e[9]=m-p,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},a.frustum=function(e,t,r,n,a,i,o){var s=1/(r-t),u=1/(a-n),c=1/(i-o);return e[0]=2*i*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(a+n)*u,e[10]=(o+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*c,e[15]=0,e},a.perspective=function(e,t,r,n,a){var i=1/Math.tan(t/2),o=1/(n-a);return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(a+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*a*n*o,e[15]=0,e},a.perspectiveFromFieldOfView=function(e,t,r,n){var a=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(a+i);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((o-s)*u*.5),e[9]=(a-i)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},a.ortho=function(e,t,r,n,a,i,o){var s=1/(t-r),u=1/(n-a),c=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(a+n)*u,e[14]=(o+i)*c,e[15]=1,e},a.lookAt=function(e,t,r,i){var o,s,u,c,l,f,h,m,d,p,v=t[0],g=t[1],y=t[2],M=i[0],b=i[1],x=i[2],S=r[0],w=r[1],D=r[2];return Math.abs(v-S)<n.EPSILON&&Math.abs(g-w)<n.EPSILON&&Math.abs(y-D)<n.EPSILON?a.identity(e):(h=v-S,m=g-w,d=y-D,p=1/Math.sqrt(h*h+m*m+d*d),h*=p,m*=p,d*=p,o=b*d-x*m,s=x*h-M*d,u=M*m-b*h,p=Math.sqrt(o*o+s*s+u*u),p?(p=1/p,o*=p,s*=p,u*=p):(o=0,s=0,u=0),c=m*u-d*s,l=d*o-h*u,f=h*s-m*o,p=Math.sqrt(c*c+l*l+f*f),p?(p=1/p,c*=p,l*=p,f*=p):(c=0,l=0,f=0),e[0]=o,e[1]=c,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=m,e[7]=0,e[8]=u,e[9]=f,e[10]=d,e[11]=0,e[12]=-(o*v+s*g+u*y),e[13]=-(c*v+l*g+f*y),e[14]=-(h*v+m*g+d*y),e[15]=1,e)},a.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},a.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e},a.sub=a.subtract,a.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},a.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},a.equals=function(e,t){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],m=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],M=t[0],b=t[1],x=t[2],S=t[3],w=t[4],D=t[5],I=t[6],F=t[7],_=t[8],A=t[9],P=t[10],j=t[11],C=t[12],T=t[13],k=t[14],R=t[15];return Math.abs(r-M)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(a-b)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(i-x)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-S)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-w)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(u-D)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-I)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(l-F)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(f-_)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(h-A)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(m-P)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(d-j)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(j))&&Math.abs(p-C)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(v-T)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(g-k)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-R)<=n.EPSILON*Math.max(1,Math.abs(y),Math.abs(R))},t.exports=a},{"./common.js":51}],56:[function(e,t,r){var n=e("./common.js"),a=e("./mat3.js"),i=e("./vec3.js"),o=e("./vec4.js"),s={};s.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.rotationTo=function(){var e=i.create(),t=i.fromValues(1,0,0),r=i.fromValues(0,1,0);return function(n,a,o){var u=i.dot(a,o);return u<-.999999?(i.cross(e,t,a),i.length(e)<1e-6&&i.cross(e,r,a),i.normalize(e,e),s.setAxisAngle(n,e,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(i.cross(e,a,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+u,s.normalize(n,n))}}(),s.setAxes=function(){var e=a.create();return function(t,r,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],s.normalize(t,s.fromMat3(t,e))}}(),s.clone=o.clone,s.fromValues=o.fromValues,s.copy=o.copy,s.set=o.set,s.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.setAxisAngle=function(e,t,r){r=.5*r;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e},s.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},s.add=o.add,s.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*l+o*s+a*c-i*u,e[1]=a*l+o*u+i*s-n*c,e[2]=i*l+o*c+n*u-a*s,e[3]=o*l-n*s-a*u-i*c,e},s.mul=s.multiply,s.scale=o.scale,s.rotateX=function(e,t,r){r*=.5;var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=a*u+i*s,e[2]=i*u-a*s,e[3]=o*u-n*s,e},s.rotateY=function(e,t,r){r*=.5;var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-i*s,e[1]=a*u+o*s,e[2]=i*u+n*s,e[3]=o*u-a*s,e},s.rotateZ=function(e,t,r){r*=.5;var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*s,e[1]=a*u-n*s,e[2]=i*u+o*s,e[3]=o*u-i*s,e},s.calculateW=function(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=r,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),e},s.dot=o.dot,s.lerp=o.lerp,s.slerp=function(e,t,r,n){var a,i,o,s,u,c=t[0],l=t[1],f=t[2],h=t[3],m=r[0],d=r[1],p=r[2],v=r[3];return i=c*m+l*d+f*p+h*v,i<0&&(i=-i,m=-m,d=-d,p=-p,v=-v),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-n)*a)/o,u=Math.sin(n*a)/o):(s=1-n,u=n),e[0]=s*c+u*m,e[1]=s*l+u*d,e[2]=s*f+u*p,e[3]=s*h+u*v,e},s.sqlerp=function(){var e=s.create(),t=s.create();return function(r,n,a,i,o,u){return s.slerp(e,n,o,u),s.slerp(t,a,i,u),s.slerp(r,e,t,2*u*(1-u)),r}}(),s.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*r+n*n+a*a+i*i,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-a*s,e[3]=i*s,e},s.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},s.length=o.length,s.len=s.length,s.squaredLength=o.squaredLength,s.sqrLen=s.squaredLength,s.normalize=o.normalize,s.fromMat3=function(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;r=Math.sqrt(t[3*a+a]-t[3*i+i]-t[3*o+o]+1),e[a]=.5*r,r=.5/r,e[3]=(t[3*i+o]-t[3*o+i])*r,e[i]=(t[3*i+a]+t[3*a+i])*r,e[o]=(t[3*o+a]+t[3*a+o])*r}return e},s.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},s.exactEquals=o.exactEquals,s.equals=o.equals,t.exports=s},{"./common.js":51,"./mat3.js":54,"./vec3.js":58,"./vec4.js":59}],57:[function(e,t,r){var n=e("./common.js"),a={};a.create=function(){var e=new n.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var r=new n.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,r){return e[0]=t,e[1]=r,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e},a.div=a.divide,a.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},a.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},a.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},a.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},a.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},a.normalize=function(e,t){var r=t[0],n=t[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},a.lerp=function(e,t,r,n){var a=t[0],i=t[1];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e},a.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},a.transformMat2=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a,e[1]=r[1]*n+r[3]*a,e},a.transformMat2d=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a+r[4],e[1]=r[1]*n+r[3]*a+r[5],e},a.transformMat3=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[3]*a+r[6],e[1]=r[1]*n+r[4]*a+r[7],e},a.transformMat4=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[4]*a+r[12],e[1]=r[1]*n+r[5]*a+r[13],e},a.forEach=function(){var e=a.create();return function(t,r,n,a,i,o){var s,u;for(r||(r=2),n||(n=0),u=a?Math.min(a*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],i(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}(),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},a.equals=function(e,t){var r=e[0],a=e[1],i=t[0],o=t[1];return Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-o)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))},t.exports=a},{"./common.js":51}],58:[function(e,t,r){var n=e("./common.js"),a={};a.create=function(){var e=new n.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.fromValues=function(e,t,r){var a=new n.ARRAY_TYPE(3);return a[0]=e,a[1]=t,a[2]=r,a},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},a.div=a.divide,a.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},a.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},a.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},a.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},a.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(r*r+n*n+a*a)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},a.normalize=function(e,t){var r=t[0],n=t[1],a=t[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.cross=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],u=r[2];return e[0]=a*u-i*s,e[1]=i*o-n*u,e[2]=n*s-a*o,e},a.lerp=function(e,t,r,n){var a=t[0],i=t[1],o=t[2];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e},a.hermite=function(e,t,r,n,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,c=o*(i-1),l=o*(3-2*i);return e[0]=t[0]*s+r[0]*u+n[0]*c+a[0]*l,e[1]=t[1]*s+r[1]*u+n[1]*c+a[1]*l,e[2]=t[2]*s+r[2]*u+n[2]*c+a[2]*l,e},a.bezier=function(e,t,r,n,a,i){var o=1-i,s=o*o,u=i*i,c=s*o,l=3*i*s,f=3*u*o,h=u*i;return e[0]=t[0]*c+r[0]*l+n[0]*f+a[0]*h,e[1]=t[1]*c+r[1]*l+n[1]*f+a[1]*h,e[2]=t[2]*c+r[2]*l+n[2]*f+a[2]*h,e},a.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI,a=2*n.RANDOM()-1,i=Math.sqrt(1-a*a)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=a*t,e},a.transformMat4=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o,e[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o,e[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o,e},a.transformMat3=function(e,t,r){var n=t[0],a=t[1],i=t[2];return e[0]=n*r[0]+a*r[3]+i*r[6],e[1]=n*r[1]+a*r[4]+i*r[7],e[2]=n*r[2]+a*r[5]+i*r[8],e},a.transformQuat=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*i-u*a,f=c*a+u*n-o*i,h=c*i+o*a-s*n,m=-o*n-s*a-u*i;return e[0]=l*c+m*-o+f*-u-h*-s,e[1]=f*c+m*-s+h*-o-l*-u,e[2]=h*c+m*-u+l*-s-f*-o,e},a.rotateX=function(e,t,r,n){var a=[],i=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e},a.rotateY=function(e,t,r,n){var a=[],i=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e},a.rotateZ=function(e,t,r,n){var a=[],i=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e},a.forEach=function(){var e=a.create();return function(t,r,n,a,i,o){var s,u;for(r||(r=3),n||(n=0),u=a?Math.min(a*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],i(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),a.angle=function(e,t){var r=a.fromValues(e[0],e[1],e[2]),n=a.fromValues(t[0],t[1],t[2]);a.normalize(r,r),a.normalize(n,n);var i=a.dot(r,n);return i>1?0:Math.acos(i)},a.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},a.equals=function(e,t){var r=e[0],a=e[1],i=e[2],o=t[0],s=t[1],u=t[2];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-s)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-u)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))},t.exports=a},{"./common.js":51}],59:[function(e,t,r){var n=e("./common.js"),a={};a.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.fromValues=function(e,t,r,a){var i=new n.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=a,i},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.set=function(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e},a.div=a.divide,a.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},a.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},a.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),
e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},a.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},a.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(r*r+n*n+a*a+i*i)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return r*r+n*n+a*a+i*i},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1],n=e[2],a=e[3];return Math.sqrt(t*t+r*r+n*n+a*a)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},a.normalize=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=a*o,e[3]=i*o),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.lerp=function(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},a.random=function(e,t){return t=t||1,e[0]=n.RANDOM(),e[1]=n.RANDOM(),e[2]=n.RANDOM(),e[3]=n.RANDOM(),a.normalize(e,e),a.scale(e,e,t),e},a.transformMat4=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,e},a.transformQuat=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*i-u*a,f=c*a+u*n-o*i,h=c*i+o*a-s*n,m=-o*n-s*a-u*i;return e[0]=l*c+m*-o+f*-u-h*-s,e[1]=f*c+m*-s+h*-o-l*-u,e[2]=h*c+m*-u+l*-s-f*-o,e[3]=t[3],e},a.forEach=function(){var e=a.create();return function(t,r,n,a,i,o){var s,u;for(r||(r=4),n||(n=0),u=a?Math.min(a*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],i(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),a.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},a.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equals=function(e,t){var r=e[0],a=e[1],i=e[2],o=e[3],s=t[0],u=t[1],c=t[2],l=t[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=a},{"./common.js":51}],60:[function(e,t,r){"use strict";function n(e,t,r){this.vertices=e,this.adjacent=t,this.boundary=r,this.lastVisited=-1}function a(e,t,r){this.vertices=e,this.cell=t,this.index=r}function i(e,t){return l(e.vertices,t.vertices)}function o(e){for(var t=["function orient(){var tuple=this.tuple;return test("],r=0;r<=e;++r)r>0&&t.push(","),t.push("tuple[",r,"]");t.push(")}return orient");var n=new Function("test",t.join("")),a=c[e+1];return a||(a=c),n(a)}function s(e,t,r){this.dimension=e,this.vertices=t,this.simplices=r,this.interior=r.filter(function(e){return!e.boundary}),this.tuple=new Array(e+1);for(var n=0;n<=e;++n)this.tuple[n]=this.vertices[n];var a=f[e];a||(a=f[e]=o(e)),this.orient=a}function u(e,t){var r=e.length;if(0===r)throw new Error("Must have at least d+1 points");var a=e[0].length;if(r<=a)throw new Error("Must input at least d+1 points");var i=e.slice(0,a+1),o=c.apply(void 0,i);if(0===o)throw new Error("Input not in general position");for(var u=new Array(a+1),l=0;l<=a;++l)u[l]=l;o<0&&(u[0]=1,u[1]=0);for(var f=new n(u,new Array(a+1),(!1)),h=f.adjacent,m=new Array(a+2),l=0;l<=a;++l){for(var d=u.slice(),p=0;p<=a;++p)p===l&&(d[p]=-1);var v=d[0];d[0]=d[1],d[1]=v;var g=new n(d,new Array(a+1),(!0));h[l]=g,m[l]=g}m[a+1]=f;for(var l=0;l<=a;++l)for(var d=h[l].vertices,y=h[l].adjacent,p=0;p<=a;++p){var M=d[p];if(M<0)y[p]=f;else for(var b=0;b<=a;++b)h[b].vertices.indexOf(M)<0&&(y[p]=h[b])}for(var x=new s(a,i,m),S=!!t,l=a+1;l<r;++l)x.insert(e[l],S);return x.boundary()}t.exports=u;var c=e("robust-orientation"),l=e("simplicial-complex").compareCells;n.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=t};var f=[],h=s.prototype;h.handleBoundaryDegeneracy=function(e,t){var r=this.dimension,n=this.vertices.length-1,a=this.tuple,i=this.vertices,o=[e];for(e.lastVisited=-n;o.length>0;){e=o.pop();for(var s=(e.vertices,e.adjacent),u=0;u<=r;++u){var c=s[u];if(c.boundary&&!(c.lastVisited<=-n)){for(var l=c.vertices,f=0;f<=r;++f){var h=l[f];h<0?a[f]=t:a[f]=i[h]}var m=this.orient();if(m>0)return c;c.lastVisited=-n,0===m&&o.push(c)}}}return null},h.walk=function(e,t){var r=this.vertices.length-1,n=this.dimension,a=this.vertices,i=this.tuple,o=t?this.interior.length*Math.random()|0:this.interior.length-1,s=this.interior[o];e:for(;!s.boundary;){for(var u=s.vertices,c=s.adjacent,l=0;l<=n;++l)i[l]=a[u[l]];s.lastVisited=r;for(var l=0;l<=n;++l){var f=c[l];if(!(f.lastVisited>=r)){var h=i[l];i[l]=e;var m=this.orient();if(i[l]=h,m<0){s=f;continue e}f.boundary?f.lastVisited=-r:f.lastVisited=r}}return}return s},h.addPeaks=function(e,t){var r=this.vertices.length-1,o=this.dimension,s=this.vertices,u=this.tuple,c=this.interior,l=this.simplices,f=[t];t.lastVisited=r,t.vertices[t.vertices.indexOf(-1)]=r,t.boundary=!1,c.push(t);for(var h=[];f.length>0;){var t=f.pop(),m=t.vertices,d=t.adjacent,p=m.indexOf(r);if(!(p<0))for(var v=0;v<=o;++v)if(v!==p){var g=d[v];if(g.boundary&&!(g.lastVisited>=r)){var y=g.vertices;if(g.lastVisited!==-r){for(var M=0,b=0;b<=o;++b)y[b]<0?(M=b,u[b]=e):u[b]=s[y[b]];var x=this.orient();if(x>0){y[M]=r,g.boundary=!1,c.push(g),f.push(g),g.lastVisited=r;continue}g.lastVisited=-r}var S=g.adjacent,w=m.slice(),D=d.slice(),I=new n(w,D,(!0));l.push(I);var F=S.indexOf(t);if(!(F<0)){S[F]=I,D[p]=g,w[v]=-1,D[v]=t,d[v]=I,I.flip();for(var b=0;b<=o;++b){var _=w[b];if(!(_<0||_===r)){for(var A=new Array(o-1),P=0,j=0;j<=o;++j){var C=w[j];C<0||j===b||(A[P++]=C)}h.push(new a(A,I,b))}}}}}}h.sort(i);for(var v=0;v+1<h.length;v+=2){var T=h[v],k=h[v+1],R=T.index,E=k.index;R<0||E<0||(T.cell.adjacent[T.index]=k.cell,k.cell.adjacent[k.index]=T.cell)}},h.insert=function(e,t){var r=this.vertices;r.push(e);var n=this.walk(e,t);if(n){for(var a=this.dimension,i=this.tuple,o=0;o<=a;++o){var s=n.vertices[o];s<0?i[o]=e:i[o]=r[s]}var u=this.orient(i);u<0||(0!==u||(n=this.handleBoundaryDegeneracy(n,e)))&&this.addPeaks(e,n)}},h.boundary=function(){for(var e=this.dimension,t=[],r=this.simplices,n=r.length,a=0;a<n;++a){var i=r[a];if(i.boundary){for(var o=new Array(e),s=i.vertices,u=0,c=0,l=0;l<=e;++l)s[l]>=0?o[u++]=s[l]:c=1&l;if(c===(1&e)){var f=o[0];o[0]=o[1],o[1]=f}t.push(o)}}return t}},{"robust-orientation":64,"simplicial-complex":80}],61:[function(e,t,r){function n(e,t,r){this.obj=e,this.left=null,this.right=null,this.parent=r,this.dimension=t}function a(e,t,r){function a(e,t,i){var o,s,u=t%r.length;return 0===e.length?null:1===e.length?new n(e[0],u,i):(e.sort(function(e,t){return e[r[u]]-t[r[u]]}),o=Math.floor(e.length/2),s=new n(e[o],u,i),s.left=a(e.slice(0,o),t+1,s),s.right=a(e.slice(o+1),t+1,s),s)}var o=this;this.root=a(e,0,null),this.insert=function(e){function t(n,a){if(null===n)return a;var i=r[n.dimension];return e[i]<n.obj[i]?t(n.left,n):t(n.right,n)}var a,i,o=t(this.root,null);return null===o?void(this.root=new n(e,0,null)):(a=new n(e,(o.dimension+1)%r.length,o),i=r[o.dimension],void(e[i]<o.obj[i]?o.left=a:o.right=a))},this.remove=function(e){function t(n){if(null===n)return null;if(n.obj===e)return n;var a=r[n.dimension];return e[a]<n.obj[a]?t(n.left,n):t(n.right,n)}function n(e){function t(e,n){var a,i,o,s,u;return null===e?null:(a=r[n],e.dimension===n?null!==e.right?t(e.right,n):e:(i=e.obj[a],o=t(e.left,n),s=t(e.right,n),u=e,null!==o&&o.obj[a]>i&&(u=o),null!==s&&s.obj[a]>u.obj[a]&&(u=s),u))}function a(e,t){var n,i,o,s,u;return null===e?null:(n=r[t],e.dimension===t?null!==e.left?a(e.left,t):e:(i=e.obj[n],o=a(e.left,t),s=a(e.right,t),u=e,null!==o&&o.obj[n]<i&&(u=o),null!==s&&s.obj[n]<u.obj[n]&&(u=s),u))}var i,s,u;return null===e.left&&null===e.right?null===e.parent?void(o.root=null):(u=r[e.parent.dimension],void(e.obj[u]<e.parent.obj[u]?e.parent.left=null:e.parent.right=null)):(i=null!==e.left?t(e.left,e.dimension):a(e.right,e.dimension),s=i.obj,n(i),void(e.obj=s))}var a;a=t(o.root),null!==a&&n(a)},this.nearest=function(e,n,a){function s(a){function i(e,t){l.push([e,t]),l.size()>n&&l.pop()}if(!o.root)return[];var u,c,f,h,m=r[a.dimension],d=t(e,a.obj),p={};for(h=0;h<r.length;h+=1)h===a.dimension?p[r[h]]=e[r[h]]:p[r[h]]=a.obj[r[h]];return c=t(p,a.obj),null===a.right&&null===a.left?void((l.size()<n||d<l.peek()[1])&&i(a,d)):(u=null===a.right?a.left:null===a.left?a.right:e[m]<a.obj[m]?a.left:a.right,s(u),(l.size()<n||d<l.peek()[1])&&i(a,d),void((l.size()<n||Math.abs(c)<l.peek()[1])&&(f=u===a.left?a.right:a.left,null!==f&&s(f))))}var u,c,l;if(l=new i(function(e){return-e[1]}),a)for(u=0;u<n;u+=1)l.push([null,a]);for(s(o.root),c=[],u=0;u<n&&u<l.content.length;u+=1)l.content[u][0]&&c.push([l.content[u][0].obj,l.content[u][1]]);return c},this.balanceFactor=function(){function e(t){return null===t?0:Math.max(e(t.left),e(t.right))+1}function t(e){return null===e?0:t(e.left)+t(e.right)+1}return e(o.root)/(Math.log(t(o.root))/Math.log(2))}}function i(e){this.content=[],this.scoreFunction=e}i.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var t=this.content.length,r=0;r<t;r++)if(this.content[r]==e){var n=this.content.pop();return void(r!=t-1&&(this.content[r]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.bubbleUp(r):this.sinkDown(r)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];e>0;){var r=Math.floor((e+1)/2)-1,n=this.content[r];if(!(this.scoreFunction(t)<this.scoreFunction(n)))break;this.content[r]=t,this.content[e]=n,e=r}},sinkDown:function(e){for(var t=this.content.length,r=this.content[e],n=this.scoreFunction(r);;){var a=2*(e+1),i=a-1,o=null;if(i<t){var s=this.content[i],u=this.scoreFunction(s);u<n&&(o=i)}if(a<t){var c=this.content[a],l=this.scoreFunction(c);l<(null==o?n:u)&&(o=a)}if(null==o)break;this.content[e]=this.content[o],this.content[o]=r,e=o}}},t.exports={createKdTree:function(e,t,r){return new a(e,t,r)}}},{}],62:[function(e,t,r){"use strict";function n(e){var t=e.length;if(t<3){for(var r=new Array(t),n=0;n<t;++n)r[n]=n;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:r}for(var i=new Array(t),n=0;n<t;++n)i[n]=n;i.sort(function(t,r){var n=e[t][0]-e[r][0];return n?n:e[t][1]-e[r][1]});for(var o=[i[0],i[1]],s=[i[0],i[1]],n=2;n<t;++n){for(var u=i[n],c=e[u],l=o.length;l>1&&a(e[o[l-2]],e[o[l-1]],c)<=0;)l-=1,o.pop();for(o.push(u),l=s.length;l>1&&a(e[s[l-2]],e[s[l-1]],c)>=0;)l-=1,s.pop();s.push(u)}for(var r=new Array(s.length+o.length-2),f=0,n=0,h=o.length;n<h;++n)r[f++]=o[n];for(var m=s.length-2;m>0;--m)r[f++]=s[m];return r}t.exports=n;var a=e("robust-orientation")[3]},{"robust-orientation":64}],63:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var r,n,a,i;for("undefined"==typeof t&&(t=15),a=.5,r=new Date;;){for(a*=2,i=a;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;if(n=new Date,n-r>t)break}for(i=a;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;return n=new Date,1e3*(3*a-1)/(n-r)},numeric._myIndexOf=function(e){var t,r=this.length;for(t=0;t<r;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+t(-e);if(isFinite(e)){var r=Math.floor(Math.log(e)/Math.log(10)),n=e/Math.pow(10,r),a=n.toPrecision(numeric.precision);return 10===parseFloat(a)&&(r++,n=1,a=n.toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+r.toString()}return"Infinity"}function r(e){var a;if("undefined"==typeof e)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return n.push('"'+e+'"'),!1;if("boolean"==typeof e)return n.push(e.toString()),!1;if("number"==typeof e){var i=t(e),o=e.toPrecision(numeric.precision),s=parseFloat(e.toString()).toString(),u=[i,o,s,parseFloat(o).toString(),parseFloat(s).toString()];for(a=1;a<u.length;a++)u[a].length<i.length&&(i=u[a]);return n.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===e)return n.push("null"),!1;if("function"==typeof e){n.push(e.toString());var c=!1;for(a in e)e.hasOwnProperty(a)&&(c?n.push(",\n"):n.push("\n{"),c=!0,n.push(a),n.push(": \n"),r(e[a]));return c&&n.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return n.push("...Large Array..."),!0;var c=!1;for(n.push("["),a=0;a<e.length;a++)a>0&&(n.push(","),c&&n.push("\n ")),c=r(e[a]);return n.push("]"),!0}n.push("{");var c=!1;for(a in e)e.hasOwnProperty(a)&&(c&&n.push(",\n"),c=!0,n.push(a),n.push(": \n"),r(e[a]));return n.push("}"),!0}var n=[];return r(e),n.join("")},numeric.parseDate=function(e){function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r,n=[];for(r=0;r<e.length;r++)n[r]=t(e[r]);return n}return t(e)},numeric.parseFloat=function(e){function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r,n=[];for(r=0;r<e.length;r++)n[r]=t(e[r]);return n}return t(e)},numeric.parseCSV=function(e){var t,r,n=e.split("\n"),a=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,s=function(e){return e.substr(0,e.length-1)},u=0;for(r=0;r<n.length;r++){var c,l=(n[r]+",").match(i);if(l.length>0){for(a[u]=[],t=0;t<l.length;t++)c=s(l[t]),o.test(c)?a[u][t]=parseFloat(c):a[u][t]=c;u++}}return a},numeric.toCSV=function(e){var t,r,n,a,i,o,s=numeric.dim(e);for(n=s[0],a=s[1],o=[],t=0;t<n;t++){for(i=[],r=0;r<n;r++)i[r]=e[t][r].toString();o[t]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e){var t,r,n,a,i,o,s,u,c=e.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="";for(t=0;t<c;t+=3)r=e[t],n=e[t+1],a=e[t+2],i=r>>2,o=((3&r)<<4)+(n>>4),s=((15&n)<<2)+(a>>6),u=63&a,t+1>=c?s=u=64:t+2>=c&&(u=64),f+=l.charAt(i)+l.charAt(o)+l.charAt(s)+l.charAt(u);return f}function r(e,t,r){"undefined"==typeof t&&(t=0),"undefined"==typeof r&&(r=e.length);var n,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,o=0;e.length;for(n=t;n<r;n++)o=255&(i^e[n]),i=i>>>8^a[o];return i^-1}var n,a,i,o,s,u,c,l,f,h,m=e[0].length,d=e[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,d>>24&255,d>>16&255,d>>8&255,255&d,m>>24&255,m>>16&255,m>>8&255,255&m,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=r(p,12,29),p[29]=h>>24&255,p[30]=h>>16&255,p[31]=h>>8&255,p[32]=255&h,n=1,a=0,c=0;c<m;c++){for(c<m-1?p.push(0):p.push(1),s=3*d+1+(0===c)&255,u=3*d+1+(0===c)>>8&255,p.push(s),p.push(u),p.push(255&~s),p.push(255&~u),0===c&&p.push(0),l=0;l<d;l++)for(i=0;i<3;i++)s=e[i][c][l],s=s>255?255:s<0?0:Math.round(s),n=(n+s)%65521,a=(a+n)%65521,p.push(s);p.push(0)}return f=(a<<16)+n,p.push(f>>24&255),p.push(f>>16&255),p.push(f>>8&255),p.push(255&f),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,h=r(p,37),p.push(h>>24&255),p.push(h>>16&255),p.push(h>>8&255),p.push(255&h),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+t(p)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,r;return"object"==typeof e?(t=e[0],"object"==typeof t?(r=t[0],"object"==typeof r?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,r){var n,a;if(!(t instanceof Array&&r instanceof Array))return!1;if(a=t.length,a!==r.length)return!1;for(n=0;n<a;n++)if(t[n]!==r[n]){if("object"!=typeof t[n])return!1;if(!e(t[n],r[n]))return!1}return!0},numeric.rep=function(e,t,r){"undefined"==typeof r&&(r=0);var n,a=e[r],i=Array(a);if(r===e.length-1){for(n=a-2;n>=0;n-=2)i[n+1]=t,i[n]=t;return n===-1&&(i[0]=t),i}for(n=a-1;n>=0;n--)i[n]=numeric.rep(e,t,r+1);return i},numeric.dotMMsmall=function(e,t){var r,n,a,i,o,s,u,c,l,f,h;for(i=e.length,o=t.length,s=t[0].length,u=Array(i),r=i-1;r>=0;r--){for(c=Array(s),l=e[r],a=s-1;a>=0;a--){for(f=l[o-1]*t[o-1][a],n=o-2;n>=1;n-=2)h=n-1,f+=l[n]*t[n][a]+l[h]*t[h][a];0===n&&(f+=l[0]*t[0][a]),c[a]=f}u[r]=c}return u},numeric._getCol=function(e,t,r){var n,a=e.length;for(n=a-1;n>0;--n)r[n]=e[n][t],--n,r[n]=e[n][t];0===n&&(r[0]=e[0][t])},numeric.dotMMbig=function(e,t){var r,n,a,i,o=numeric._getCol,s=t.length,u=Array(s),c=e.length,l=t[0].length,f=new Array(c),h=numeric.dotVV;for(--s,--c,n=c;n!==-1;--n)f[n]=Array(l);for(--l,n=l;n!==-1;--n)for(o(t,n,u),a=c;a!==-1;--a)i=0,r=e[a],f[a][n]=h(r,u);return f},numeric.dotMV=function(e,t){var r,n=e.length,a=(t.length,Array(n)),i=numeric.dotVV;for(r=n-1;r>=0;r--)a[r]=i(e[r],t);return a},numeric.dotVM=function(e,t){var r,n,a,i,o,s,u;for(a=e.length,i=t[0].length,o=Array(i),n=i-1;n>=0;n--){for(s=e[a-1]*t[a-1][n],r=a-2;r>=1;r-=2)u=r-1,s+=e[r]*t[r][n]+e[u]*t[u][n];0===r&&(s+=e[0]*t[0][n]),o[n]=s}return o},numeric.dotVV=function(e,t){var r,n,a=e.length,i=e[a-1]*t[a-1];for(r=a-2;r>=1;r-=2)n=r-1,i+=e[r]*t[r]+e[n]*t[n];return 0===r&&(i+=e[0]*t[0]),i},numeric.dot=function(e,t){var r=numeric.dim;switch(1e3*r(e).length+r(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,r,n,a,i=e.length,o=Array(i);for(t=i-1;t>=0;t--){for(a=Array(i),r=t+2,n=i-1;n>=r;n-=2)a[n]=0,a[n-1]=0;for(n>t&&(a[n]=0),a[t]=e[t],n=t-1;n>=1;n-=2)a[n]=0,a[n-1]=0;0===n&&(a[0]=0),o[t]=a}return o},numeric.getDiag=function(e){var t,r=Math.min(e.length,e[0].length),n=Array(r);for(t=r-1;t>=1;--t)n[t]=e[t][t],--t,n[t]=e[t][t];return 0===t&&(n[0]=e[0][0]),n},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,r){"undefined"==typeof r&&(r="");var n,a,i=[],o=/\[i\]$/,s="",u=!1;for(n=0;n<e.length;n++)o.test(e[n])?(a=e[n].substring(0,e[n].length-3),s=a):a=e[n],"ret"===a&&(u=!0),i.push(a);return i[e.length]="_s",i[e.length+1]="_k",i[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(e,t,r){"undefined"==typeof r&&(r="");var n,a,i=[],o=/\[i\]$/,s="",u=!1;for(n=0;n<e.length;n++)o.test(e[n])?(a=e[n].substring(0,e[n].length-3),s=a):a=e[n],"ret"===a&&(u=!0),i.push(a);return i[e.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function e(t,r,n,a,i){if(a===n.length-1)return void i(t,r);var o,s=n[a];for(o=s-1;o>=0;o--)e("object"==typeof t?t[o]:t,"object"==typeof r?r[o]:r,n,a+1,i)},numeric._biforeach2=function e(t,r,n,a,i){if(a===n.length-1)return i(t,r);var o,s=n[a],u=Array(s);for(o=s-1;o>=0;--o)u[o]=e("object"==typeof t?t[o]:t,"object"==typeof r?r[o]:r,n,a+1,i);return u},numeric._foreach=function e(t,r,n,a){if(n===r.length-1)return void a(t);var i,o=r[n];for(i=o-1;i>=0;i--)e(t[i],r,n+1,a)},numeric._foreach2=function e(t,r,n,a){if(n===r.length-1)return a(t);var i,o=r[n],s=Array(o);for(i=o-1;i>=0;i--)s[i]=e(t[i],r,n+1,a);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var r,n,a="";numeric.myIndexOf.call(numeric.mathfuns2,e)!==-1?(a="var "+t+" = Math."+t+";\n",r=function(e,r,n){return e+" = "+t+"("+r+","+n+")"},n=function(e,r){return e+" = "+t+"("+e+","+r+")"}):(r=function(e,r,n){return e+" = "+r+" "+t+" "+n},n=numeric.opseq.hasOwnProperty(e+"eq")?function(e,r){return e+" "+t+"= "+r}:function(e,r){return e+" = "+e+" "+t+" "+r}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),a),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),a),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),a),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),a),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),a),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(a="",t=numeric.ops1[e],numeric.myIndexOf.call(numeric.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(a="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",a),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",a),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,r,n,a,i,o,s,e,u=numeric.dim(e),c=Math.abs,l=u[0],f=u[1],h=numeric.clone(e),m=numeric.identity(l);for(o=0;o<f;++o){var d=-1,p=-1;for(i=o;i!==l;++i)s=c(h[i][o]),s>p&&(d=i,p=s);for(r=h[d],h[d]=h[o],h[o]=r,a=m[d],m[d]=m[o],m[o]=a,e=r[o],s=o;s!==f;++s)r[s]/=e;for(s=f-1;s!==-1;--s)a[s]/=e;for(i=l-1;i!==-1;--i)if(i!==o){for(t=h[i],n=m[i],e=t[o],s=o+1;s!==f;++s)t[s]-=r[s]*e;for(s=f-1;s>0;--s)n[s]-=a[s]*e,--s,n[s]-=a[s]*e;0===s&&(n[0]-=a[0]*e)}}return m},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r,n,a,i,o,s,u,c,l=t[0],f=1,h=numeric.clone(e);for(n=0;n<l-1;n++){for(a=n,r=n+1;r<l;r++)Math.abs(h[r][n])>Math.abs(h[a][n])&&(a=r);for(a!==n&&(u=h[a],h[a]=h[n],h[n]=u,f*=-1),i=h[n],r=n+1;r<l;r++){for(o=h[r],s=o[n]/i[n],a=n+1;a<l-1;a+=2)c=a+1,o[a]-=i[a]*s,o[c]-=i[c]*s;a!==l&&(o[a]-=i[a]*s)}if(0===i[n])return 0;f*=i[n]}return f*h[n][n]},numeric.transpose=function(e){var t,r,n,a,i,o=e.length,s=e[0].length,u=Array(s);for(r=0;r<s;r++)u[r]=Array(o);for(t=o-1;t>=1;t-=2){for(a=e[t],n=e[t-1],r=s-1;r>=1;--r)i=u[r],i[t]=a[r],i[t-1]=n[r],--r,i=u[r],i[t]=a[r],i[t-1]=n[r];0===r&&(i=u[0],i[t]=a[0],i[t-1]=n[0])}if(0===t){for(n=e[0],r=s-1;r>=1;--r)u[r][0]=n[r],--r,u[r][0]=n[r];0===r&&(u[0][0]=n[0])}return u},numeric.negtranspose=function(e){var t,r,n,a,i,o=e.length,s=e[0].length,u=Array(s);for(r=0;r<s;r++)u[r]=Array(o);for(t=o-1;t>=1;t-=2){for(a=e[t],n=e[t-1],r=s-1;r>=1;--r)i=u[r],i[t]=-a[r],i[t-1]=-n[r],--r,i=u[r],i[t]=-a[r],i[t-1]=-n[r];0===r&&(i=u[0],i[t]=-a[0],i[t-1]=-n[0])}if(0===t){for(n=e[0],r=s-1;r>=1;--r)u[r][0]=-n[r],--r,u[r][0]=-n[r];0===r&&(u[0][0]=-n[0])}return u},numeric._random=function e(t,r){var n,a,i=t[r],o=Array(i);if(r===t.length-1){for(a=Math.random,n=i-1;n>=1;n-=2)o[n]=a(),o[n-1]=a();return 0===n&&(o[0]=a()),o}for(n=i-1;n>=0;n--)o[n]=e(t,r+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,r){if("undefined"==typeof r&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return 1===r?[e]:[];var n,a=Array(r);for(r--,n=r;n>=0;n--)a[n]=(n*t+(r-n)*e)/r;return a},numeric.getBlock=function(e,t,r){function n(e,i){var o,s=t[i],u=r[i]-s,c=Array(u);if(i===a.length-1){for(o=u;o>=0;o--)c[o]=e[o+s];return c}for(o=u;o>=0;o--)c[o]=n(e[o+s],i+1);return c}var a=numeric.dim(e);return n(e,0)},numeric.setBlock=function(e,t,r,n){function a(e,n,o){var s,u=t[o],c=r[o]-u;if(o===i.length-1)for(s=c;s>=0;s--)e[s+u]=n[s];for(s=c;s>=0;s--)a(e[s+u],n[s],o+1)}var i=numeric.dim(e);return a(e,n,0),e},numeric.getRange=function(e,t,r){var n,a,i,o,s=t.length,u=r.length,c=Array(s);for(n=s-1;n!==-1;--n)for(c[n]=Array(u),i=c[n],o=e[t[n]],a=u-1;a!==-1;--a)i[a]=o[r[a]];return c},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var r,n,a,i,o,s=t[0],u=t[1];for(r=0,n=0,a=0;a<s;++a)r+=e[a][0].length;for(i=0;i<u;++i)n+=e[0][i][0].length;var c=Array(r);for(a=0;a<r;++a)c[a]=Array(n);var l,f,h,m,d,p=0;for(a=0;a<s;++a){for(l=n,i=u-1;i!==-1;--i)for(o=e[a][i],l-=o[0].length,h=o.length-1;h!==-1;--h)for(d=o[h],f=c[p+h],m=d.length-1;m!==-1;--m)f[l+m]=d[m];
p+=e[a][0].length}return c},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var r=numeric.dim(e),n=numeric.dim(t);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var a,i,o,s,u=r[0],c=n[0],l=Array(u);for(i=u-1;i>=0;i--){for(a=Array(c),s=e[i],o=c-1;o>=3;--o)a[o]=s*t[o],--o,a[o]=s*t[o],--o,a[o]=s*t[o],--o,a[o]=s*t[o];for(;o>=0;)a[o]=s*t[o],--o;l[i]=a}return l},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,r,n,a){numeric.indexOf;if("string"!=typeof a){var i;a="";for(i in numeric)numeric.hasOwnProperty(i)&&(e.indexOf(i)>=0||t.indexOf(i)>=0||r.indexOf(i)>=0||n.indexOf(i)>=0)&&i.length>1&&(a+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,r),t(numeric.neg(this.y),r))}return new T(t(1,this.x))},numeric.T.prototype.div=function e(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),e(r)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),numeric.negtranspose(r)):new numeric.T(e(t))},numeric.Tunop=function(e,t,r){return"string"!=typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if("undefined"==typeof e.y)return new numeric.T(numeric.inv(e.x));var t,r,n,a,i,o,s,u,c,l,f,t,r,n,h,m,d,p,v,g,y,M=e.x.length,b=numeric.identity(M),x=numeric.rep([M,M],0),S=numeric.clone(e.x),w=numeric.clone(e.y);for(t=0;t<M;t++){for(d=S[t][t],p=w[t][t],h=d*d+p*p,n=t,r=t+1;r<M;r++)d=S[r][t],p=w[r][t],m=d*d+p*p,m>h&&(n=r,h=m);for(n!==t&&(y=S[t],S[t]=S[n],S[n]=y,y=w[t],w[t]=w[n],w[n]=y,y=b[t],b[t]=b[n],b[n]=y,y=x[t],x[t]=x[n],x[n]=y),a=S[t],i=w[t],u=b[t],c=x[t],d=a[t],p=i[t],r=t+1;r<M;r++)v=a[r],g=i[r],a[r]=(v*d+g*p)/h,i[r]=(g*d-v*p)/h;for(r=0;r<M;r++)v=u[r],g=c[r],u[r]=(v*d+g*p)/h,c[r]=(g*d-v*p)/h;for(r=t+1;r<M;r++){for(o=S[r],s=w[r],l=b[r],f=x[r],d=o[t],p=s[t],n=t+1;n<M;n++)v=a[n],g=i[n],o[n]-=v*d-g*p,s[n]-=g*d+v*p;for(n=0;n<M;n++)v=u[n],g=c[n],l[n]-=v*d-g*p,f[n]-=g*d+v*p}}for(t=M-1;t>0;t--)for(u=b[t],c=x[t],r=t-1;r>=0;r--)for(l=b[r],f=x[r],d=S[r][t],p=w[r][t],n=M-1;n>=0;n--)v=u[n],g=c[n],l[n]-=d*v-p*g,f[n]-=d*g+p*v;return new numeric.T(b,x)},numeric.T.prototype.get=function(e){var t,r=this.x,n=this.y,a=0,i=e.length;if(n){for(;a<i;)t=e[a],r=r[t],n=n[t],a++;return new numeric.T(r,n)}for(;a<i;)t=e[a],r=r[t],a++;return new numeric.T(r)},numeric.T.prototype.set=function(e,t){var r,n=this.x,a=this.y,i=0,o=e.length,s=t.x,u=t.y;if(0===o)return u?this.y=u:a&&(this.y=void 0),this.x=n,this;if(u){for(a||(a=numeric.rep(numeric.dim(n),0),this.y=a);i<o-1;)r=e[i],n=n[r],a=a[r],i++;return r=e[i],n[r]=s,a[r]=u,this}if(a){for(;i<o-1;)r=e[i],n=n[r],a=a[r],i++;return r=e[i],n[r]=s,s instanceof Array?a[r]=numeric.rep(numeric.dim(s),0):a[r]=0,this}for(;i<o-1;)r=e[i],n=n[r],i++;return r=e[i],n[r]=s,this},numeric.T.prototype.getRows=function(e,t){var r,n,a=t-e+1,i=Array(a),o=this.x,s=this.y;for(r=e;r<=t;r++)i[r-e]=o[r];if(s){for(n=Array(a),r=e;r<=t;r++)n[r-e]=s[r];return new numeric.T(i,n)}return new numeric.T(i)},numeric.T.prototype.setRows=function(e,t,r){var n,a=this.x,i=this.y,o=r.x,s=r.y;for(n=e;n<=t;n++)a[n]=o[n-e];if(s)for(i||(i=numeric.rep(numeric.dim(a),0),this.y=i),n=e;n<=t;n++)i[n]=s[n-e];else if(i)for(n=e;n<=t;n++)i[n]=numeric.rep([o[n-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,r=this.y;return r?new numeric.T(t[e],r[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var r=this.x,n=this.y,a=t.x,i=t.y;return r[e]=a,i?(n||(n=numeric.rep(numeric.dim(r),0),this.y=n),n[e]=i):n&&(n=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var r=this.x,n=this.y,a=numeric.getBlock;return n?new numeric.T(a(r,e,t),a(n,e,t)):new numeric.T(a(r,e,t))},numeric.T.prototype.setBlock=function(e,t,r){r instanceof numeric.T||(r=new numeric.T(r));var n=this.x,a=this.y,i=numeric.setBlock,o=r.x,s=r.y;return s?(a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),i(n,e,t,o),i(a,e,t,s),this):(i(n,e,t,o),void(a&&i(a,e,t,numeric.rep(numeric.dim(o),0))))},numeric.T.rep=function(e,t){var r=numeric.T;t instanceof r||(t=new r(t));var n=t.x,a=t.y,i=numeric.rep;return a?new r(i(e,n),i(e,a)):new r(i(e,n))},numeric.T.diag=function e(t){t instanceof numeric.T||(t=new numeric.T(t));var r=t.x,n=t.y,e=numeric.diag;return n?new numeric.T(e(r),e(n)):new numeric.T(e(r))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,r=this.y;return r?new e.T(e.getDiag(t),e.getDiag(r)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),r=e[0]>=0?1:-1,n=r*numeric.norm2(e);t[0]+=n;var a=numeric.norm2(t);if(0===a)throw new Error("eig: internal error");return numeric.div(t,a)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r,n,a,i,o,s,u,c,l,f,h=t[0],m=numeric.clone(e),d=numeric.identity(h);for(n=0;n<h-2;n++){for(i=Array(h-n-1),r=n+1;r<h;r++)i[r-n-1]=m[r][n];if(numeric.norm2(i)>0){for(o=numeric.house(i),s=numeric.getBlock(m,[n+1,n],[h-1,h-1]),u=numeric.tensor(o,numeric.dot(o,s)),r=n+1;r<h;r++)for(c=m[r],l=u[r-n-1],a=n;a<h;a++)c[a]-=2*l[a-n];for(s=numeric.getBlock(m,[0,n+1],[h-1,h-1]),u=numeric.tensor(numeric.dot(s,o),o),r=0;r<h;r++)for(c=m[r],l=u[r],a=n+1;a<h;a++)c[a]-=2*l[a-n-1];for(s=Array(h-n-1),r=n+1;r<h;r++)s[r-n-1]=d[r];for(u=numeric.tensor(o,numeric.dot(o,s)),r=n+1;r<h;r++)for(f=d[r],l=u[r-n-1],a=0;a<h;a++)f[a]-=2*l[a]}}return{H:m,Q:d}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,t){"undefined"==typeof t&&(t=1e4),e=numeric.clone(e);var r,n,a,i,o,s,u,c,l,f,h,m,d,p,v,g,y,M,b=(numeric.clone(e),numeric.dim(e)),x=b[0],S=numeric.identity(x);if(x<3)return{Q:S,B:[[0,x-1]]};var w=numeric.epsilon;for(M=0;M<t;M++){for(g=0;g<x-1;g++)if(Math.abs(e[g+1][g])<w*(Math.abs(e[g][g])+Math.abs(e[g+1][g+1]))){var D=numeric.QRFrancis(numeric.getBlock(e,[0,0],[g,g]),t),I=numeric.QRFrancis(numeric.getBlock(e,[g+1,g+1],[x-1,x-1]),t);for(m=Array(g+1),v=0;v<=g;v++)m[v]=S[v];for(d=numeric.dot(D.Q,m),v=0;v<=g;v++)S[v]=d[v];for(m=Array(x-g-1),v=g+1;v<x;v++)m[v-g-1]=S[v];for(d=numeric.dot(I.Q,m),v=g+1;v<x;v++)S[v]=d[v-g-1];return{Q:S,B:D.B.concat(numeric.add(I.B,g+1))}}if(a=e[x-2][x-2],i=e[x-2][x-1],o=e[x-1][x-2],s=e[x-1][x-1],c=a+s,u=a*s-i*o,l=numeric.getBlock(e,[0,0],[2,2]),c*c>=4*u){var F,_;F=.5*(c+Math.sqrt(c*c-4*u)),_=.5*(c-Math.sqrt(c*c-4*u)),l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,F+_)),numeric.diag(numeric.rep([3],F*_)))}else l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,c)),numeric.diag(numeric.rep([3],u)));for(r=[l[0][0],l[1][0],l[2][0]],n=numeric.house(r),m=[e[0],e[1],e[2]],d=numeric.tensor(n,numeric.dot(n,m)),v=0;v<3;v++)for(h=e[v],p=d[v],y=0;y<x;y++)h[y]-=2*p[y];for(m=numeric.getBlock(e,[0,0],[x-1,2]),d=numeric.tensor(numeric.dot(m,n),n),v=0;v<x;v++)for(h=e[v],p=d[v],y=0;y<3;y++)h[y]-=2*p[y];for(m=[S[0],S[1],S[2]],d=numeric.tensor(n,numeric.dot(n,m)),v=0;v<3;v++)for(f=S[v],p=d[v],y=0;y<x;y++)f[y]-=2*p[y];var A;for(g=0;g<x-2;g++){for(y=g;y<=g+1;y++)if(Math.abs(e[y+1][y])<w*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){var D=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),I=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[x-1,x-1]),t);for(m=Array(y+1),v=0;v<=y;v++)m[v]=S[v];for(d=numeric.dot(D.Q,m),v=0;v<=y;v++)S[v]=d[v];for(m=Array(x-y-1),v=y+1;v<x;v++)m[v-y-1]=S[v];for(d=numeric.dot(I.Q,m),v=y+1;v<x;v++)S[v]=d[v-y-1];return{Q:S,B:D.B.concat(numeric.add(I.B,y+1))}}for(A=Math.min(x-1,g+3),r=Array(A-g),v=g+1;v<=A;v++)r[v-g-1]=e[v][g];for(n=numeric.house(r),m=numeric.getBlock(e,[g+1,g],[A,x-1]),d=numeric.tensor(n,numeric.dot(n,m)),v=g+1;v<=A;v++)for(h=e[v],p=d[v-g-1],y=g;y<x;y++)h[y]-=2*p[y-g];for(m=numeric.getBlock(e,[0,g+1],[x-1,A]),d=numeric.tensor(numeric.dot(m,n),n),v=0;v<x;v++)for(h=e[v],p=d[v],y=g+1;y<=A;y++)h[y]-=2*p[y-g-1];for(m=Array(A-g),v=g+1;v<=A;v++)m[v-g-1]=S[v];for(d=numeric.tensor(n,numeric.dot(n,m)),v=g+1;v<=A;v++)for(f=S[v],p=d[v-g-1],y=0;y<x;y++)f[y]-=2*p[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var r,n,a,i,o,s,u,c,l,f,h,m,d,p,v,g,y,M=numeric.toUpperHessenberg(e),b=numeric.QRFrancis(M.H,t),x=numeric.T,S=e.length,w=b.B,D=numeric.dot(b.Q,numeric.dot(M.H,numeric.transpose(b.Q))),I=new x(numeric.dot(b.Q,M.Q)),F=w.length,_=Math.sqrt;for(n=0;n<F;n++)if(r=w[n][0],r===w[n][1]);else{if(i=r+1,o=D[r][r],s=D[r][i],u=D[i][r],c=D[i][i],0===s&&0===u)continue;l=-o-c,f=o*c-s*u,h=l*l-4*f,h>=0?(m=l<0?-.5*(l-_(h)):-.5*(l+_(h)),g=(o-m)*(o-m)+s*s,y=u*u+(c-m)*(c-m),g>y?(g=_(g),p=(o-m)/g,v=s/g):(y=_(y),p=u/y,v=(c-m)/y),a=new x([[v,-p],[p,v]]),I.setRows(r,i,a.dot(I.getRows(r,i)))):(m=-.5*l,d=.5*_(-h),g=(o-m)*(o-m)+s*s,y=u*u+(c-m)*(c-m),g>y?(g=_(g+d*d),p=(o-m)/g,v=s/g,m=0,d/=g):(y=_(y+d*d),p=u/y,v=(c-m)/y,m=d/y,d=0),a=new x([[v,-p],[p,v]],[[m,d],[d,-m]]),I.setRows(r,i,a.dot(I.getRows(r,i))))}var A=I.dot(e).dot(I.transjugate()),S=e.length,P=numeric.T.identity(S);for(i=0;i<S;i++)if(i>0)for(n=i-1;n>=0;n--){var j=A.get([n,n]),C=A.get([i,i]);numeric.neq(j.x,C.x)||numeric.neq(j.y,C.y)?(m=A.getRow(n).getBlock([n],[i-1]),d=P.getRow(i).getBlock([n],[i-1]),P.set([i,n],A.get([n,i]).neg().sub(m.dot(d)).div(j.sub(C)))):P.setRow(i,P.getRow(n))}for(i=0;i<S;i++)m=P.getRow(i),P.setRow(i,m.div(m.norm2()));return P=P.transpose(),P=I.transjugate().dot(P),{lambda:A.getDiag(),E:P}},numeric.ccsSparse=function(e){var t,r,n,a,i=e.length,o=[];for(n=i-1;n!==-1;--n){r=e[n];for(a in r){for(a=parseInt(a);a>=o.length;)o[o.length]=0;0!==r[a]&&o[a]++}}var t=o.length,s=Array(t+1);for(s[0]=0,n=0;n<t;++n)s[n+1]=s[n]+o[n];var u=Array(s[t]),c=Array(s[t]);for(n=i-1;n!==-1;--n){r=e[n];for(a in r)0!==r[a]&&(o[a]--,u[s[a]+o[a]]=n,c[s[a]+o[a]]=r[a])}return[s,u,c]},numeric.ccsFull=function(e){var t,r,n,a,i=e[0],o=e[1],s=e[2],u=numeric.ccsDim(e),c=u[0],l=u[1],f=numeric.rep([c,l],0);for(t=0;t<l;t++)for(n=i[t],a=i[t+1],r=n;r<a;++r)f[o[r]][t]=s[r];return f},numeric.ccsTSolve=function(e,t,r,n,a){function i(e){var t;if(0===r[e]){for(r[e]=1,t=o[e];t<o[e+1];++t)i(s[t]);a[f]=e,++f}}var o=e[0],s=e[1],u=e[2],c=o.length-1,l=Math.max,f=0;"undefined"==typeof n&&(r=numeric.rep([c],0)),"undefined"==typeof n&&(n=numeric.linspace(0,r.length-1)),"undefined"==typeof a&&(a=[]);var h,m,d,p,v,g,y;for(h=n.length-1;h!==-1;--h)i(n[h]);for(a.length=f,h=a.length-1;h!==-1;--h)r[a[h]]=0;for(h=n.length-1;h!==-1;--h)m=n[h],r[m]=t[m];for(h=a.length-1;h!==-1;--h){for(m=a[h],d=o[m],p=l(o[m+1],d),v=d;v!==p;++v)if(s[v]===m){r[m]/=u[v];break}for(y=r[m],v=d;v!==p;++v)g=s[v],g!==m&&(r[g]-=y*u[v])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,r,n,a,i){var o,s,u,c=0,l=a.length,f=this.k,h=this.k1,m=this.j;if(0===n[e])for(n[e]=1,m[0]=e,f[0]=s=t[e],h[0]=u=t[e+1];;)if(s>=u){if(a[l]=m[c],0===c)return;++l,--c,s=f[c],u=h[c]}else o=i[r[s]],0===n[o]?(n[o]=1,f[c]=s,++c,m[c]=o,s=t[o],h[c]=u=t[o+1]):++s},numeric.ccsLPSolve=function(e,t,r,n,a,i,o){var s,u,c,l,f,h,m,d,p,v=e[0],g=e[1],y=e[2],M=(v.length-1,t[0]),b=t[1],x=t[2];for(u=M[a],c=M[a+1],n.length=0,s=u;s<c;++s)o.dfs(i[b[s]],v,g,r,n,i);for(s=n.length-1;s!==-1;--s)r[n[s]]=0;for(s=u;s!==c;++s)l=i[b[s]],r[l]=x[s];for(s=n.length-1;s!==-1;--s){for(l=n[s],f=v[l],h=v[l+1],m=f;m<h;++m)if(i[g[m]]===l){r[l]/=y[m];break}for(p=r[l],m=f;m<h;++m)d=i[g[m]],d!==l&&(r[d]-=p*y[m])}return r},numeric.ccsLUP1=function(e,t){var r,n,a,i,o,s,u,c=e[0].length-1,l=[numeric.rep([c+1],0),[],[]],f=[numeric.rep([c+1],0),[],[]],h=l[0],m=l[1],d=l[2],p=f[0],v=f[1],g=f[2],y=numeric.rep([c],0),M=numeric.rep([c],0),b=numeric.ccsLPSolve,x=(Math.max,Math.abs),S=numeric.linspace(0,c-1),w=numeric.linspace(0,c-1),D=new numeric.ccsDFS(c);for("undefined"==typeof t&&(t=1),r=0;r<c;++r){for(b(l,e,y,M,r,w,D),i=-1,o=-1,n=M.length-1;n!==-1;--n)a=M[n],a<=r||(s=x(y[a]),s>i&&(o=a,i=s));for(x(y[r])<t*i&&(n=S[r],i=S[o],S[r]=i,w[i]=r,S[o]=n,w[n]=o,i=y[r],y[r]=y[o],y[o]=i),i=h[r],o=p[r],u=y[r],m[i]=S[r],d[i]=1,++i,n=M.length-1;n!==-1;--n)a=M[n],s=y[a],M[n]=0,y[a]=0,a<=r?(v[o]=a,g[o]=s,++o):(m[i]=S[a],d[i]=s/u,++i);h[r+1]=i,p[r+1]=o}for(n=m.length-1;n!==-1;--n)m[n]=w[m[n]];return{L:l,U:f,P:S,Pinv:w}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,r,n,a,i,o){var s,u,c,l=0,f=a.length,h=this.k,m=this.k1,d=this.j;if(0===n[e])for(n[e]=1,d[0]=e,h[0]=u=t[i[e]],m[0]=c=t[i[e]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=c){if(a[f]=i[d[l]],0===l)return;++f,--l,u=h[l],c=m[l]}else s=r[u],0===n[s]?(n[s]=1,h[l]=u,++l,d[l]=s,s=i[s],u=t[s],m[l]=c=t[s+1]):++u}},numeric.ccsLPSolve0=function(e,t,r,n,a,i,o,s){var u,c,l,f,h,m,d,p,v,g=e[0],y=e[1],M=e[2],b=(g.length-1,t[0]),x=t[1],S=t[2];for(c=b[a],l=b[a+1],n.length=0,u=c;u<l;++u)s.dfs(x[u],g,y,r,n,i,o);for(u=n.length-1;u!==-1;--u)f=n[u],r[o[f]]=0;for(u=c;u!==l;++u)f=x[u],r[f]=S[u];for(u=n.length-1;u!==-1;--u){for(f=n[u],p=o[f],h=g[f],m=g[f+1],d=h;d<m;++d)if(y[d]===p){r[p]/=M[d];break}for(v=r[p],d=h;d<m;++d)r[y[d]]-=v*M[d];r[p]=v}},numeric.ccsLUP0=function(e,t){var r,n,a,i,o,s,u,c=e[0].length-1,l=[numeric.rep([c+1],0),[],[]],f=[numeric.rep([c+1],0),[],[]],h=l[0],m=l[1],d=l[2],p=f[0],v=f[1],g=f[2],y=numeric.rep([c],0),M=numeric.rep([c],0),b=numeric.ccsLPSolve0,x=(Math.max,Math.abs),S=numeric.linspace(0,c-1),w=numeric.linspace(0,c-1),D=new numeric.ccsDFS0(c);for("undefined"==typeof t&&(t=1),r=0;r<c;++r){for(b(l,e,y,M,r,w,S,D),i=-1,o=-1,n=M.length-1;n!==-1;--n)a=M[n],a<=r||(s=x(y[S[a]]),s>i&&(o=a,i=s));for(x(y[S[r]])<t*i&&(n=S[r],i=S[o],S[r]=i,w[i]=r,S[o]=n,w[n]=o),i=h[r],o=p[r],u=y[S[r]],m[i]=S[r],d[i]=1,++i,n=M.length-1;n!==-1;--n)a=M[n],s=y[S[a]],M[n]=0,y[S[a]]=0,a<=r?(v[o]=a,g[o]=s,++o):(m[i]=S[a],d[i]=s/u,++i);h[r+1]=i,p[r+1]=o}for(n=m.length-1;n!==-1;--n)m[n]=w[m[n]];return{L:l,U:f,P:S,Pinv:w}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,r){var n=numeric.ccsDim(e),a=n[0],i=n[1];"undefined"==typeof t?t=numeric.linspace(0,a-1):"number"==typeof t&&(t=[t]),"undefined"==typeof r?r=numeric.linspace(0,i-1):"number"==typeof r&&(r=[r]);var o,s,u,c,l,f=t.length,h=r.length,m=numeric.rep([i],0),d=[],p=[],v=[m,d,p],g=e[0],y=e[1],M=e[2],b=numeric.rep([a],0),x=0,S=numeric.rep([a],0);for(s=0;s<h;++s){c=r[s];var w=g[c],D=g[c+1];for(o=w;o<D;++o)u=y[o],S[u]=1,b[u]=M[o];for(o=0;o<f;++o)l=t[o],S[l]&&(d[x]=o,p[x]=b[t[o]],++x);for(o=w;o<D;++o)u=y[o],S[u]=0;m[s+1]=x}return v},numeric.ccsDot=function(e,t){var r,n,a,i,o,s,u,c,l,f,h,m=e[0],d=e[1],p=e[2],v=t[0],g=t[1],y=t[2],M=numeric.ccsDim(e),b=numeric.ccsDim(t),x=M[0],S=(M[1],b[1]),w=numeric.rep([x],0),D=numeric.rep([x],0),I=Array(x),F=numeric.rep([S],0),_=[],A=[],P=[F,_,A];for(a=0;a!==S;++a){for(i=v[a],o=v[a+1],l=0,n=i;n<o;++n)for(f=g[n],h=y[n],s=m[f],u=m[f+1],r=s;r<u;++r)c=d[r],0===D[c]&&(I[l]=c,D[c]=1,l+=1),w[c]=w[c]+p[r]*h;for(i=F[a],o=i+l,F[a+1]=o,n=l-1;n!==-1;--n)h=i+n,r=I[n],_[h]=r,A[h]=w[r],D[r]=0,w[r]=0;F[a+1]=F[a]+l}return P},numeric.ccsLUPSolve=function(e,t){var r=e.L,n=e.U,a=(e.P,t[0]),i=!1;"object"!=typeof a&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],a=t[0],i=!0);var o,s,u,c,l,f,h=t[1],m=t[2],d=r[0].length-1,p=a.length-1,v=numeric.rep([d],0),g=Array(d),y=numeric.rep([d],0),M=Array(d),b=numeric.rep([p+1],0),x=[],S=[],w=numeric.ccsTSolve,D=0;for(o=0;o<p;++o){for(l=0,u=a[o],c=a[o+1],s=u;s<c;++s)f=e.Pinv[h[s]],M[l]=f,y[f]=m[s],++l;for(M.length=l,w(r,y,v,M,g),s=M.length-1;s!==-1;--s)y[M[s]]=0;if(w(n,v,y,g,M),i)return y;for(s=g.length-1;s!==-1;--s)v[g[s]]=0;for(s=M.length-1;s!==-1;--s)f=M[s],x[D]=f,S[D]=y[f],y[f]=0,++D;b[o+1]=D}return[b,x,S]},numeric.ccsbinop=function(e,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,r=e[0],n=e[1],a=e[2],i=numeric.sup(n)+1,o=r.length,s=numeric.rep([i],0),u=Array(o),c=Array(o),l=numeric.rep([i],0);for(t=0;t<o;++t)l[n[t]]++;for(t=0;t<i;++t)s[t+1]=s[t]+l[t];var f,h,m=s.slice(0);for(t=0;t<o;++t)h=n[t],f=m[h],u[f]=r[t],c[f]=a[t],m[h]=m[h]+1;return[s,u,c]},numeric.ccsGather=function(e){var t,r,n,a,i,o=e[0],s=e[1],u=e[2],c=o.length-1,l=s.length,f=Array(l),h=Array(l),m=Array(l);for(i=0,t=0;t<c;++t)for(n=o[t],a=o[t+1],r=n;r!==a;++r)h[i]=t,f[i]=s[r],m[i]=u[r],++i;return[f,h,m]},numeric.sdim=function e(t,r,n){if("undefined"==typeof r&&(r=[]),"object"!=typeof t)return r;"undefined"==typeof n&&(n=0),n in r||(r[n]=0),t.length>r[n]&&(r[n]=t.length);var a;for(a in t)t.hasOwnProperty(a)&&e(t[a],r,n+1);return r},numeric.sclone=function e(t,r,n){"undefined"==typeof r&&(r=0),"undefined"==typeof n&&(n=numeric.sdim(t).length);var a,i=Array(t.length);if(r===n-1){for(a in t)t.hasOwnProperty(a)&&(i[a]=t[a]);return i}for(a in t)t.hasOwnProperty(a)&&(i[a]=e(t[a],r+1,n));return i},numeric.sdiag=function(e){var t,r,n=e.length,a=Array(n);for(t=n-1;t>=1;t-=2)r=t-1,a[t]=[],a[t][t]=e[t],a[r]=[],a[r][r]=e[r];return 0===t&&(a[0]=[],a[0][0]=e[t]),a},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,r,n,a=[];e.length;for(t in e)if(e.hasOwnProperty(t)){n=e[t];for(r in n)n.hasOwnProperty(r)&&("object"!=typeof a[r]&&(a[r]=[]),a[r][t]=n[r])}return a},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var r,n,a,i,o,s,u,c=e.length,l=(t.length,numeric.stranspose(t)),f=l.length,h=Array(c);for(a=c-1;a>=0;a--){for(u=[],r=e[a],o=f-1;o>=0;o--){s=0,n=l[o];for(i in r)r.hasOwnProperty(i)&&i in n&&(s+=r[i]*n[i]);s&&(u[o]=s)}h[a]=u}return h},numeric.sdotMV=function(e,t){var r,n,a,i,o=e.length,s=Array(o);for(n=o-1;n>=0;n--){r=e[n],i=0;for(a in r)r.hasOwnProperty(a)&&t[a]&&(i+=r[a]*t[a]);i&&(s[n]=i)}return s},numeric.sdotVM=function(e,t){var r,n,a,i,o=[];for(r in e)if(e.hasOwnProperty(r)){a=t[r],i=e[r];for(n in a)a.hasOwnProperty(n)&&(o[n]||(o[n]=0),o[n]+=i*a[n])}return o},numeric.sdotVV=function(e,t){var r,n=0;for(r in e)e[r]&&t[r]&&(n+=e[r]*t[r]);return n},numeric.sdot=function(e,t){var r=numeric.sdim(e).length,n=numeric.sdim(t).length,a=1e3*r+n;switch(a){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+n)}},numeric.sscatter=function(e){var t,r,n,a,i=e[0].length,o=e.length,s=[];for(r=i-1;r>=0;--r)if(e[o-1][r]){for(a=s,n=0;n<o-2;n++)t=e[n][r],a[t]||(a[t]=[]),a=a[t];a[e[n][r]]=e[n+1][r]}return s},numeric.sgather=function e(t,r,n){"undefined"==typeof r&&(r=[]),"undefined"==typeof n&&(n=[]);var a,i,o;a=n.length;for(i in t)if(t.hasOwnProperty(i))if(n[a]=parseInt(i),o=t[i],"number"==typeof o){if(o){if(0===r.length)for(i=a+1;i>=0;--i)r[i]=[];for(i=a;i>=0;--i)r[i].push(n[i]);r[a+1].push(o)}}else e(o,r,n);return n.length>a&&n.pop(),r},numeric.cLU=function(e){var t,r,n,a,i,o,s=e[0],u=e[1],c=e[2],l=s.length,f=0;for(t=0;t<l;t++)s[t]>f&&(f=s[t]);f++;var h,m,d,p=Array(f),v=Array(f),g=numeric.rep([f],1/0),y=numeric.rep([f],-(1/0));for(n=0;n<l;n++)t=s[n],r=u[n],r<g[t]&&(g[t]=r),r>y[t]&&(y[t]=r);for(t=0;t<f-1;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=f-1;t>=1;t--)g[t]<g[t-1]&&(g[t-1]=g[t]);var M=0,b=0;for(t=0;t<f;t++)v[t]=numeric.rep([y[t]-g[t]+1],0),p[t]=numeric.rep([t-g[t]],0),M+=t-g[t]+1,b+=y[t]-t+1;for(n=0;n<l;n++)t=s[n],v[t][u[n]-g[t]]=c[n];for(t=0;t<f-1;t++)for(a=t-g[t],h=v[t],r=t+1;g[r]<=t&&r<f;r++)if(i=t-g[r],o=y[t]-t,m=v[r],d=m[i]/h[a]){for(n=1;n<=o;n++)m[n+i]-=d*h[n+a];p[r][t-g[r]]=d}var l,x,S,h=[],m=[],w=[],D=[],I=[],F=[];for(l=0,x=0,t=0;t<f;t++){for(a=g[t],i=y[t],S=v[t],r=t;r<=i;r++)S[r-a]&&(h[l]=t,m[l]=r,w[l]=S[r-a],l++);for(S=p[t],r=a;r<t;r++)S[r-a]&&(D[x]=t,I[x]=r,F[x]=S[r-a],x++);D[x]=t,I[x]=t,F[x]=1,x++}return{U:[h,m,w],L:[D,I,F]}},numeric.cLUsolve=function(e,t){var r,n,a=e.L,i=e.U,o=numeric.clone(t),s=a[0],u=a[1],c=a[2],l=i[0],f=i[1],h=i[2],m=l.length,d=(s.length,o.length);for(n=0,r=0;r<d;r++){for(;u[n]<r;)o[r]-=c[n]*o[u[n]],n++;n++}for(n=m-1,r=d-1;r>=0;r--){for(;f[n]>r;)o[r]-=h[n]*o[f[n]],n--;o[r]/=h[n],n--}return o},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var r,n,a,i=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,r){return t>=e[0]/2||r<e[1]/2};break;default:t=function(e,t){return!0}}for(a=0,r=1;r<e[0]-1;r++)for(n=1;n<e[1]-1;n++)t(r,n)&&(i[r][n]=a,a++);return i},numeric.cdelsq=function(e){var t,r,n,a,i,o=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(e),u=s[0],c=s[1],l=[],f=[],h=[];for(t=1;t<u-1;t++)for(r=1;r<c-1;r++)if(!(e[t][r]<0)){for(n=0;n<4;n++)a=t+o[n][0],i=r+o[n][1],e[a][i]<0||(l.push(e[t][r]),f.push(e[a][i]),h.push(-1));l.push(e[t][r]),f.push(e[t][r]),h.push(4)}return[l,f,h]},numeric.cdotMV=function(e,t){var r,n,a,i=e[0],o=e[1],s=e[2],u=i.length;for(a=0,n=0;n<u;n++)i[n]>a&&(a=i[n]);for(a++,r=numeric.rep([a],0),n=0;n<u;n++)r[i[n]]+=s[n]*t[o[n]];return r},numeric.Spline=function(e,t,r,n,a){this.x=e,this.yl=t,this.yr=r,this.kl=n,this.kr=a},numeric.Spline.prototype._at=function(e,t){var e,r,n,a,i=this.x,o=this.yl,s=this.yr,u=this.kl,c=this.kr,l=numeric.add,f=numeric.sub,h=numeric.mul;r=f(h(u[t],i[t+1]-i[t]),f(s[t+1],o[t])),n=l(h(c[t+1],i[t]-i[t+1]),f(s[t+1],o[t])),a=(e-i[t])/(i[t+1]-i[t]);var m=a*(1-a);return l(l(l(h(1-a,o[t]),h(a,s[t+1])),h(r,m*(1-a))),h(n,m*a))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,r,n,a=this.x,i=a.length,o=Math.floor;for(t=0,r=i-1;r-t>1;)n=o((t+r)/2),a[n]<=e?t=n:r=n;return this._at(e,t)}var s,i=e.length,u=Array(i);for(s=i-1;s!==-1;--s)u[s]=this.at(e[s]);return u},numeric.Spline.prototype.diff=function(){var e,t,r,n=this.x,a=this.yl,i=this.yr,o=this.kl,s=this.kr,u=a.length,c=o,l=s,f=Array(u),h=Array(u),m=numeric.add,d=numeric.mul,p=numeric.div,v=numeric.sub;for(e=u-1;e!==-1;--e)t=n[e+1]-n[e],r=v(i[e+1],a[e]),f[e]=p(m(d(r,6),d(o[e],-4*t),d(s[e+1],-2*t)),t*t),h[e+1]=p(m(d(r,-6),d(o[e],2*t),d(s[e+1],4*t)),t*t);return new numeric.Spline(n,c,l,f,h)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],r=this.x,n=this.yl,a=this.yr,i=this.kl,o=this.kr;"number"==typeof n[0]&&(n=[n],a=[a],i=[i],o=[o]);var s,u,c,l,f,h,m,d,p,v,g,y,M,b,x,S,w,D,I,F,_,A,P,j,C=n.length,T=r.length-1,t=Array(C),k=Math.sqrt;for(s=0;s!==C;++s){for(l=n[s],f=a[s],h=i[s],m=o[s],d=[],u=0;u!==T;u++){for(u>0&&f[u]*l[u]<0&&d.push(r[u]),S=r[u+1]-r[u],w=r[u],g=l[u],y=f[u+1],p=h[u]/S,v=m[u+1]/S,x=e(p-v+3*(g-y))+12*v*g,M=v+3*g+2*p-3*y,b=3*(v+p+2*(g-y)),x<=0?(I=M/b,D=I>r[u]&&I<r[u+1]?[r[u],I,r[u+1]]:[r[u],r[u+1]]):(I=(M-k(x))/b,F=(M+k(x))/b,D=[r[u]],I>r[u]&&I<r[u+1]&&D.push(I),F>r[u]&&F<r[u+1]&&D.push(F),D.push(r[u+1])),A=D[0],I=this._at(A,u),c=0;c<D.length-1;c++)if(P=D[c+1],F=this._at(P,u),0!==I)if(0===F||I*F>0)A=P,I=F;else{for(var R=0;;){if(j=(I*P-F*A)/(I-F),j<=A||j>=P)break;if(_=this._at(j,u),_*F>0)P=j,F=_,R===-1&&(I*=.5),R=-1;else{if(!(_*I>0))break;A=j,I=_,1===R&&(F*=.5),R=1}}d.push(j),A=D[c+1],I=this._at(A,u)}else d.push(A),A=P,I=F;0===F&&d.push(P)}t[s]=d}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,r,n){var a,i=e.length,o=[],s=[],u=[],c=numeric.sub,l=numeric.mul,f=numeric.add;for(a=i-2;a>=0;a--)s[a]=e[a+1]-e[a],u[a]=c(t[a+1],t[a]);"string"!=typeof r&&"string"!=typeof n||(r=n="periodic");var h=[[],[],[]];switch(typeof r){case"undefined":o[0]=l(3/(s[0]*s[0]),u[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/s[0],1/s[0]);break;case"string":o[0]=f(l(3/(s[i-2]*s[i-2]),u[i-2]),l(3/(s[0]*s[0]),u[0])),h[0].push(0,0,0),h[1].push(i-2,0,1),h[2].push(1/s[i-2],2/s[i-2]+2/s[0],1/s[0]);break;default:o[0]=r,h[0].push(0),h[1].push(0),h[2].push(1)}for(a=1;a<i-1;a++)o[a]=f(l(3/(s[a-1]*s[a-1]),u[a-1]),l(3/(s[a]*s[a]),u[a])),h[0].push(a,a,a),h[1].push(a-1,a,a+1),h[2].push(1/s[a-1],2/s[a-1]+2/s[a],1/s[a]);switch(typeof n){case"undefined":o[i-1]=l(3/(s[i-2]*s[i-2]),u[i-2]),h[0].push(i-1,i-1),h[1].push(i-2,i-1),h[2].push(1/s[i-2],2/s[i-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[i-1]=n,h[0].push(i-1),h[1].push(i-1),h[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var m=Array(o.length);if("string"==typeof r)for(a=m.length-1;a!==-1;--a)m[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[a]),m[a][i-1]=m[a][0];else for(a=m.length-1;a!==-1;--a)m[a]=numeric.cLUsolve(numeric.cLU(h),o[a]);return m="number"==typeof t[0]?m[0]:numeric.transpose(m),new numeric.Spline(e,t,t,m,m)},numeric.fftpow2=function e(t,r){var n=t.length;if(1!==n){var a,i,o=Math.cos,s=Math.sin,u=Array(n/2),c=Array(n/2),l=Array(n/2),f=Array(n/2);for(i=n/2,a=n-1;a!==-1;--a)--i,l[i]=t[a],f[i]=r[a],--a,u[i]=t[a],c[i]=r[a];e(u,c),e(l,f),i=n/2;var h,m,d,p=-6.283185307179586/n;for(a=n-1;a!==-1;--a)--i,i===-1&&(i=n/2-1),h=p*a,m=o(h),d=s(h),t[a]=u[i]+m*l[i]-d*f[i],r[a]=c[i]+m*f[i]+d*l[i]}},numeric._ifftpow2=function e(t,r){var n=t.length;if(1!==n){var a,i,o=Math.cos,s=Math.sin,u=Array(n/2),c=Array(n/2),l=Array(n/2),f=Array(n/2);for(i=n/2,a=n-1;a!==-1;--a)--i,l[i]=t[a],f[i]=r[a],--a,u[i]=t[a],c[i]=r[a];e(u,c),e(l,f),i=n/2;var h,m,d,p=6.283185307179586/n;for(a=n-1;a!==-1;--a)--i,i===-1&&(i=n/2-1),h=p*a,m=o(h),d=s(h),t[a]=u[i]+m*l[i]-d*f[i],r[a]=c[i]+m*f[i]+d*l[i]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,r,n){numeric.fftpow2(e,t),numeric.fftpow2(r,n);var a,i,o,s,u,c=e.length;for(a=c-1;a!==-1;--a)i=e[a],s=t[a],o=r[a],u=n[a],e[a]=i*o-s*u,t[a]=i*u+s*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,r=this.x,n=this.y,a=r.length,i=Math.log,o=i(2),s=Math.ceil(i(2*a-1)/o),u=Math.pow(2,s),c=numeric.rep([u],0),l=numeric.rep([u],0),f=Math.cos,h=Math.sin,m=-3.141592653589793/a,d=numeric.rep([u],0),p=numeric.rep([u],0);Math.floor(a/2);for(e=0;e<a;e++)d[e]=r[e];if("undefined"!=typeof n)for(e=0;e<a;e++)p[e]=n[e];for(c[0]=1,e=1;e<=u/2;e++)t=m*e*e,c[e]=f(t),l[e]=h(t),c[u-e]=f(t),l[u-e]=h(t);var v=new numeric.T(d,p),g=new numeric.T(c,l);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=a,v.y.length=a,v},numeric.T.prototype.ifft=function(){var e,t,r=this.x,n=this.y,a=r.length,i=Math.log,o=i(2),s=Math.ceil(i(2*a-1)/o),u=Math.pow(2,s),c=numeric.rep([u],0),l=numeric.rep([u],0),f=Math.cos,h=Math.sin,m=3.141592653589793/a,d=numeric.rep([u],0),p=numeric.rep([u],0);Math.floor(a/2);for(e=0;e<a;e++)d[e]=r[e];if("undefined"!=typeof n)for(e=0;e<a;e++)p[e]=n[e];for(c[0]=1,e=1;e<=u/2;e++)t=m*e*e,c[e]=f(t),l[e]=h(t),c[u-e]=f(t),l[u-e]=h(t);var v=new numeric.T(d,p),g=new numeric.T(c,l);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=a,v.y.length=a,v.div(a)},numeric.gradient=function(e,t){var r=t.length,n=e(t);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var a,i,o,s,u,c,l,f,h,m,d=Math.max,p=numeric.clone(t),v=Array(r),d=(numeric.div,numeric.sub,Math.max),g=.001,y=Math.abs,M=Math.min,b=0;for(a=0;a<r;a++)for(var x=d(1e-6*n,1e-8);;){if(++b,b>20)throw new Error("Numerical gradient fails");if(p[a]=t[a]+x,i=e(p),p[a]=t[a]-x,o=e(p),p[a]=t[a],isNaN(i)||isNaN(o))x/=16;else{if(v[a]=(i-o)/(2*x),u=t[a]-x,c=t[a],l=t[a]+x,f=(i-n)/x,h=(n-o)/x,m=d(y(v[a]),y(n),y(i),y(o),y(u),y(c),y(l),1e-8),s=M(d(y(f-v[a]),y(h-v[a]),y(f-h))/m,x/m),!(s>g))break;x/=16}}return v},numeric.uncmin=function(e,t,r,n,a,i,o){var s=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof r&&(r=1e-8),"undefined"==typeof n&&(n=function(t){return s(e,t)}),"undefined"==typeof a&&(a=1e3),t=numeric.clone(t);var u,c,l=t.length,f=e(t);if(isNaN(f))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,m=numeric.norm2;r=h(r,numeric.epsilon);var d,p,v,g,y,M,b,x,S,w,D=o.Hinv||numeric.identity(l),I=numeric.dot,F=(numeric.inv,numeric.sub),_=numeric.add,A=numeric.tensor,P=numeric.div,j=numeric.mul,C=numeric.all,T=numeric.isFinite,k=numeric.neg,R=0,E="";
for(p=n(t);R<a;){if("function"==typeof i&&i(R,t,f,p,D)){E="Callback returned true";break}if(!C(T(p))){E="Gradient has Infinity or NaN";break}if(d=k(I(D,p)),!C(T(d))){E="Search direction has Infinity or NaN";break}if(w=m(d),w<r){E="Newton step smaller than tol";break}for(S=1,c=I(p,d),y=t;R<a&&!(S*w<r)&&(g=j(d,S),y=_(t,g),u=e(y),u-f>=.1*S*c||isNaN(u));)S*=.5,++R;if(S*w<r){E="Line search step size smaller than tol";break}if(R===a){E="maxit reached during line search";break}v=n(y),M=F(v,p),x=I(M,g),b=I(D,M),D=F(_(D,j((x+I(M,b))/(x*x),A(g,g))),P(_(A(b,g),A(g,b)),x)),t=y,f=u,p=v,++R}return{solution:t,f:f,gradient:p,invHessian:D,iterations:R,message:E}},numeric.Dopri=function(e,t,r,n,a,i,o){this.x=e,this.y=t,this.f=r,this.ymid=n,this.iterations=a,this.events=o,this.message=i},numeric.Dopri.prototype._at=function(e,t){function r(e){return e*e}var n,a,i,o,s,u,e,c,l,f,h,m=this,d=m.x,p=m.y,v=m.f,g=m.ymid,y=(d.length,Math.floor,.5),M=numeric.add,b=numeric.mul,x=numeric.sub;return n=d[t],a=d[t+1],o=p[t],s=p[t+1],c=a-n,i=n+y*c,u=g[t],l=x(v[t],b(o,1/(n-i)+2/(n-a))),f=x(v[t+1],b(s,1/(a-i)+2/(a-n))),h=[r(e-a)*(e-i)/r(n-a)/(n-i),r(e-n)*r(e-a)/r(n-i)/r(a-i),r(e-n)*(e-i)/r(a-n)/(a-i),(e-n)*r(e-a)*(e-i)/r(n-a)/(n-i),(e-a)*r(e-n)*(e-i)/r(n-a)/(a-i)],M(M(M(M(b(o,h[0]),b(u,h[1])),b(s,h[2])),b(l,h[3])),b(f,h[4]))},numeric.Dopri.prototype.at=function(e){var t,r,n,a=Math.floor;if("number"!=typeof e){var i=e.length,o=Array(i);for(t=i-1;t!==-1;--t)o[t]=this.at(e[t]);return o}var s=this.x;for(t=0,r=s.length-1;r-t>1;)n=a(.5*(t+r)),s[n]<=e?t=n:r=n;return this._at(e,t)},numeric.dopri=function(e,t,r,n,a,i,o){"undefined"==typeof a&&(a=1e-6),"undefined"==typeof i&&(i=1e3);var s,u,c,l,f,h,m,d,p,v,g,y,M,b=[e],x=[r],S=[n(e,r)],w=[],D=.2,I=[.075,.225],F=[44/45,-56/15,32/9],_=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],P=[35/384,0,500/1113,125/192,-2187/6784,11/84],j=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],C=[.2,.3,.8,8/9,1,1],T=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],k=0,R=(t-e)/10,E=0,O=numeric.add,q=numeric.mul,z=(Math.max,Math.min),L=Math.abs,N=numeric.norminf,B=Math.pow,V=numeric.any,U=numeric.lt,H=numeric.and,G=(numeric.sub,new numeric.Dopri(b,x,S,w,(-1),""));for("function"==typeof o&&(g=o(e,r));e<t&&E<i;)if(++E,e+R>t&&(R=t-e),s=n(e+C[0]*R,O(r,q(D*R,S[k]))),u=n(e+C[1]*R,O(O(r,q(I[0]*R,S[k])),q(I[1]*R,s))),c=n(e+C[2]*R,O(O(O(r,q(F[0]*R,S[k])),q(F[1]*R,s)),q(F[2]*R,u))),l=n(e+C[3]*R,O(O(O(O(r,q(_[0]*R,S[k])),q(_[1]*R,s)),q(_[2]*R,u)),q(_[3]*R,c))),f=n(e+C[4]*R,O(O(O(O(O(r,q(A[0]*R,S[k])),q(A[1]*R,s)),q(A[2]*R,u)),q(A[3]*R,c)),q(A[4]*R,l))),p=O(O(O(O(O(r,q(S[k],R*P[0])),q(u,R*P[2])),q(c,R*P[3])),q(l,R*P[4])),q(f,R*P[5])),h=n(e+R,p),m=O(O(O(O(O(q(S[k],R*T[0]),q(u,R*T[2])),q(c,R*T[3])),q(l,R*T[4])),q(f,R*T[5])),q(h,R*T[6])),v="number"==typeof m?L(m):N(m),v>a){if(R=.2*R*B(a/v,.25),e+R===e){G.msg="Step size became too small";break}}else{if(w[k]=O(O(O(O(O(O(r,q(S[k],R*j[0])),q(u,R*j[2])),q(c,R*j[3])),q(l,R*j[4])),q(f,R*j[5])),q(h,R*j[6])),++k,b[k]=e+R,x[k]=p,S[k]=h,"function"==typeof o){var Y,X,Q=e,W=e+.5*R;if(y=o(W,w[k-1]),M=H(U(g,0),U(0,y)),V(M)||(Q=W,W=e+R,g=y,y=o(W,p),M=H(U(g,0),U(0,y))),V(M)){for(var Z,J,K=0,$=1,ee=1;;){if("number"==typeof g)X=(ee*y*Q-$*g*W)/(ee*y-$*g);else for(X=W,d=g.length-1;d!==-1;--d)g[d]<0&&y[d]>0&&(X=z(X,(ee*y[d]*Q-$*g[d]*W)/(ee*y[d]-$*g[d])));if(X<=Q||X>=W)break;Y=G._at(X,k-1),J=o(X,Y),Z=H(U(g,0),U(0,J)),V(Z)?(W=X,y=J,M=Z,ee=1,K===-1?$*=.5:$=1,K=-1):(Q=X,g=J,$=1,1===K?ee*=.5:ee=1,K=1)}return p=G._at(.5*(e+X),k-1),G.f[k]=n(X,Y),G.x[k]=X,G.y[k]=Y,G.ymid[k-1]=p,G.events=M,G.iterations=E,G}}e+=R,r=p,g=y,R=z(.8*R*B(a/v,.25),4*R)}return G.iterations=E,G},numeric.LU=function(e,t){t=t||!1;var r,n,a,i,o,s,u,c,l,f=Math.abs,h=e.length,m=h-1,d=new Array(h);for(t||(e=numeric.clone(e)),a=0;a<h;++a){for(u=a,s=e[a],l=f(s[a]),n=a+1;n<h;++n)i=f(e[n][a]),l<i&&(l=i,u=n);for(d[a]=u,u!=a&&(e[a]=e[u],e[u]=s,s=e[a]),o=s[a],r=a+1;r<h;++r)e[r][a]/=o;for(r=a+1;r<h;++r){for(c=e[r],n=a+1;n<m;++n)c[n]-=c[a]*s[n],++n,c[n]-=c[a]*s[n];n===m&&(c[n]-=c[a]*s[n])}}return{LU:e,P:d}},numeric.LUsolve=function(e,t){var r,n,a,i,o,s=e.LU,u=s.length,c=numeric.clone(t),l=e.P;for(r=u-1;r!==-1;--r)c[r]=t[r];for(r=0;r<u;++r)for(a=l[r],l[r]!==r&&(o=c[r],c[r]=c[a],c[a]=o),i=s[r],n=0;n<r;++n)c[r]-=c[n]*i[n];for(r=u-1;r>=0;--r){for(i=s[r],n=r+1;n<u;++n)c[r]-=c[n]*i[n];c[r]/=i[r]}return c},numeric.solve=function(e,t,r){return numeric.LUsolve(numeric.LU(e,r),t)},numeric.echelonize=function(e){var t,r,n,a,i,o,s,u,c=numeric.dim(e),l=c[0],f=c[1],h=numeric.identity(l),m=Array(l),d=Math.abs,p=numeric.diveq;for(e=numeric.clone(e),t=0;t<l;++t){for(n=0,i=e[t],o=h[t],r=1;r<f;++r)d(i[n])<d(i[r])&&(n=r);for(m[t]=n,p(o,i[n]),p(i,i[n]),r=0;r<l;++r)if(r!==t){for(s=e[r],u=s[n],a=f-1;a!==-1;--a)s[a]-=i[a]*u;for(s=h[r],a=l-1;a!==-1;--a)s[a]-=o[a]*u}}return{I:h,A:e,P:m}},numeric.__solveLP=function(e,t,r,n,a,i,o){var s,u,c,l,f=numeric.sum,h=(numeric.log,numeric.mul),m=numeric.sub,d=numeric.dot,p=numeric.div,v=numeric.add,g=e.length,y=r.length,M=!1,b=0,x=1,S=(numeric.transpose(t),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),D=Math.abs,I=(numeric.muleq,numeric.norminf,numeric.any,Math.min),F=numeric.all,_=numeric.gt,A=Array(g),P=Array(y),j=(numeric.rep([y],1),numeric.solve),C=m(r,d(t,i)),T=d(e,e);for(c=b;c<a;++c){var k,R;for(k=y-1;k!==-1;--k)P[k]=p(t[k],C[k]);var E=S(P);for(k=g-1;k!==-1;--k)A[k]=f(E[k]);x=.25*D(T/d(e,A));var O=100*w(T/d(A,A));for((!isFinite(x)||x>O)&&(x=O),l=v(e,h(x,A)),u=d(E,P),k=g-1;k!==-1;--k)u[k][k]+=1;R=j(u,p(l,x),!0);var q=p(C,d(t,R)),z=1;for(k=y-1;k!==-1;--k)q[k]<0&&(z=I(z,-.999*q[k]));if(s=m(i,h(R,z)),C=m(r,d(t,s)),!F(_(C,0)))return{solution:i,message:"",iterations:c};if(i=s,x<n)return{solution:s,message:"",iterations:c};if(o){var L=d(e,l),N=d(t,l);for(M=!0,k=y-1;k!==-1;--k)if(L*N[k]<0){M=!1;break}}else M=!(i[g-1]>=0);if(M)return{solution:s,message:"Unbounded",iterations:c}}return{solution:i,message:"maximum iteration count exceeded",iterations:c}},numeric._solveLP=function(e,t,r,n,a){var i,o=e.length,s=r.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),f=numeric.rep([s,1],-1),h=numeric.blockMatrix([[t,f]]),m=r,i=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),d=numeric.__solveLP(l,h,m,n,a,i,!1),p=numeric.clone(d.solution);p.length=o;var v=numeric.inf(u(r,c(t,p)));if(v<0)return{solution:NaN,message:"Infeasible",iterations:d.iterations};var g=numeric.__solveLP(e,t,r,n,a-d.iterations,p,!0);return g.iterations+=d.iterations,g},numeric.solveLP=function(e,t,r,n,a,i,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof i&&(i=numeric.epsilon),"undefined"==typeof n)return numeric._solveLP(e,t,r,i,o);var s,u=n.length,c=n[0].length,l=t.length,f=numeric.echelonize(n),h=numeric.rep([c],0),m=f.P,d=[];for(s=m.length-1;s!==-1;--s)h[m[s]]=1;for(s=c-1;s!==-1;--s)0===h[s]&&d.push(s);var p=numeric.getRange,v=numeric.linspace(0,u-1),g=numeric.linspace(0,l-1),y=p(n,v,d),M=p(t,g,m),b=p(t,g,d),x=numeric.dot,S=numeric.sub,w=x(M,f.I),D=S(b,x(w,y)),I=S(r,x(w,a)),F=Array(m.length),_=Array(d.length);for(s=m.length-1;s!==-1;--s)F[s]=e[m[s]];for(s=d.length-1;s!==-1;--s)_[s]=e[d[s]];var A=S(_,x(F,x(f.I,y))),P=numeric._solveLP(A,D,I,i,o),j=P.solution;if(j!==j)return P;var C=x(f.I,S(a,x(y,j))),T=Array(e.length);for(s=m.length-1;s!==-1;--s)T[m[s]]=C[s];for(s=d.length-1;s!==-1;--s)T[d[s]]=j[s];return{solution:T,message:P.message,iterations:P.iterations}},numeric.MPStoLP=function(e){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+r+": "+e[r]+"\nCurrent state: "+s[o]+"\n")}e instanceof String&&e.split("\n");var r,n,a,i,o=0,s=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=e.length,c=0,l={},f=[],h=0,m={},d=0,p=[],v=[],g=[];for(r=0;r<u;++r){a=e[r];var y=a.match(/\S*/g),M=[];for(n=0;n<y.length;++n)""!==y[n]&&M.push(y[n]);if(0!==M.length){for(n=0;n<s.length&&a.substr(0,s[n].length)!==s[n];++n);if(n<s.length){if(o=n,1===n&&(i=M[1]),6===n)return{name:i,c:p,A:numeric.transpose(v),b:g,rows:l,vars:m}}else switch(o){case 0:case 1:t("Unexpected line");case 2:switch(M[0]){case"N":0===c?c=M[1]:t("Two or more N rows");break;case"L":l[M[1]]=h,f[h]=1,g[h]=0,++h;break;case"G":l[M[1]]=h,f[h]=-1,g[h]=0,++h;break;case"E":l[M[1]]=h,f[h]=0,g[h]=0,++h;break;default:t("Parse error "+numeric.prettyPrint(M))}break;case 3:m.hasOwnProperty(M[0])||(m[M[0]]=d,p[d]=0,v[d]=numeric.rep([h],0),++d);var b=m[M[0]];for(n=1;n<M.length;n+=2)if(M[n]!==c){var x=l[M[n]];v[b][x]=(f[x]<0?-1:1)*parseFloat(M[n+1])}else p[b]=parseFloat(M[n+1]);break;case 4:for(n=1;n<M.length;n+=2)g[l[M[n]]]=(f[l[M[n]]]<0?-1:1)*parseFloat(M[n+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,r,n,a,i,o){function s(e){var t,n,a=this,i=e.length,o=0,s=a.i=a.j=a.m=0;for(a.S=[],a.c=[],i||(e=[i++]);o<r;)a.S[o]=o++;for(o=0;o<r;o++)t=a.S[o],s=l(s+t+e[o%i]),n=a.S[s],a.S[o]=n,a.S[s]=t;a.g=function(e){var t=a.S,n=l(a.i+1),i=t[n],o=l(a.j+i),s=t[o];t[n]=s,t[o]=i;for(var u=t[l(i+s)];--e;)n=l(n+1),i=t[n],o=l(o+i),s=t[o],t[n]=s,t[o]=i,u=u*r+t[l(i+s)];return a.i=n,a.j=o,u},a.g(r)}function u(e,t,r,n,a){if(r=[],a=typeof e,t&&"object"==a)for(n in e)if(n.indexOf("S")<5)try{r.push(u(e[n],t-1))}catch(e){}return r.length?r:e+("string"!=a?"\0":"")}function c(e,t,r,n){for(e+="",r=0,n=0;n<e.length;n++)t[l(n)]=l((r^=19*t[l(n)])+e.charCodeAt(n));e="";for(n in t)e+=String.fromCharCode(t[n]);return e}function l(e){return e&r-1}t.seedrandom=function(l,f){var h,m=[];return l=c(u(f?[l,e]:arguments.length?l:[(new Date).getTime(),e,window],3),m),h=new s(m),c(h.S,e),t.random=function(){for(var e=h.g(n),t=o,s=0;e<a;)e=(e+s)*r,t*=r,s=h.g(1);for(;e>=i;)e/=2,t/=2,s>>>=1;return(e+s)/t},l},o=t.pow(r,n),a=t.pow(2,a),i=2*a,c(t.random(),e)}([],numeric.seedrandom,256,6,52),function(e){function t(e){if("object"!=typeof e)return e;var r,n=[],a=e.length;for(r=0;r<a;r++)n[r+1]=t(e[r]);return n}function r(e){if("object"!=typeof e)return e;var t,n=[],a=e.length;for(t=1;t<a;t++)n[t-1]=r(e[t]);return n}function n(e,t,r){var n,a,i,o,s;for(i=1;i<=r;i+=1){for(e[i][i]=1/e[i][i],s=-e[i][i],n=1;n<i;n+=1)e[n][i]=s*e[n][i];if(o=i+1,r<o)break;for(a=o;a<=r;a+=1)for(s=e[i][a],e[i][a]=0,n=1;n<=i;n+=1)e[n][a]=e[n][a]+s*e[n][i]}}function a(e,t,r,n){var a,i,o,s;for(i=1;i<=r;i+=1){for(s=0,a=1;a<i;a+=1)s+=e[a][i]*n[a];n[i]=(n[i]-s)/e[i][i]}for(o=1;o<=r;o+=1)for(i=r+1-o,n[i]=n[i]/e[i][i],s=-n[i],a=1;a<i;a+=1)n[a]=n[a]+s*e[a][i]}function i(e,t,r,n){var a,i,o,s,u,c;for(i=1;i<=r;i+=1){if(n[1]=i,c=0,o=i-1,o<1){if(c=e[i][i]-c,c<=0)break;e[i][i]=Math.sqrt(c)}else{for(s=1;s<=o;s+=1){for(u=e[s][i],a=1;a<s;a+=1)u-=e[a][i]*e[a][s];u/=e[s][s],e[s][i]=u,c+=u*u}if(c=e[i][i]-c,c<=0)break;e[i][i]=Math.sqrt(c)}n[1]=0}}function o(e,t,r,o,s,u,c,l,f,h,m,d,p,v,g,y){function M(){for(v[1]=v[1]+1,F=k,D=1;D<=h;D+=1){for(F+=1,L=-l[D],I=1;I<=o;I+=1)L+=c[I][D]*s[I];if(Math.abs(L)<X&&(L=0),D>m)g[F]=L;else if(g[F]=-Math.abs(L),L>0){for(I=1;I<=o;I+=1)c[I][D]=-c[I][D];l[D]=-l[D]}}for(D=1;D<=p;D+=1)g[k+d[D]]=0;for(E=0,z=0,D=1;D<=h;D+=1)g[k+D]<z*g[q+D]&&(E=D,z=g[k+D]/g[q+D]);return 0===E?999:0}function b(){for(D=1;D<=o;D+=1){for(L=0,I=1;I<=o;I+=1)L+=e[I][D]*c[I][E];g[D]=L}for(_=j,D=1;D<=o;D+=1)g[_+D]=0;for(I=p+1;I<=o;I+=1)for(D=1;D<=o;D+=1)g[_+D]=g[_+D]+e[D][I]*g[I];for(G=!0,D=p;D>=1;D-=1){for(L=g[D],F=T+D*(D+3)/2,_=F-D,I=D+1;I<=p;I+=1)L-=g[F]*g[C+I],F+=I;if(L/=g[_],g[C+D]=L,d[D]<m)break;if(L<0)break;G=!1,P=D}if(!G)for(N=g[R+P]/g[C+P],D=1;D<=p&&!(d[D]<m)&&!(g[C+D]<0);D+=1)z=g[R+D]/g[C+D],z<N&&(N=z,P=D);for(L=0,D=j+1;D<=j+o;D+=1)L+=g[D]*g[D];if(Math.abs(L)<=X){if(G)return y[1]=1,999;for(D=1;D<=p;D+=1)g[R+D]=g[R+D]-N*g[C+D];return g[R+p+1]=g[R+p+1]+N,700}for(L=0,D=1;D<=o;D+=1)L+=g[j+D]*c[D][E];for(B=-g[k+E]/L,Y=!0,G||N<B&&(B=N,Y=!1),D=1;D<=o;D+=1)s[D]=s[D]+B*g[j+D],Math.abs(s[D])<X&&(s[D]=0);for(u[1]=u[1]+B*L*(B/2+g[R+p+1]),D=1;D<=p;D+=1)g[R+D]=g[R+D]-B*g[C+D];if(g[R+p+1]=g[R+p+1]+B,!Y){for(L=-l[E],I=1;I<=o;I+=1)L+=s[I]*c[I][E];if(E>m)g[k+E]=L;else if(g[k+E]=-Math.abs(L),L>0){for(I=1;I<=o;I+=1)c[I][E]=-c[I][E];l[E]=-l[E]}return 700}for(p+=1,d[p]=E,F=T+(p-1)*p/2+1,D=1;D<=p-1;D+=1)g[F]=g[D],F+=1;if(p===o)g[F]=g[o];else{for(D=o;D>=p+1&&0!==g[D]&&(V=Math.max(Math.abs(g[D-1]),Math.abs(g[D])),U=Math.min(Math.abs(g[D-1]),Math.abs(g[D])),z=g[D-1]>=0?Math.abs(V*Math.sqrt(1+U*U/(V*V))):-Math.abs(V*Math.sqrt(1+U*U/(V*V))),V=g[D-1]/z,U=g[D]/z,1!==V);D-=1)if(0===V)for(g[D-1]=U*z,I=1;I<=o;I+=1)z=e[I][D-1],e[I][D-1]=e[I][D],e[I][D]=z;else for(g[D-1]=z,H=U/(1+V),I=1;I<=o;I+=1)z=V*e[I][D-1]+U*e[I][D],e[I][D]=H*(e[I][D-1]+z)-e[I][D],e[I][D-1]=z;g[F]=g[p]}return 0}function x(){if(F=T+P*(P+1)/2+1,_=F+P,0===g[_])return 798;if(V=Math.max(Math.abs(g[_-1]),Math.abs(g[_])),U=Math.min(Math.abs(g[_-1]),Math.abs(g[_])),z=g[_-1]>=0?Math.abs(V*Math.sqrt(1+U*U/(V*V))):-Math.abs(V*Math.sqrt(1+U*U/(V*V))),V=g[_-1]/z,U=g[_]/z,1===V)return 798;if(0===V){for(D=P+1;D<=p;D+=1)z=g[_-1],g[_-1]=g[_],g[_]=z,_+=D;for(D=1;D<=o;D+=1)z=e[D][P],e[D][P]=e[D][P+1],e[D][P+1]=z}else{for(H=U/(1+V),D=P+1;D<=p;D+=1)z=V*g[_-1]+U*g[_],g[_]=H*(g[_-1]+z)-g[_],g[_-1]=z,_+=D;for(D=1;D<=o;D+=1)z=V*e[D][P]+U*e[D][P+1],e[D][P+1]=H*(e[D][P]+z)-e[D][P+1],e[D][P]=z}return 0}function S(){for(_=F-P,D=1;D<=P;D+=1)g[_]=g[F],F+=1,_+=1;return g[R+P]=g[R+P+1],d[P]=d[P+1],P+=1,P<p?797:0}function w(){return g[R+p]=g[R+p+1],g[R+p+1]=0,d[p]=0,p-=1,v[2]=v[2]+1,0}var D,I,F,_,A,P,j,C,T,k,R,E,O,q,z,L,N,B,V,U,H,G,Y,X,Q,W,Z;O=Math.min(o,h),F=2*o+O*(O+5)/2+2*h+1,X=1e-60;do X+=X,Q=1+.1*X,W=1+.2*X;while(Q<=1||W<=1);for(D=1;D<=o;D+=1)g[D]=t[D];for(D=o+1;D<=F;D+=1)g[D]=0;for(D=1;D<=h;D+=1)d[D]=0;if(A=[],0===y[1]){if(i(e,r,o,A),0!==A[1])return void(y[1]=2);a(e,r,o,t),n(e,r,o)}else{for(I=1;I<=o;I+=1)for(s[I]=0,D=1;D<=I;D+=1)s[I]=s[I]+e[D][I]*t[D];for(I=1;I<=o;I+=1)for(t[I]=0,D=I;D<=o;D+=1)t[I]=t[I]+e[I][D]*s[D]}for(u[1]=0,I=1;I<=o;I+=1)for(s[I]=t[I],u[1]=u[1]+g[I]*s[I],g[I]=0,D=I+1;D<=o;D+=1)e[D][I]=0;for(u[1]=-u[1]/2,y[1]=0,j=o,C=j+o,R=C+O,T=R+O+1,k=T+O*(O+1)/2,q=k+h,D=1;D<=h;D+=1){for(L=0,I=1;I<=o;I+=1)L+=c[I][D]*c[I][D];g[q+D]=Math.sqrt(L)}for(p=0,v[1]=0,v[2]=0,Z=0;;){if(Z=M(),999===Z)return;for(;;){if(Z=b(),0===Z)break;if(999===Z)return;if(700===Z)if(P===p)w();else{for(;;)if(x(),Z=S(),797!==Z)break;w()}}}}function s(e,n,a,i,s,u){e=t(e),n=t(n),a=t(a);var c,l,f,h,m,d,p=[],v=[],g=[],y=[],M=[];if(s=s||0,u=u?t(u):[void 0,0],i=i?t(i):[],l=e.length-1,f=a[1].length-1,!i)for(c=1;c<=f;c+=1)i[c]=0;for(c=1;c<=f;c+=1)v[c]=0;for(h=0,m=Math.min(l,f),c=1;c<=l;c+=1)g[c]=0;for(p[1]=0,c=1;c<=2*l+m*(m+5)/2+2*f+1;c+=1)y[c]=0;for(c=1;c<=2;c+=1)M[c]=0;return o(e,n,l,l,g,p,a,i,l,f,s,v,h,M,y,u),d="",1===u[1]&&(d="constraints are inconsistent, no solution!"),2===u[1]&&(d="matrix D in quadratic function is not positive definite!"),{solution:r(g),value:r(p),unconstrained_solution:r(n),iterations:r(M),iact:r(v),message:d}}e.solveQP=s}(numeric),numeric.svd=function(e){function t(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var r,n=numeric.epsilon,a=1e-64/n,i=50,o=0,s=0,u=0,c=0,l=0,f=numeric.clone(e),h=f.length,m=f[0].length;if(h<m)throw"Need more rows than columns";var d=new Array(m),p=new Array(m);for(s=0;s<m;s++)d[s]=p[s]=0;var v=numeric.rep([m,m],0),g=0,y=0,M=0,b=0,x=0,S=0,w=0;for(s=0;s<m;s++){for(d[s]=y,w=0,l=s+1,u=s;u<h;u++)w+=f[u][s]*f[u][s];if(w<=a)y=0;else for(g=f[s][s],y=Math.sqrt(w),g>=0&&(y=-y),M=g*y-w,f[s][s]=g-y,u=l;u<m;u++){for(w=0,c=s;c<h;c++)w+=f[c][s]*f[c][u];for(g=w/M,c=s;c<h;c++)f[c][u]+=g*f[c][s]}for(p[s]=y,w=0,u=l;u<m;u++)w+=f[s][u]*f[s][u];if(w<=a)y=0;else{for(g=f[s][s+1],y=Math.sqrt(w),g>=0&&(y=-y),M=g*y-w,f[s][s+1]=g-y,u=l;u<m;u++)d[u]=f[s][u]/M;for(u=l;u<h;u++){for(w=0,c=l;c<m;c++)w+=f[u][c]*f[s][c];for(c=l;c<m;c++)f[u][c]+=w*d[c]}}x=Math.abs(p[s])+Math.abs(d[s]),x>b&&(b=x)}for(s=m-1;s!=-1;s+=-1){if(0!=y){for(M=y*f[s][s+1],u=l;u<m;u++)v[u][s]=f[s][u]/M;for(u=l;u<m;u++){for(w=0,c=l;c<m;c++)w+=f[s][c]*v[c][u];for(c=l;c<m;c++)v[c][u]+=w*v[c][s]}}for(u=l;u<m;u++)v[s][u]=0,v[u][s]=0;v[s][s]=1,y=d[s],l=s}for(s=m-1;s!=-1;s+=-1){for(l=s+1,y=p[s],u=l;u<m;u++)f[s][u]=0;if(0!=y){for(M=f[s][s]*y,u=l;u<m;u++){for(w=0,c=l;c<h;c++)w+=f[c][s]*f[c][u];for(g=w/M,c=s;c<h;c++)f[c][u]+=g*f[c][s]}for(u=s;u<h;u++)f[u][s]=f[u][s]/y}else for(u=s;u<h;u++)f[u][s]=0;f[s][s]+=1}for(n*=b,c=m-1;c!=-1;c+=-1)for(var D=0;D<i;D++){var I=!1;for(l=c;l!=-1;l+=-1){if(Math.abs(d[l])<=n){I=!0;break}if(Math.abs(p[l-1])<=n)break}if(!I){o=0,w=1;var F=l-1;for(s=l;s<c+1&&(g=w*d[s],d[s]=o*d[s],!(Math.abs(g)<=n));s++)for(y=p[s],M=t(g,y),p[s]=M,o=y/M,w=-g/M,u=0;u<h;u++)x=f[u][F],S=f[u][s],f[u][F]=x*o+S*w,f[u][s]=-x*w+S*o}if(S=p[c],l==c){if(S<0)for(p[c]=-S,u=0;u<m;u++)v[u][c]=-v[u][c];break}if(D>=i-1)throw"Error: no convergence.";for(b=p[l],x=p[c-1],y=d[c-1],M=d[c],g=((x-S)*(x+S)+(y-M)*(y+M))/(2*M*x),y=t(g,1),g=g<0?((b-S)*(b+S)+M*(x/(g-y)-M))/b:((b-S)*(b+S)+M*(x/(g+y)-M))/b,o=1,w=1,s=l+1;s<c+1;s++){for(y=d[s],x=p[s],M=w*y,y=o*y,S=t(g,M),d[s-1]=S,o=g/S,w=M/S,g=b*o+y*w,y=-b*w+y*o,M=x*w,x*=o,u=0;u<m;u++)b=v[u][s-1],S=v[u][s],v[u][s-1]=b*o+S*w,v[u][s]=-b*w+S*o;for(S=t(g,M),p[s-1]=S,o=g/S,w=M/S,g=o*y+w*x,b=-w*y+o*x,u=0;u<h;u++)x=f[u][s-1],S=f[u][s],f[u][s-1]=x*o+S*w,f[u][s]=-x*w+S*o}d[l]=0,d[c]=g,p[c]=b}for(s=0;s<p.length;s++)p[s]<n&&(p[s]=0);for(s=0;s<m;s++)for(u=s-1;u>=0;u--)if(p[u]<p[s]){for(o=p[u],p[u]=p[s],p[s]=o,c=0;c<f.length;c++)r=f[c][s],f[c][s]=f[c][u],f[c][u]=r;for(c=0;c<v.length;c++)r=v[c][s],v[c][s]=v[c][u],v[c][u]=r;s=u}return{U:f,S:p,V:v}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],64:[function(e,t,r){"use strict";function n(e,t){for(var r=new Array(e.length-1),n=1;n<e.length;++n)for(var a=r[n-1]=new Array(e.length-1),i=0,o=0;i<e.length;++i)i!==t&&(a[o++]=e[n][i]);return r}function a(e){for(var t=new Array(e),r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n)t[r][n]=["m",n,"[",e-r-1,"]"].join("")}return t}function i(e){return 1&e?"-":""}function o(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",o(e.slice(0,t)),",",o(e.slice(t)),")"].join("")}function s(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],r=0;r<e.length;++r)t.push(["scale(",o(s(n(e,r))),",",i(r),e[0][r],")"].join(""));return t}function u(e){for(var t=[],r=[],i=a(e),u=[],c=0;c<e;++c)0===(1&c)?t.push.apply(t,s(n(i,c))):r.push.apply(r,s(n(i,c))),u.push("m"+c);var l=o(t),p=o(r),v="orientation"+e+"Exact",g=["function ",v,"(",u.join(),"){var p=",l,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",v].join(""),y=new Function("sum","prod","scale","sub",g);return y(h,f,m,d)}function c(e){var t=x[e.length];return t||(t=x[e.length]=u(e.length)),t.apply(void 0,e)}function l(){for(;x.length<=p;)x.push(u(x.length));for(var e=[],r=["slow"],n=0;n<=p;++n)e.push("a"+n),r.push("o"+n);for(var a=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],n=2;n<=p;++n)a.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");");a.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),r.push(a.join(""));var i=Function.apply(void 0,r);t.exports=i.apply(void 0,[c].concat(x));for(var n=0;n<=p;++n)t.exports[n]=x[n]}var f=e("two-product"),h=e("robust-sum"),m=e("robust-scale"),d=e("robust-subtract"),p=5,v=1.1102230246251565e-16,g=(3+16*v)*v,y=(7+56*v)*v,M=u(3),b=u(4),x=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,r){var n,a=(e[1]-r[1])*(t[0]-r[0]),i=(e[0]-r[0])*(t[1]-r[1]),o=a-i;if(a>0){if(i<=0)return o;n=a+i}else{if(!(a<0))return o;if(i>=0)return o;n=-(a+i)}var s=g*n;return o>=s||o<=-s?o:M(e,t,r)},function(e,t,r,n){var a=e[0]-n[0],i=t[0]-n[0],o=r[0]-n[0],s=e[1]-n[1],u=t[1]-n[1],c=r[1]-n[1],l=e[2]-n[2],f=t[2]-n[2],h=r[2]-n[2],m=i*c,d=o*u,p=o*s,v=a*c,g=a*u,M=i*s,x=l*(m-d)+f*(p-v)+h*(g-M),S=(Math.abs(m)+Math.abs(d))*Math.abs(l)+(Math.abs(p)+Math.abs(v))*Math.abs(f)+(Math.abs(g)+Math.abs(M))*Math.abs(h),w=y*S;return x>w||-x>w?x:b(e,t,r,n)}];l()},{"robust-scale":65,"robust-subtract":66,"robust-sum":67,"two-product":82}],65:[function(e,t,r){"use strict";function n(e,t){var r=e.length;if(1===r){var n=a(e[0],t);return n[0]?n:[n[1]]}var o=new Array(2*r),s=[.1,.1],u=[.1,.1],c=0;a(e[0],t,s),s[0]&&(o[c++]=s[0]);for(var l=1;l<r;++l){a(e[l],t,u);var f=s[1];i(f,u[0],s),s[0]&&(o[c++]=s[0]);var h=u[1],m=s[1],d=h+m,p=d-h,v=m-p;s[1]=d,v&&(o[c++]=v)}return s[1]&&(o[c++]=s[1]),0===c&&(o[c++]=0),o.length=c,o}var a=e("two-product"),i=e("two-sum");t.exports=n},{"two-product":82,"two-sum":83}],66:[function(e,t,r){"use strict";function n(e,t){var r=e+t,n=r-e,a=r-n,i=t-n,o=e-a,s=o+i;return s?[s,r]:[r]}function a(e,t){var r=0|e.length,a=0|t.length;if(1===r&&1===a)return n(e[0],-t[0]);var i,o,s=r+a,u=new Array(s),c=0,l=0,f=0,h=Math.abs,m=e[l],d=h(m),p=-t[f],v=h(p);d<v?(o=m,l+=1,l<r&&(m=e[l],d=h(m))):(o=p,f+=1,f<a&&(p=-t[f],v=h(p))),l<r&&d<v||f>=a?(i=m,l+=1,l<r&&(m=e[l],d=h(m))):(i=p,f+=1,f<a&&(p=-t[f],v=h(p)));for(var g,y,M,b,x,S=i+o,w=S-i,D=o-w,I=D,F=S;l<r&&f<a;)d<v?(i=m,l+=1,l<r&&(m=e[l],d=h(m))):(i=p,f+=1,f<a&&(p=-t[f],v=h(p))),o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,y=g-F,M=g-y,b=S-y,x=F-M,I=x+b,F=g;for(;l<r;)i=m,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,y=g-F,M=g-y,b=S-y,x=F-M,I=x+b,F=g,l+=1,l<r&&(m=e[l]);for(;f<a;)i=p,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,y=g-F,M=g-y,b=S-y,x=F-M,I=x+b,F=g,f+=1,f<a&&(p=-t[f]);return I&&(u[c++]=I),F&&(u[c++]=F),c||(u[c++]=0),u.length=c,u}t.exports=a},{}],67:[function(e,t,r){"use strict";function n(e,t){var r=e+t,n=r-e,a=r-n,i=t-n,o=e-a,s=o+i;return s?[s,r]:[r]}function a(e,t){var r=0|e.length,a=0|t.length;if(1===r&&1===a)return n(e[0],t[0]);var i,o,s=r+a,u=new Array(s),c=0,l=0,f=0,h=Math.abs,m=e[l],d=h(m),p=t[f],v=h(p);d<v?(o=m,l+=1,l<r&&(m=e[l],d=h(m))):(o=p,f+=1,f<a&&(p=t[f],v=h(p))),l<r&&d<v||f>=a?(i=m,l+=1,l<r&&(m=e[l],d=h(m))):(i=p,f+=1,f<a&&(p=t[f],v=h(p)));for(var g,y,M,b,x,S=i+o,w=S-i,D=o-w,I=D,F=S;l<r&&f<a;)d<v?(i=m,l+=1,l<r&&(m=e[l],d=h(m))):(i=p,f+=1,f<a&&(p=t[f],v=h(p))),o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,y=g-F,M=g-y,b=S-y,x=F-M,I=x+b,F=g;for(;l<r;)i=m,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,y=g-F,M=g-y,b=S-y,x=F-M,I=x+b,F=g,l+=1,l<r&&(m=e[l]);for(;f<a;)i=p,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,y=g-F,M=g-y,b=S-y,x=F-M,I=x+b,F=g,f+=1,f<a&&(p=t[f]);return I&&(u[c++]=I),F&&(u[c++]=F),c||(u[c++]=0),u.length=c,u}t.exports=a},{}],68:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=new Promise(function(t,r){var n=e.inputSamples,a=e.inputSampleRate,i="undefined"!=typeof e.inputDelay?e.inputDelay:0,s="undefined"!=typeof e.outputSampleRate?e.outputSampleRate:a;if(a===s&&0===i)t(new Float32Array(n));else try{var u=Math.ceil(n.length*s/a),c=new window.OfflineAudioContext(1,u,s),l=c.createBuffer(1,n.length,a),f=1,h=new o.default(a,f);h.setDelay(i/a),l.getChannelData(0).set(h.process(n));var m=c.createBufferSource();m.buffer=l,m.connect(c.destination),m.start(),c.oncomplete=function(e){var r=e.renderedBuffer.getChannelData(0);t(r)},c.startRendering()}catch(e){r(new Error("Unable to re-sample Float32Array. "+e.message))}});return t}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleFloat32Array=a;var i=e("fractional-delay"),o=n(i);r.default={resampleFloat32Array:a}},{"fractional-delay":45}],69:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=t.x-e.x,n=t.y-e.y,a=t.z-e.z;return r*r+n*n+a*a}function i(e,t){return Math.sqrt(this.distanceSquared(e,t))}Object.defineProperty(r,"__esModule",{value:!0}),r.tree=void 0,r.distanceSquared=a,r.distance=i;var o=e("kd.tree"),s=n(o);r.tree=s.default,r.default={distance:i,distanceSquared:a,tree:s.default}},{"kd.tree":61}],70:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=0-n,e[1]=a,e[2]=0-r,e}function i(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=0-a,e[1]=0-r,e[2]=n,e}function o(e,t){var r=t[0],n=t[1],a=t[2],i=r*r+n*n;return e[0]=(x.default.atan2(n,r)+360)%360,e[1]=x.default.atan2(a,Math.sqrt(i)),e[2]=Math.sqrt(i+a*a),e}function s(e,t){var r=t[0],n=t[1],a=t[2],i=x.default.cos(n);return e[0]=a*i*x.default.cos(r),e[1]=a*i*x.default.sin(r),e[2]=a*x.default.sin(n),e}function u(e,t){var r=t[0],n=t[1],a=t[2],i=x.default.cos(n);return e[0]=0-a*i*x.default.sin(r),e[1]=a*x.default.sin(n),e[2]=0-a*i*x.default.cos(r),e}function c(e,t){var r=0-t[2],n=0-t[0],a=t[1],i=r*r+n*n;return e[0]=(x.default.atan2(n,r)+360)%360,e[1]=x.default.atan2(a,Math.sqrt(i)),e[2]=Math.sqrt(i+a*a),e}function l(e,t,r){switch(r){case"sofaCartesian":e[0]=t[0],e[1]=t[1],e[2]=t[2];break;case"sofaSpherical":s(e,t);break;default:throw new Error("Bad coordinate system")}return e}function f(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=r,e[1]=a,e[2]=0-n,e}function h(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=r,e[1]=0-a,e[2]=n,e}function m(e,t){var r=t[0],n=t[1],a=t[2],i=r*r+n*n;return e[0]=x.default.atan2(r,n),e[1]=x.default.atan2(a,Math.sqrt(i)),e[2]=Math.sqrt(i+a*a),e}function d(e,t){var r=t[0],n=t[1],a=t[2],i=x.default.cos(n);return e[0]=a*i*x.default.sin(r),e[1]=a*i*x.default.cos(r),e[2]=a*x.default.sin(n),e}function p(e,t){var r=t[0],n=t[1],a=t[2],i=x.default.cos(n);return e[0]=a*i*x.default.sin(r),e[1]=a*x.default.sin(n),e[2]=0-a*i*x.default.cos(r),e}function v(e,t){var r=t[0],n=0-t[2],a=t[1],i=r*r+n*n;return e[0]=x.default.atan2(r,n),e[1]=x.default.atan2(a,Math.sqrt(i)),e[2]=Math.sqrt(i+a*a),e}function g(e){var t=void 0;if("sofaCartesian"===e||"spat4Cartesian"===e||"gl"===e)t="cartesian";else{if("sofaSpherical"!==e&&"spat4Spherical"!==e)throw new Error("Unknown coordinate system type "+e);t="spherical"}return t}function y(e,t,r){switch(r){case"gl":e[0]=t[0],e[1]=t[1],e[2]=t[2];break;case"sofaCartesian":a(e,t);break;case"sofaSpherical":u(e,t);break;case"spat4Cartesian":f(e,t);break;case"spat4Spherical":p(e,t);break;default:throw new Error("Bad coordinate system")}return e}function M(e,t,r){switch(r){case"gl":e[0]=t[0],e[1]=t[1],e[2]=t[2];break;case"sofaCartesian":i(e,t);break;case"sofaSpherical":c(e,t);break;case"spat4Cartesian":h(e,t);break;case"spat4Spherical":v(e,t);break;default:throw new Error("Bad coordinate system")}return e}Object.defineProperty(r,"__esModule",{value:!0}),r.sofaCartesianToGl=a,r.glToSofaCartesian=i,r.sofaCartesianToSofaSpherical=o,r.sofaSphericalToSofaCartesian=s,r.sofaSphericalToGl=u,r.glToSofaSpherical=c,r.sofaToSofaCartesian=l,r.spat4CartesianToGl=f,r.glToSpat4Cartesian=h,r.spat4CartesianToSpat4Spherical=m,r.spat4SphericalToSpat4Cartesian=d,r.spat4SphericalToGl=p,r.glToSpat4Spherical=v,r.systemType=g,r.systemToGl=y,r.glToSystem=M;var b=e("./degree"),x=n(b);r.default={glToSofaCartesian:i,glToSofaSpherical:c,glToSpat4Cartesian:h,glToSpat4Spherical:v,glToSystem:M,sofaCartesianToGl:a,sofaCartesianToSofaSpherical:o,sofaSphericalToGl:u,sofaSphericalToSofaCartesian:s,sofaToSofaCartesian:l,spat4CartesianToGl:f,spat4CartesianToSpat4Spherical:m,spat4SphericalToGl:p,spat4SphericalToSpat4Cartesian:d,systemToGl:y,systemType:g}},{"./degree":71}],71:[function(e,t,r){"use strict";function n(e){return e*u}function a(e){return e*c}function i(e){return Math.cos(e*u)}function o(e){return Math.sin(e*u)}function s(e,t){return Math.atan2(e,t)*c}Object.defineProperty(r,"__esModule",{value:!0}),r.toRadian=n,r.fromRadian=a,r.cos=i,r.sin=o,r.atan2=s;var u=r.toRadianFactor=Math.PI/180,c=r.fromRadianFactor=1/u;r.default={atan2:s,cos:i,fromRadian:a,fromRadianFactor:c,sin:o,toRadian:n,toRadianFactor:u}},{}],72:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.ServerDataBase=r.HrtfSet=void 0;var a=e("./sofa/HrtfSet"),i=n(a),o=e("./sofa/ServerDataBase"),s=n(o);r.HrtfSet=i.default,r.ServerDataBase=s.default,r.default={HrtfSet:i.default,ServerDataBase:s.default}},{"./sofa/HrtfSet":74,"./sofa/ServerDataBase":75}],73:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.version=r.name=r.license=r.description=void 0;var a=e("../package.json"),i=n(a),o=i.default.description;r.description=o;var s=i.default.license;r.license=s;var u=i.default.name;r.name=u;var c=i.default.version;r.version=c,r.default={description:o,license:s,name:u,version:c}},{"../package.json":79}],74:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.HrtfSet=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("gl-matrix"),u=n(s),c=e("../info"),l=n(c),f=e("./parseDataSet"),h=e("./parseSofa"),m=e("../geometry/coordinates"),d=n(m),p=e("../geometry/KdTree"),v=n(p),g=e("../audio/utilities"),y=r.HrtfSet=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),this._audioContext=t.audioContext,this._ready=!1,this.coordinateSystem=t.coordinateSystem,this.filterCoordinateSystem=t.filterCoordinateSystem,this.filterPositions=t.filterPositions,this.filterAfterLoad=t.filterAfterLoad}return o(e,[{key:"applyFilterPositions",value:function(){var e=this,t=this._filterPositions.map(function(t){return e._kdt.nearest({x:t[0],y:t[1],z:t[2]},1).pop()[0]});t=[].concat(a(new Set(t))),this._kdt=v.default.tree.createKdTree(t,v.default.distanceSquared,["x","y","z"])}},{key:"load",value:function(e){var t=this,r=e.split(".").pop(),n="sofa"===r?e+".json":e,a=void 0,i="undefined"!=typeof this._filterPositions&&!this.filterAfterLoad&&"sofa"===r;return a=i?Promise.all([this._loadMetaAndPositions(e),this._loadDataSet(e)]).then(function(r){var n=r[0],a=r[1];return t._loadSofaPartial(e,n,a).then(function(){return t._ready=!0,t})}).catch(function(){return t._loadSofaFull(n).then(function(){return t.applyFilterPositions(),t._ready=!0,t})}):this._loadSofaFull(n).then(function(){return"undefined"!=typeof t._filterPositions&&t.filterAfterLoad&&t.applyFilterPositions(),t._ready=!0,t})}},{key:"export",value:function(){var e=this,t=void 0,r=d.default.systemType(this.filterCoordinateSystem);switch(r){case"cartesian":t=this._sofaSourcePosition.map(function(e){return d.default.glToSofaCartesian([],e)});break;case"spherical":t=this._sofaSourcePosition.map(function(e){return d.default.glToSofaSpherical([],e)});break;default:throw new Error("Bad source position type "+r+" for export.")}var n=this._sofaSourcePosition.map(function(t){for(var r=e._kdt.nearest({x:t[0],y:t[1],z:t[2]},1).pop()[0].fir,n=[],i=0;i<r.numberOfChannels;++i)n.push([].concat(a(r.getChannelData(i))));return n});return(0,h.stringifySofa)({name:this._sofaName,metaData:this._sofaMetaData,ListenerPosition:[0,0,0],ListenerPositionType:"cartesian",ListenerUp:[0,0,1],ListenerUpType:"cartesian",ListenerView:[1,0,0],ListenerViewType:"cartesian",SourcePositionType:r,SourcePosition:t,DataSamplingRate:this._audioContext.sampleRate,DataDelay:this._sofaDelay,DataIR:n,RoomVolume:this._sofaRoomVolume})}},{key:"nearest",value:function e(t){var r=d.default.systemToGl([],t,this.coordinateSystem),e=this._kdt.nearest({x:r[0],y:r[1],z:r[2]},1).pop(),n=e[0];return d.default.glToSystem(r,[n.x,n.y,n.z],this.coordinateSystem),{distance:e[1],fir:n.fir,index:n.index,position:r}}},{key:"nearestFir",value:function(e){return this.nearest(e).fir}},{key:"_createKdTree",value:function(e){var t=this,r=e.map(function(e){var r=e[2],n=t._audioContext.createBuffer(r.length,r[0].length,t._audioContext.sampleRate);
return r.forEach(function(e,t){n.getChannelData(t).set(e)}),{index:e[0],x:e[1][0],y:e[1][1],z:e[1][2],fir:n}});return this._sofaSourcePosition=r.map(function(e){return[e.x,e.y,e.z]}),this._kdt=v.default.tree.createKdTree(r,v.default.distanceSquared,["x","y","z"]),this}},{key:"_generateIndicesPositionsFirs",value:function(e,t,r,n){var a=this,i=r.map(function(r,i){var o=r.length;if(2!==o)throw new Error("Bad number of channels for IR index "+e[i]+(" ("+o+" instead of 2)"));if(2!==n[0].length)throw new Error("Bad delay format for IR index "+e[i]+(" (first element in Data.Delay is "+n[0])+" instead of [[delayL, delayR]] )");var s="undefined"!=typeof n[i]?n[i]:n[0],u=r.map(function(t,r){if(s[r]<0)throw new Error("Negative delay detected (not handled at the moment): delay index "+e[i]+(" channel "+r));return(0,g.resampleFloat32Array)({inputSamples:t,inputDelay:s[r],inputSampleRate:a._sofaSampleRate,outputSampleRate:a._audioContext.sampleRate})});return Promise.all(u).then(function(r){return[e[i],t[i],r]}).catch(function(e){throw new Error("Unable to re-sample impulse response "+i+". "+e.message)})});return Promise.all(i)}},{key:"_loadDataSet",value:function(e){var t=new Promise(function(t,r){var n=e+".dds",a=new window.XMLHttpRequest;a.open("GET",n),a.onerror=function(){r(new Error("Unable to GET "+n+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();try{var e=(0,f.parseDataSet)(a.response);t(e)}catch(e){r(new Error("Unable to parse "+n+". "+e.message))}},a.send()});return t}},{key:"_loadMetaAndPositions",value:function(e){var t=this,r=new Promise(function(r,n){var i=e+".json?ListenerPosition,ListenerUp,ListenerView,SourcePosition,Data.Delay,Data.SamplingRate,EmitterPosition,ReceiverPosition,RoomVolume",o=new window.XMLHttpRequest;o.open("GET",i),o.onerror=function(){n(new Error("Unable to GET "+i+", status "+o.status+" "+o.responseText))},o.onload=function(){if(o.status<200||o.status>=300)return void o.onerror();try{!function(){var n=(0,h.parseSofa)(o.response);t._setMetaData(n,e);var i=t._sourcePositionsToGl(n),s=i.map(function(e,t){return{x:e[0],y:e[1],z:e[2],index:t}}),u=v.default.tree.createKdTree(s,v.default.distanceSquared,["x","y","z"]),c=t._filterPositions.map(function(e){return u.nearest({x:e[0],y:e[1],z:e[2]},1).pop()[0].index});c=[].concat(a(new Set(c))),t._sofaUrl=e,r(c)}()}catch(e){n(new Error("Unable to parse "+i+". "+e.message))}},o.send()});return r}},{key:"_loadSofaFull",value:function(e){var t=this,r=new Promise(function(r,n){var a=new window.XMLHttpRequest;a.open("GET",e),a.onerror=function(){n(new Error("Unable to GET "+e+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();try{var i=(0,h.parseSofa)(a.response);t._setMetaData(i,e);var o=t._sourcePositionsToGl(i);t._generateIndicesPositionsFirs(o.map(function(e,t){return t}),o,i["Data.IR"].data,i["Data.Delay"].data).then(function(n){t._createKdTree(n),t._sofaUrl=e,r(t)})}catch(t){n(new Error("Unable to parse "+e+". "+t.message))}},a.send()});return r}},{key:"_loadSofaPartial",value:function(e,t,r){var n=this,a=t.map(function(t){var a=new Promise(function(a,i){var o=e+".json?"+("SourcePosition["+t+"][0:1:"+(r.SourcePosition.C-1)+"],")+("Data.IR["+t+"][0:1:"+(r["Data.IR"].R-1)+"]")+("[0:1:"+(r["Data.IR"].N-1)+"]"),s=new window.XMLHttpRequest;s.open("GET",o),s.onerror=function(){i(new Error("Unable to GET "+o+", status "+s.status+" "+s.responseText))},s.onload=function(){(s.status<200||s.status>=300)&&s.onerror();try{var e=(0,h.parseSofa)(s.response),r=n._sourcePositionsToGl(e);n._generateIndicesPositionsFirs([t],r,e["Data.IR"].data,e["Data.Delay"].data).then(function(e){a(e[0])})}catch(e){i(new Error("Unable to parse "+o+". "+e.message))}},s.send()});return a});return Promise.all(a).then(function(e){return n._createKdTree(e),n})}},{key:"_setMetaData",value:function(e,t){if("undefined"!=typeof e.metaData.DataType&&"FIR"!==e.metaData.DataType)throw new Error("According to meta-data, SOFA data type is not FIR");var r=(new Date).toISOString();this._sofaName="undefined"!=typeof e.name?""+e.name:"HRTF.sofa",this._sofaMetaData="undefined"!=typeof e.metaData?e.metaData:{},"undefined"!=typeof t&&(this._sofaMetaData.OriginalUrl=t),this._sofaMetaData.Converter="Ircam "+l.default.name+" "+l.default.version+" javascript API ",this._sofaMetaData.DateConverted=r,this._sofaSampleRate="undefined"!=typeof e["Data.SamplingRate"]?e["Data.SamplingRate"].data[0]:48e3,this._sofaSampleRate!==this._audioContext.sampleRate&&(this._sofaMetaData.OriginalSampleRate=this._sofaSampleRate),this._sofaDelay="undefined"!=typeof e["Data.Delay"]?e["Data.Delay"].data:[0,0],this._sofaRoomVolume="undefined"!=typeof e.RoomVolume?e.RoomVolume.data[0]:void 0;var n=d.default.sofaToSofaCartesian([],e.ListenerPosition.data[0],(0,h.conformSofaCoordinateSystem)(e.ListenerPosition.Type||"cartesian")),a=d.default.sofaToSofaCartesian([],e.ListenerView.data[0],(0,h.conformSofaCoordinateSystem)(e.ListenerView.Type||"cartesian")),i=d.default.sofaToSofaCartesian([],e.ListenerUp.data[0],(0,h.conformSofaCoordinateSystem)(e.ListenerUp.Type||"cartesian"));this._sofaToGl=u.default.mat4.lookAt([],n,a,i)}},{key:"_sourcePositionsToGl",value:function(e){var t=this,r=e.SourcePosition.data,n="undefined"!=typeof e.SourcePosition.Type?e.SourcePosition.Type:"spherical";switch(n){case"cartesian":r.forEach(function(e){u.default.vec3.transformMat4(e,e,t._sofaToGl)});break;case"spherical":r.forEach(function(e){d.default.sofaSphericalToSofaCartesian(e,e),u.default.vec3.transformMat4(e,e,t._sofaToGl)});break;default:throw new Error("Bad source position type")}return r}},{key:"coordinateSystem",set:function(e){this._coordinateSystem="undefined"!=typeof e?e:"gl"},get:function(){return this._coordinateSystem}},{key:"filterCoordinateSystem",set:function(e){this._filterCoordinateSystem="undefined"!=typeof e?e:this.coordinateSystem},get:function(){return this._filterCoordinateSystem}},{key:"filterPositions",set:function(e){if("undefined"==typeof e)this._filterPositions=void 0;else switch(this.filterCoordinateSystem){case"gl":this._filterPositions=e.map(function(e){return e.slice(0)});break;case"sofaCartesian":this._filterPositions=e.map(function(e){return d.default.sofaCartesianToGl([],e)});break;case"sofaSpherical":this._filterPositions=e.map(function(e){return d.default.sofaSphericalToGl([],e)});break;default:throw new Error("Bad filter coordinate system")}},get:function(){var e=void 0;if("undefined"!=typeof this._filterPositions)switch(this.filterCoordinateSystem){case"gl":e=this._filterPositions.map(function(e){return e.slice(0)});break;case"sofaCartesian":e=this._filterPositions.map(function(e){return d.default.glToSofaCartesian([],e)});break;case"sofaSpherical":e=this._filterPositions.map(function(e){return d.default.glToSofaSpherical([],e)});break;default:throw new Error("Bad filter coordinate system")}return e}},{key:"filterAfterLoad",set:function(e){this._filterAfterLoad="undefined"!=typeof e&&e},get:function(){return this._filterAfterLoad}},{key:"isReady",get:function(){return this._ready}},{key:"sofaName",get:function(){return this._sofaName}},{key:"sofaUrl",get:function(){return this._sofaUrl}},{key:"sofaSampleRate",get:function(){return this._sofaSampleRate}},{key:"sofaMetaData",get:function(){return this._sofaMetaData}}]),e}();r.default=y},{"../audio/utilities":68,"../geometry/KdTree":69,"../geometry/coordinates":70,"../info":73,"./parseDataSet":76,"./parseSofa":77,"gl-matrix":50}],75:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ServerDataBase=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./parseXml"),s=n(o),u=e("./parseDataSet"),c=r.ServerDataBase=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(a(this,e),this._server=t.serverUrl,"undefined"==typeof this._server){var r="https:"===window.location.protocol?"https:":"http:";this._server=r+"//bili2.ircam.fr"}this._catalogue={},this._urls=[]}return i(e,[{key:"loadCatalogue",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?this._server+"/catalog.xml":arguments[0],r=arguments.length<=1||void 0===arguments[1]?this._catalogue:arguments[1],n=new Promise(function(n,a){var i=new window.XMLHttpRequest;i.open("GET",t),i.onerror=function(){a(new Error("Unable to GET "+t+", status "+i.status+" "+i.responseText))},i.onload=function(){if(i.status<200||i.status>=300)return void i.onerror();var o=(0,s.default)(i.response),u=o.querySelector("dataset"),c=o.querySelectorAll("dataset > catalogRef");if(0===c.length){r.urls=[];for(var l=o.querySelectorAll("dataset > dataset"),f=0;f<l.length;++f){var h=e._server+u.getAttribute("name")+"/"+l[f].getAttribute("name");e._urls.push(h),r.urls.push(h)}n(t)}else{for(var m=[],d=0;d<c.length;++d){var p=c[d].getAttribute("name"),v=e._server+u.getAttribute("name")+"/"+c[d].getAttribute("xlink:href");r[p]={},m.push(e.loadCatalogue(v,r[p]))}Promise.all(m).then(function(){e._urls.sort(),n(t)}).catch(function(e){a(e)})}},i.send()});return n}},{key:"getUrls",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=[e.convention,e.dataBase,e.equalisation,e.sampleRate,e.sosOrder],r="number"==typeof e.freePattern?e.freePattern.toString():e.freePattern,n=t.reduce(function(e,t){return e+"/"+("undefined"!=typeof t?"[^/]*(?:"+t+")[^/]*":"[^/]*")},""),a=new RegExp(n,"i"),i=this._urls.filter(function(e){return a.test(e)});if("undefined"!=typeof r){var o=r.split(/\s+/);o.forEach(function(e){a=new RegExp(e,"i"),i=i.filter(function(e){return a.test(e)})})}return i}},{key:"getDataSetDefinitions",value:function(e){var t=new Promise(function(t,r){var n=e+".dds",a=new window.XMLHttpRequest;a.open("GET",n),a.onerror=function(){r(new Error("Unable to GET "+n+", status "+a.status+" "+a.responseText))},a.onload=function(){return a.status<200||a.status>=300?void a.onerror():void t((0,u.parseDataSet)(a.response))},a.send()});return t}},{key:"getSourcePositions",value:function(e){var t=new Promise(function(t,r){var n=e+".json?SourcePosition",a=new window.XMLHttpRequest;a.open("GET",n),a.onerror=function(){r(new Error("Unable to GET "+n+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();try{var e=JSON.parse(a.response);if("SourcePosition"!==e.leaves[0].name)throw new Error("SourcePosition not found");t(e.leaves[0].data)}catch(e){r(new Error("Unable to parse response from "+n+". "+e.message))}},a.send()});return t}}]),e}();r.default=c},{"./parseDataSet":76,"./parseXml":78}],76:[function(e,t,r){"use strict";function n(e){var t=[],r=e.match(s);return null!==r&&r.forEach(function(e){var r=u.exec(e);null!==r&&r.length>2&&t.push([r[1],Number(r[2])])}),t}function a(e){var t=[],r=e.match(l);return null!==r&&r.forEach(function(e){var r=f.exec(e);null!==r&&r.length>3&&!function(){var e=[];e[0]=r[2],e[1]={},e[1].type=r[1],n(r[3]).forEach(function(t){e[1][t[0]]=t[1]}),t.push(e)}()}),t}function i(e){var t={},r=m.exec(e);return null!==r&&r.length>1&&a(r[1]).forEach(function(e){t[e[0]]=e[1]}),t}Object.defineProperty(r,"__esModule",{value:!0}),r._parseDimension=n,r._parseDefinition=a,r.parseDataSet=i;var o="\\[\\s*(\\w+)\\s*=\\s*(\\d+)\\s*\\]",s=new RegExp(o,"g"),u=new RegExp(o),c="\\s*(\\w+)\\s*([\\w.]+)\\s*((?:\\[[^\\]]+\\]\\s*)+);\\s*",l=new RegExp(c,"g"),f=new RegExp(c),h="\\s*Dataset\\s*\\{\\s*((?:[^;]+;\\s*)*)\\s*\\}\\s*[\\w.]+\\s*;\\s*",m=new RegExp(h);r.default=i},{}],77:[function(e,t,r){"use strict";function n(e){try{var t=function(){var t=JSON.parse(e),r={};if(r.name=t.name,"undefined"!=typeof t.attributes){r.metaData={};var n=t.attributes.find(function(e){return"NC_GLOBAL"===e.name});"undefined"!=typeof n&&n.attributes.forEach(function(e){r.metaData[e.name]=e.value[0]})}if("undefined"!=typeof t.leaves){var a=t.leaves;a.forEach(function(e){r[e.name]={},e.attributes.forEach(function(t){r[e.name][t.name]=t.value[0]}),r[e.name].shape=e.shape,r[e.name].data=e.data})}return{v:r}}();if("object"===("undefined"==typeof t?"undefined":o(t)))return t.v}catch(e){throw new Error("Unable to parse SOFA string. "+e.message)}}function a(e){var t={};if("undefined"!=typeof e.name&&(t.name=e.name),"undefined"!=typeof e.metaData){t.attributes=[];var r={name:"NC_GLOBAL",attributes:[]};for(var n in e.metaData)e.metaData.hasOwnProperty(n)&&r.attributes.push({name:n,value:[e.metaData[n]]});t.attributes.push(r)}var a="Float64",i=void 0;if(t.leaves=[],[["ListenerPosition","ListenerPositionType"],["ListenerUp","ListenerUpType"],["ListenerView","ListenerViewType"]].forEach(function(r){var n=r[0],o=e[n],s=e[r[1]];if("undefined"!=typeof o){switch(s){case"cartesian":i=[{name:"Type",value:["cartesian"]},{name:"Units",value:["metre, metre, metre"]}];break;case"spherical":i=[{name:"Type",value:["spherical"]},{name:"Units",value:["degree, degree, metre"]}];break;default:throw new Error("Unknown coordinate system type "+(s+" for "+o))}t.leaves.push({name:n,type:a,attributes:i,shape:[1,3],data:[o]})}}),"undefined"!=typeof e.SourcePosition){switch(e.SourcePositionType){case"cartesian":i=[{name:"Type",value:["cartesian"]},{name:"Units",value:["metre, metre, metre"]}];break;case"spherical":i=[{name:"Type",value:["spherical"]},{name:"Units",value:["degree, degree, metre"]}];break;default:throw new Error("Unknown coordinate system type "+e.SourcePositionType)}t.leaves.push({name:"SourcePosition",type:a,attributes:i,shape:[e.SourcePosition.length,e.SourcePosition[0].length],data:e.SourcePosition})}if("undefined"==typeof e.DataSamplingRate)throw new Error("No data sampling-rate");if(t.leaves.push({name:"Data.SamplingRate",type:a,attributes:[{name:"Unit",value:"hertz"}],shape:[1],data:[e.DataSamplingRate]}),"undefined"!=typeof e.DataDelay&&t.leaves.push({name:"Data.Delay",type:a,attributes:[],shape:[1,e.DataDelay.length],data:e.DataDelay}),"undefined"==typeof e.DataIR)throw new Error("No data IR");return t.leaves.push({name:"Data.IR",type:a,attributes:[],shape:[e.DataIR.length,e.DataIR[0].length,e.DataIR[0][0].length],data:e.DataIR}),"undefined"!=typeof e.RoomVolume&&t.leaves.push({name:"RoomVolume",type:a,attributes:[{name:"Units",value:["cubic metre"]}],shape:[1],data:[e.RoomVolume]}),t.nodes=[],JSON.stringify(t)}function i(e){var t=void 0;switch(e){case"cartesian":t="sofaCartesian";break;case"spherical":t="sofaSpherical";break;default:throw new Error("Bad SOFA type "+e)}return t}Object.defineProperty(r,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};r.parseSofa=n,r.stringifySofa=a,r.conformSofaCoordinateSystem=i,r.default={parseSofa:n,conformSofaCoordinateSystem:i}},{}],78:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=r.parseXml=void 0;if("undefined"!=typeof window.DOMParser)r.parseXml=n=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")};else{if("undefined"==typeof window.ActiveXObject||!new window.ActiveXObject("Microsoft.XMLDOM"))throw new Error("No XML parser found");r.parseXml=n=function(e){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}}r.default=n},{}],79:[function(e,t,r){t.exports={_args:[[{raw:"serve-sofa-hrtf@git://github.com/Ircam-RnD/serveSofaHrir.git",scope:null,escapedName:"serve-sofa-hrtf",name:"serve-sofa-hrtf",rawSpec:"git://github.com/Ircam-RnD/serveSofaHrir.git",spec:"git://github.com/Ircam-RnD/serveSofaHrir.git",type:"hosted",hosted:{type:"github",ssh:"git@github.com:Ircam-RnD/serveSofaHrir.git",sshUrl:"git+ssh://git@github.com/Ircam-RnD/serveSofaHrir.git",httpsUrl:"git+https://github.com/Ircam-RnD/serveSofaHrir.git",gitUrl:"git://github.com/Ircam-RnD/serveSofaHrir.git",shortcut:"github:Ircam-RnD/serveSofaHrir",directUrl:"https://raw.githubusercontent.com/Ircam-RnD/serveSofaHrir/master/package.json"}},"/Users/davipoir/Projects/Cosima/JSAmbisonics"]],_from:"git://github.com/Ircam-RnD/serveSofaHrir.git",_id:"serve-sofa-hrir@0.4.2",_inCache:!0,_installable:!0,_location:"/serve-sofa-hrir",_phantomChildren:{},_requested:{raw:"serve-sofa-hrtf@git://github.com/Ircam-RnD/serveSofaHrir.git",scope:null,escapedName:"serve-sofa-hrtf",name:"serve-sofa-hrtf",rawSpec:"git://github.com/Ircam-RnD/serveSofaHrir.git",spec:"git://github.com/Ircam-RnD/serveSofaHrir.git",type:"hosted",hosted:{type:"github",ssh:"git@github.com:Ircam-RnD/serveSofaHrir.git",sshUrl:"git+ssh://git@github.com/Ircam-RnD/serveSofaHrir.git",httpsUrl:"git+https://github.com/Ircam-RnD/serveSofaHrir.git",gitUrl:"git://github.com/Ircam-RnD/serveSofaHrir.git",shortcut:"github:Ircam-RnD/serveSofaHrir",directUrl:"https://raw.githubusercontent.com/Ircam-RnD/serveSofaHrir/master/package.json"}},_requiredBy:[],_resolved:"git://github.com/Ircam-RnD/serveSofaHrir.git#4e7197ff87a8d73f8803429fcae90613faf01132",_shasum:"f59965c9516de98a7f30b844325cb58a6b0f179c",_shrinkwrap:null,_spec:"serve-sofa-hrtf@git://github.com/Ircam-RnD/serveSofaHrir.git",_where:"/Users/davipoir/Projects/Cosima/JSAmbisonics",authors:["Jean-Philippe.Lambert@ircam.fr","Arnau Juli <arnau.julia@gmail.com>","Samuel.Goldszmidt@ircam.fr","David.Poirier-Quinot@ircam.fr"],bugs:{url:"https://github.com/Ircam-RnD/serveSofaHrir/issues"},dependencies:{"fractional-delay":"git://github.com/Ircam-RnD/fractional-delay.git#gh-pages","gl-matrix":"^2.3.1","kd.tree":"github:akshaylive/node-kdt#39bc780704a324393bca68a17cf7bc71be8544c6"},description:"Utility to fetch and shape sofa formated HRIR from server",devDependencies:{"babel-cli":"^6.5.1","babel-eslint":"^4.1.8","babel-preset-es2015":"^6.5.0",babelify:"^7.2.0","blue-tape":"^0.1.11",browserify:"^12.0.2",esdoc:"^0.4.6",eslint:"^1.10.3","eslint-config-airbnb":"^1.0.2","eslint-plugin-html":"^1.4.0",jscs:"2.11.0","jscs-jsdoc":"^1.3.1",tape:"^4.4.0","tape-run":"^2.1.2",testling:"^1.7.1",watch:"^0.17.1"},engines:{node:"0.12 || 4",npm:">=1.0.0 <3.0.0"},exports:"serveSofaHrir",gitHead:"4e7197ff87a8d73f8803429fcae90613faf01132",homepage:"https://github.com/Ircam-RnD/serveSofaHrir#readme",license:"BSD-3-Clause",main:"./dist/",name:"serve-sofa-hrir",optionalDependencies:{},readme:"# Binaural #\n\nThis library permits to render sources in three-dimensional space with\nbinaural audio.\n\nThis library provides an access to a server, in order to load a set of\nHead-related transfer functions ([HRTF]). The set of filters applies to any\nnumber of sources, given their position, and a listener.\n\nThis library is compatible with the [Web Audio API]. The novelty of this\nlibrary is that it permits to use a custom [HRTF] dataset (see\n[T. Carpentier article]).\n\nIt is possible to use it without a server, with a direct URL to an [HRTF]\nset.\n\n## Documentation ##\n\nYou can consult the [API documentation] for the complete documentation.\n\n### BinauralPanner ###\n\nA `BinauralPanner` is a panner for use with the [Web Audio API]. It\nspatialises multiple audio sources, given a set of head-related transfer\nfunctions [HRTF]s, and a listener.\n\n### ServerDataBase ###\n\n**The public server that hosts a database of individual [HRTF]s is available\nfor beta-testers only and will open to public in 2016.**\n\nThe `ServerDataBase` retrieves a catalogue from a [SOFA] server. From the\ncatalogue, it get URLs matching optional filters: data-base, sample-rate,\nand any free pattern.\n\n### HRTF dataset ###\n\nYou can use any [HRTF] data-set that follows the [SOFA] standard, in JSON\nformat, using finite impulse responses (FIR). Second-order sections (SOS)\nare not supported, yet. See the [examples HRTF directory] for a few samples.\n\n### Coordinate system types ###\n\nSee the files in [src/geometry], for conversions:\n- OpenGL, [SOFA], and Spat4 (Ircam) conventions\n- cartesian and spherical coordinates\n- radian and degree angles\n\n\n## Examples ##\n\nPlease see the [examples directory] for complete code (on branch\n`gh-pages`), and the [examples online].\n\nSee also the [API documentation] for the complete options.\n\n### BinauralPanner ###\nGiven an audio element, and a global binaural module,\n\n```html\n<html>\n    <head>\n        <script src=\"../binaural.js\"></script>\n    </head>\n    <body>\n        <audio id=\"source\" src=\"./snd/breakbeat.wav\" controls loop></audio>\n    </body>\n</html>\n```\n\ncreate a source audio node,\n\n```js\nvar audioContext = new AudioContext();\nvar $mediaElement = document.querySelector('#source');\nvar player = audioContext.createMediaElementSource($mediaElement);\n```\n\ninstantiate a `BinauralPanner` and connect it.\n\n```js\nvar binauralPanner = new binaural.audio.BinauralPanner({\n    audioContext,\n    crossfadeDuration: 0.05, // in seconds\n    coordinateSystem: 'sofaSpherical', // [azimuth, elevation, distance]\n    sourceCount: 1,\n    sourcePositions: [ [0, 0, 1] ], // initial position\n});\nbinauralPanner.connectOutputs(audioContext.destination);\nbinauralPanner.connectInputByIndex(0, player);\n\n```\n\nLoad an HRTF set (this returns a [Promise]).\n\n```js\nbinauralPanner.loadHrtfSet(url)\n    .then(function () {\n        console.log('loaded');\n    })\n    .catch(function (error) {\n        console.log('Error while loading ' + url + error.message);\n    });\n```\n\nThen, any source can move:\n\n```js\n$azimuth.on(\"input\", function(event) {\n    // get current position\n    var position = binauralPanner.getSourcePositionByIndex(0);\n\n    // update azimuth\n    position[0] = event.target.value;\n    binauralPanner.setSourcePositionByIndex(0, position);\n\n    // update filters\n    window.requestAnimationFrame(function () {\n        binauralPanner.update();\n    });\n});\n```\n\nNote that a call to the `update` method actually updates the filters.\n\n### ServerDataBase ###\n\nInstantiate a `ServerDataBase`\n\n```js\nvar serverDataBase = new binaural.sofa.ServerDataBase();\n```\n\nand load the catalogue from the server. This returns a promise.\n\n```js\nvar catalogLoaded = serverDataBase.loadCatalogue();\n```\n\nFind URLs with `HRIR` convention, `COMPENSATED` equalisation, and a\nsample-rate matching the one of the audio context.\n\n```js\nvar urlsFound = catalogLoaded.then(function () {\n    var urls = serverDataBase.getUrls({\n        convention: 'HRIR',\n        equalisation: 'COMPENSATED',\n        sampleRate: audioContext.sampleRate,\n    });\n    return urls;\n})\n.catch(function(error) {\n    console.log('Error accessing HRTF server. ' + error.message);\n});\n```\n\nThen, a `BinauralPanner` can load one of these URLs.\n\n```js\nurlsFound.then(function(urls) {\n    binauralPanner.loadHrtfSet(urls[0])\n        .then(function () {\n            console.log('loaded');\n        })\n        .catch(function (error) {\n            console.log('Error while loading ' + url\n                + error.message);\n        });\n});\n```\n\n## Issues ##\n\n- re-sampling is broken on full set (Chrome 48 issue): too many parallel\n  audio contexts?\n- clicks on Firefox 44-45 (during update of `convolver.buffer`, because\n  `AudioContext.currentTime` does not advance)\n- ServerDataBase: avoid server with free pattern filter?\n\n## To do ##\n\n- attenuation with distance\n- dry/wet outputs for (shared) reverberation\n- support for infinite impulse responses, once [IIRFilterNode] is\n  implemented.\n\n## Developers ##\n\nThe source code is in the [src directory], in [ES2015] standard. `npm run\ncompile` with [Babel] to the [dist directory]. Note that there is a\n[.babelrc] file. `npm run bundle` runs the linters, the tests,\ngenerates the documentation, and compiles the code.\n\nCommit the source files to the branch `develop`, and update the version in\n[package.json] if this is intended to be a release.\n\nOn the `master` branch, merge from the `develop` branch. Generate and\ncommit the documentation and the distribution files. Put a release tag that\ncorresponds to the version in [package.json].\n\nOn the `gh-pages` branch, merge from the `master` branch. Commit the\nexamples, and the extra files (audio and HRTF set files).\n\n### Style ###\n\n`npm run lint` to check that the code conforms with [.eslintrc] and\n[.jscsrc] files. The rules derive from [AirBnB] with these\nmajor points:\n- [ES2015]\n- no `'use strict'` globally (already there via babel)\n- enforce curly braces (`if`, `for`, etc.)\n- allow spaces and new lines, with fewer requirements: use them for clarity\n\n### Test ###\n\nFor any function or method, there is at least a test. The hierarchy in the\n[test directory] is the same as in the [src directory].\n\n- `npm run test` for all automated tests\n- `npm run test-listen` for supervised listening tests. The test files must\n  end with `_listen.js`\n- `npm run test-issues` for unsolved issues. The issues may depend on the\n  host: operating system, user-agent, sound-device, sample-rate, etc. The\n  test files must end with `_issues.js`. Once an issue is solved, the\n  corresponding tests are added to the automated test set.\n- `npm run test-browser` starts a server for running the tests in any browser.\n\nExamples for specific testing, when developing or resolving an issue:\n- `browserify test/geometry/test_Listener.js -t babelify | tape-run` in a\n  headless browser\n- `browserify test/geometry/test_Listener.js -t babelify | testling -u`\n  for an URL to open in any browser\n\n### Documentation ###\n\nDocument any public function and method with [JSDoc], and generate the HTML\npages with `npm run doc`. At this point, neither\n[jsdoc](https://www.npmjs.com/package/jsdoc) nor\n[esdoc](https://www.npmjs.com/package/esdoc) gives perfect\ntranscription. (See the [jsdoc.json] and [esdoc.json] files.)\n\n## License\n\nThis module is released under the [BSD-3-Clause] license.\n\n## Acknowledgements\n\nThis research was developped by both [Acoustic And Cognitive Spaces] and\n[Analysis of Musical Practices] IRCAM research teams. A previous version\nwas part of the WAVE project, funded by ANR (French National Research\nAgency). The current version, supporting multiple sources and a listener,\nthe SOFA standard, and the access to a server, is part of the [CoSiMa]\nproject, funded by ANR.\n\n[//]: # (Avoid relative links for use with https://github.com/README.md)\n[//]: # (and http://cdn.rawgit.com/Ircam-RnD/binauralFIR/next-gh-pages/doc/index.html)\n\n[//]: # (Use relative links after the release, and drop rawgit.com)\n[//]: # (next-develop => develop)\n[//]: # (next-master => master)\n[//]: # (next-gh-pages => gh-pages)\n\n[.babelrc]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/.babelrc\n[.eslintrc]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/.eslintrc\n[.jscsrc]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/.jscsrc\n[Acoustic And Cognitive Spaces]: http://recherche.ircam.fr/equipes/salles/\n[AirBnB]: https://github.com/airbnb/javascript/\n[Analysis of Musical Practices]: http://apm.ircam.fr/\n[API documentation directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-master/doc/\n[API documentation]: http://cdn.rawgit.com/Ircam-RnD/binauralFIR/next-master/doc/index.html\n[Babel]: https://babeljs.io/\n[BSD-3-Clause]: http://opensource.org/licenses/BSD-3-Clause\n[CoSiMa]: http://cosima.ircam.fr/\n[doc directory]:  https://github.com/Ircam-RnD/binauralFIR/tree/next-master/doc/\n[dist directory]:  https://github.com/Ircam-RnD/binauralFIR/tree/next-master/dist/\n[documentation]: #documentation\n[ES2015]: https://babeljs.io/docs/learn-es2015/\n[esdoc.json]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/esdoc.json\n[examples directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-gh-pages/examples/\n[examples HRTF directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-gh-pages/examples/hrtf/\n[examples online]: http://cdn.rawgit.com/Ircam-RnD/binauralFIR/next-gh-pages/examples/index.html\n[HRTF]: http://en.wikipedia.org/wiki/Head-related_transfer_function\n[IIRFilterNode]: https://webaudio.github.io/web-audio-api/#idl-def-IIRFilterNode\n[jsdoc.json]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/jsdoc.json\n[JSDoc]: http://usejsdoc.org/\n[package.json]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/package.json\n[Promise]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\n[SOFA]: http://www.aes.org/publications/standards/search.cfm?docID=99\n[src directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/src/\n[src/geometry]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/src/geometry/\n[T. Carpentier article]: http://wac.ircam.fr/pdf/demo/wac15_submission_16.pdf\n[test directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/test/\n[Web Audio API]: https://webaudio.github.io/web-audio-api/\n",readmeFilename:"README.md",repository:{type:"git",url:"git+https://github.com/Ircam-RnD/serveSofaHrir.git"},scripts:{browserify:"browserify ./src/index.js -t [ babelify ] --standalone serveSofaHrir > serveSofaHrir.js",bundle:"npm run lint && npm run test && npm run doc && npm run compile && npm run browserify",compile:"rm -rf ./dist && babel ./src/ --out-dir ./dist/",doc:"esdoc -c esdoc.json",lint:"eslint ./src/ ./test/ && jscs --verbose ./src/ ./test/","lint-examples":"eslint -c examples/.eslintrc ./examples/*.html",test:"browserify test/*/*.js -t [ babelify ] --exclude 'test/*/*_listen.js*' --exclude 'test/*/*_issues.js' | tape-run","test-browser":"browserify test/*/*.js -t [ babelify ] --exclude 'test/*/*_listen.js*' --exclude 'test/*/*_issues.js' | testling -u","test-issues":"browserify test/*/*_issues.js -t [ babelify ] | tape-run","test-listen":"browserify test/*/*_listen.js -t [ babelify ] | tape-run",watch:"watch 'npm run browserify && echo $( date ): browserified' ./src/"},standalone:"serveSofaHrir",version:"0.4.2",warnings:[{code:"ENOTSUP",required:{node:"0.12 || 4",npm:">=1.0.0 <3.0.0"},pkgid:"serve-sofa-hrir@0.4.2"}]}},{}],80:[function(e,t,r){"use strict";"use restrict";function n(e){for(var t=0,r=Math.max,n=0,a=e.length;n<a;++n)t=r(t,e[n].length);return t-1}function a(e){for(var t=-1,r=Math.max,n=0,a=e.length;n<a;++n)for(var i=e[n],o=0,s=i.length;o<s;++o)t=r(t,i[o]);return t+1}function i(e){for(var t=new Array(e.length),r=0,n=e.length;r<n;++r)t[r]=e[r].slice(0);return t}function o(e,t){var r=e.length,n=e.length-t.length,a=Math.min;if(n)return n;switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:var i=e[0]+e[1]-t[0]-t[1];return i?i:a(e[0],e[1])-a(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];if(i=o+e[2]-(s+t[2]))return i;var u=a(e[0],e[1]),c=a(t[0],t[1]),i=a(u,e[2])-a(c,t[2]);return i?i:a(u+e[2],o)-a(c+t[2],s);default:var l=e.slice(0);l.sort();var f=t.slice(0);f.sort();for(var h=0;h<r;++h)if(n=l[h]-f[h])return n;return 0}}function s(e,t){return o(e[0],t[0])}function u(e,t){if(t){for(var r=e.length,n=new Array(r),a=0;a<r;++a)n[a]=[e[a],t[a]];n.sort(s);for(var a=0;a<r;++a)e[a]=n[a][0],t[a]=n[a][1];return e}return e.sort(o),e}function c(e){if(0===e.length)return[];for(var t=1,r=e.length,n=1;n<r;++n){var a=e[n];if(o(a,e[n-1])){if(n===t){t++;continue}e[t++]=a}}return e.length=t,e}function l(e,t){for(var r=0,n=e.length-1,a=-1;r<=n;){var i=r+n>>1,s=o(e[i],t);s<=0?(0===s&&(a=i),r=i+1):s>0&&(n=i-1)}return a}function f(e,t){for(var r=new Array(e.length),n=0,a=r.length;n<a;++n)r[n]=[];for(var i=[],n=0,s=t.length;n<s;++n)for(var u=t[n],c=u.length,f=1,h=1<<c;f<h;++f){i.length=M.popCount(f);for(var m=0,d=0;d<c;++d)f&1<<d&&(i[m++]=u[d]);var p=l(e,i);if(!(p<0))for(;;)if(r[p++].push(n),p>=e.length||0!==o(e[p],i))break}return r;
}function h(e,t){if(!t)return f(c(d(e,0)),e,0);for(var r=new Array(t),n=0;n<t;++n)r[n]=[];for(var n=0,a=e.length;n<a;++n)for(var i=e[n],o=0,s=i.length;o<s;++o)r[i[o]].push(n);return r}function m(e){for(var t=[],r=0,n=e.length;r<n;++r)for(var a=e[r],i=0|a.length,o=1,s=1<<i;o<s;++o){for(var c=[],l=0;l<i;++l)o>>>l&1&&c.push(a[l]);t.push(c)}return u(t)}function d(e,t){if(t<0)return[];for(var r=[],n=(1<<t+1)-1,a=0;a<e.length;++a)for(var i=e[a],o=n;o<1<<i.length;o=M.nextCombination(o)){for(var s=new Array(t+1),c=0,l=0;l<i.length;++l)o&1<<l&&(s[c++]=i[l]);r.push(s)}return u(r)}function p(e){for(var t=[],r=0,n=e.length;r<n;++r)for(var a=e[r],i=0,o=a.length;i<o;++i){for(var s=new Array(a.length-1),c=0,l=0;c<o;++c)c!==i&&(s[l++]=a[c]);t.push(s)}return u(t)}function v(e,t){for(var r=new b(t),n=0;n<e.length;++n)for(var a=e[n],i=0;i<a.length;++i)for(var o=i+1;o<a.length;++o)r.link(a[i],a[o]);for(var s=[],u=r.ranks,n=0;n<u.length;++n)u[n]=-1;for(var n=0;n<e.length;++n){var c=r.find(e[n][0]);u[c]<0?(u[c]=s.length,s.push([e[n].slice(0)])):s[u[c]].push(e[n].slice(0))}return s}function g(e){for(var t=c(u(d(e,0))),r=new b(t.length),n=0;n<e.length;++n)for(var a=e[n],i=0;i<a.length;++i)for(var o=l(t,[a[i]]),s=i+1;s<a.length;++s)r.link(o,l(t,[a[s]]));for(var f=[],h=r.ranks,n=0;n<h.length;++n)h[n]=-1;for(var n=0;n<e.length;++n){var m=r.find(l(t,[e[n][0]]));h[m]<0?(h[m]=f.length,f.push([e[n].slice(0)])):f[h[m]].push(e[n].slice(0))}return f}function y(e,t){return t?v(e,t):g(e)}var M=e("bit-twiddle"),b=e("union-find");r.dimension=n,r.countVertices=a,r.cloneCells=i,r.compareCells=o,r.normalize=u,r.unique=c,r.findCell=l,r.incidence=f,r.dual=h,r.explode=m,r.skeleton=d,r.boundary=p,r.connectedComponents=y},{"bit-twiddle":37,"union-find":84}],81:[function(e,t,r){function n(e,t,r,n,a){return o(0,e,t,r,n,a)}function a(e,t,r,n,a){var i,s,u,c;return 0==t?(i=o(1,e,1,r,n,a),s=o(-1,e,-1,r,n,a),u=i+s):t>0?(c=1==t?1:0,i=o(1,e,t-1,r,n,a),s=o(-1,e,-t+1,r,n,a),u=i*Math.sqrt(1+c)-s*(1-c)):(c=t==-1?1:0,i=o(1,e,t+1,r,n,a),s=o(-1,e,-t-1,r,n,a),u=i*(1-c)+s*Math.sqrt(1+c)),u}function i(e,t,r,n,a){var i,s,u;return 0==t?console.error("should not be called"):t>0?(i=o(1,e,t+1,r,n,a),s=o(-1,e,-t-1,r,n,a),u=i+s):(i=o(1,e,t-1,r,n,a),s=o(-1,e,-t+1,r,n,a),u=i-s),u}function o(e,t,r,n,a,i){var o,s,u,c;return o=a[e+1][2],s=a[e+1][0],u=a[e+1][1],c=n==-t?o*i[r+t-1][0]+s*i[r+t-1][2*t-2]:n==t?o*i[r+t-1][2*t-2]-s*i[r+t-1][0]:u*i[r+t-1][n+t-1]}var s=e("numeric"),u=function(e,t,r,n){var a,i=t.length,o=(e+1)*(e+1),u=[,];o>i&&console.log("The SHT degree is too high for the number of data points"),0==r&&(t=f(t));for(var c=0;c<t.length;c++)u[c]=t[c][2];Y_N=m(e,t),a=0==n?s.mul(1/i,Y_N):g(s.transpose(Y_N));var l=s.dotMV(a,u);return l},c=function(e,t){for(var r=t,n=Math.sqrt(e.length)-1,a=m(n,t),i=s.dotVM(e,a),o=0;o<t.length;o++)r[o][2]=i[o];return r},l=function(e){for(var t=0;t<e.length;t++)console.log(e[t])},f=function(e,t){for(var r,n,a,i=new Array(e.length),o=0;o<e.length;o++)r=Math.atan2(e[o][1],e[o][0]),n=Math.atan2(e[o][2],Math.sqrt(e[o][0]*e[o][0]+e[o][1]*e[o][1])),1==t?i[o]=[r,n]:(a=Math.sqrt(e[o][0]*e[o][0]+e[o][1]*e[o][1]+e[o][2]*e[o][2]),i[o]=[r,n,a]);return i},h=function(e){for(var t,r,n,a=new Array(e.length),i=0;i<e.length;i++)t=Math.cos(e[i][0])*Math.cos(e[i][1]),r=Math.sin(e[i][0])*Math.cos(e[i][1]),n=Math.sin(e[i][1]),2==e[0].length?a[i]=[t,r,n]:3==e[0].length&&(a[i]=[e[i][2]*t,e[i][2]*r,e[i][2]*n]);return a},m=function(e,t){for(var r=new Array(t.length),n=new Array(t.length),a=0;a<t.length;a++)r[a]=t[a][0],n[a]=t[a][1];for(var i,o,u,c,l,f=new Array(2*e+1),h=(r.length,(e+1)*(e+1)),m=0,v=0,g=s.sin(n),y=0,M=new Array(h),a=0;a<2*e+1;a++)f[a]=d(a);for(var b=0;b<e+1;b++){if(0==b){var x=new Array(r.length);x.fill(1),M[b]=x,y=1}else{i=p(b,g,m,v),o=Math.sqrt(2*b+1);for(var S=0;S<b+1;S++)0==S?M[y+b]=s.mul(o,i[S]):(u=o*Math.sqrt(2*f[b-S]/f[b+S]),c=s.cos(s.mul(S,r)),l=s.sin(s.mul(S,r)),M[y+b-S]=s.mul(u,s.mul(i[S],l)),M[y+b+S]=s.mul(u,s.mul(i[S],c)));y=y+2*b+1}v=m,m=i}return M},d=function(e){return 0===e?1:e*d(e-1)},p=function(e,t,r,n){var a=new Array(e+1);switch(e){case 1:var i=s.mul(t,t),o=t,u=s.sqrt(s.sub(1,i));a[0]=o,a[1]=u;break;case 2:var i=s.mul(t,t),c=s.mul(3,i);c=s.sub(c,1),c=s.div(c,2);var l=s.sub(1,i);l=s.sqrt(l),l=s.mul(3,l),l=s.mul(l,t);var f=s.sub(1,i);f=s.mul(3,f),a[0]=c,a[1]=l,a[2]=f;break;default:var i=s.mul(t,t),h=s.sub(1,i),m=2*e-1,d=1;if(m%2==0)for(var p=1;p<m/2+1;p++)d=2*d*p;else for(var p=1;p<(m+1)/2+1;p++)d*=2*p-1;a[e]=s.mul(d,s.pow(h,e/2)),a[e-1]=s.mul(2*e-1,s.mul(t,r[e-1]));for(var v=0;v<e-1;v++){var g=s.mul(2*e-1,s.mul(t,r[v])),y=s.mul(e+v-1,n[v]);a[v]=s.div(s.sub(g,y),e-v)}}return a},v=function(e){for(var t=s.svd(e),r=t.S[0],n=t.U,a=t.S,i=t.V,o=e.length,u=e[0].length,c=Math.max(o,u)*s.epsilon*r,l=a.length,f=new Array(l),h=l-1;h!==-1;h--)a[h]>c?f[h]=1/a[h]:f[h]=0;return s.dot(s.dot(i,s.diag(f)),s.transpose(n))},g=function(e){var t=s.transpose(e);return s.dot(s.inv(s.dot(t,e)),t)},y=function(e,t){var r=(t+1)*(t+1),o=s.rep([r,r],0);o[0][0]=1;var u=s.rep([3,3],0);u[0][0]=e[1][1],u[0][1]=e[1][2],u[0][2]=e[1][0],u[1][0]=e[2][1],u[1][1]=e[2][2],u[1][2]=e[2][0],u[2][0]=e[0][1],u[2][1]=e[0][2],u[2][2]=e[0][0],o=s.setBlock(o,[1,1],[3,3],u);for(var c=u,l=3,f=2;f<t+1;f++){for(var h=s.rep([2*f+1,2*f+1],0),m=-f;m<f+1;m++)for(var d=-f;d<f+1;d++){var p,v,g,y,M;p=0==m?1:0,v=Math.abs(d)==f?2*f*(2*f-1):f*f-d*d,g=Math.sqrt((f*f-m*m)/v),y=Math.sqrt((1+p)*(f+Math.abs(m)-1)*(f+Math.abs(m))/v)*(1-2*p)*.5,M=Math.sqrt((f-Math.abs(m)-1)*(f-Math.abs(m))/v)*(1-p)*-.5,0!=g&&(g*=n(f,m,d,u,c)),0!=y&&(y*=a(f,m,d,u,c)),0!=M&&(M*=i(f,m,d,u,c)),h[m+f][d+f]=g+y+M}o=s.setBlock(o,[l+1,l+1],[l+2*f+1,l+2*f+1],h),c=h,l=l+2*f+1}return o},M=function(e,t,r){var n,a,i;n=0==r?[[1,0,0],[0,1,0],[0,0,1]]:[[1,0,0],[0,Math.cos(r),Math.sin(r)],[0,-Math.sin(r),Math.cos(r)]],a=0==t?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(t),0,-Math.sin(t)],[0,1,0],[Math.sin(t),0,Math.cos(t)]],i=0==e?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(e),Math.sin(e),0],[-Math.sin(e),Math.cos(e),0],[0,0,1]];var o=s.dotMMsmall(a,i);return o=s.dotMMsmall(n,o)};t.exports.forwardSHT=u,t.exports.inverseSHT=c,t.exports.print2Darray=l,t.exports.convertCart2Sph=f,t.exports.convertSph2Cart=h,t.exports.computeRealSH=m,t.exports.factorial=d,t.exports.recurseLegendrePoly=p,t.exports.pinv_svd=v,t.exports.pinv_direct=g,t.exports.getSHrotMtx=y,t.exports.yawPitchRoll2Rzyx=M},{numeric:63}],82:[function(e,t,r){"use strict";function n(e,t,r){var n=e*t,i=a*e,o=i-e,s=i-o,u=e-s,c=a*t,l=c-t,f=c-l,h=t-f,m=n-s*f,d=m-u*f,p=d-s*h,v=u*h-p;return r?(r[0]=v,r[1]=n,r):[v,n]}t.exports=n;var a=+(Math.pow(2,27)+1)},{}],83:[function(e,t,r){"use strict";function n(e,t,r){var n=e+t,a=n-e,i=n-a,o=t-a,s=e-i;return r?(r[0]=s+o,r[1]=n,r):[s+o,n]}t.exports=n},{}],84:[function(e,t,r){"use strict";"use restrict";function n(e){this.roots=new Array(e),this.ranks=new Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=n;var a=n.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},a.find=function(e){for(var t=e,r=this.roots;r[e]!==e;)e=r[e];for(;r[t]!==e;){var n=r[t];r[t]=e,t=n}return e},a.link=function(e,t){var r=this.find(e),n=this.find(t);if(r!==n){var a=this.ranks,i=this.roots,o=a[r],s=a[n];o<s?i[r]=n:s<o?i[n]=r:(i[n]=r,++a[r])}}},{}]},{},[14])(14)});